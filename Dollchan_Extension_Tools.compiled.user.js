// ==UserScript==
// @name			Dollchan Extension Tools
// @version			12.9.30.0
// @namespace		http://www.freedollchan.org/scripts/*
// @author			Sthephan Shinkufag @ FreeDollChan
// @copyright		(C)2084, Bender Bending Rodriguez
// @description		Doing some profit for imageboards
// @icon			https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/stable/Icon.png
// @updateURL		https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/stable/Dollchan_Extension_Tools.meta.js
// @include			*
// ==/UserScript==
var ta=void 0,i=!0,l=null,m=!1;
(function(Ia){var Ua,Va,Wa,lb,ma,Aa,mb,ua,nb,Ob,va,Pb,ha,Ic,Jc,Kc,ob,Lc,Mc,Nc,Qb,Oc,Pc,Qc,Rc,Sc,Rb,Tc,Sb,Uc,Vc,Wc,Ja,Xc,pb,qb,Yc,Zc,$c,rb,ad,Tb,Ub,bd,cd,dd,Vb,Wb,ed,fd,gd,Xb,hd,wa,id,jd,kd,ld,md,nd,od,pd,qd,rd,sd,Yb,sb,td,ud,na,vd,wd,xd,yd,Zb,zd,Ad,Bd,Cd,Dd,Ed,Fd,Gd,Hd,Id,Jd,Kd,Ld,Ba,Md,Nd,Od,Pd,Qd,Rd,Sd,Td,Ka,tb;function U(a,b){return n.evaluate(a,b,l,8,l).singleNodeValue}function ia(a,b){return n.evaluate(a,b,l,3,l).booleanValue}function Ud(a,b){return b.querySelector(a)}function X(a,b){return g.d?
b.getElementsByClassName(a):b.querySelectorAll("."+a)}function B(a,b){return b.getElementsByClassName(a)[0]}function q(a){return n.getElementById(a)}function R(a,b){return b.getElementsByTagName(a)[0]}function D(a,b){Ca.forEach.call(a,b)}function Vd(a,b){var c=a.cloneNode(m);c.innerHTML=b;a.parentNode.replaceChild(c,a);return c}function V(a,b){for(var c in b)"text"===c?a.textContent=b[c]:"value"===c?a.value=b[c]:a.setAttribute(c,b[c]);return a}function S(a,b){for(var c in b)a.addEventListener(c,b[c],
m);return a}function $b(a,b){for(var c in b)a.removeEventListener(c,b[c],m)}function fa(a,b){for(var c=0,e=b.length;c<e;c++)b[c]&&a.appendChild(b[c])}function $(a,b){a.parentNode.insertBefore(b,a)}function N(a,b){a.parentNode.insertBefore(b,a.nextSibling)}function E(a){ac.innerHTML=a;return ac.firstChild}function s(a,b,c){a=n.createElement(a);b&&V(a,b);c&&S(a,c);return a}function t(a,b,c){a=s(a,b,l);fa(a,c);return a}function Y(a){return n.createTextNode(a)}function T(a,b,c){return s("input",{type:"button",
value:a,title:b},{click:c})}function G(a,b){return a?b:l}function J(a){a.style.display="none"===a.style.display?"":"none"}function v(a){a&&a.parentNode.removeChild(a)}function oa(a){a=a.getBoundingClientRect();return{top:Math.round(a.top+window.pageYOffset),left:Math.round(a.left+window.pageXOffset)}}function bc(a){window.scrollTo(0,oa(a).top)}function w(a){a.preventDefault()}function Xa(a,b){var c=a.scrollTop,e=a.selectionStart;a.value=a.value.substr(0,e)+b+a.value.substr(a.selectionEnd);a.setSelectionRange(e+
b.length,e+b.length);a.focus();a.scrollTop=c}function cc(){return(g.e?n.getSelection():window.getSelection()).toString()}function Da(a){for(var b in a)if(a.hasOwnProperty(b))return m;return i}function O(a){var b=Date.now();ub+=a+": "+(b-dc)+"ms\n";dc=b}function df(){d.xb&&(window.setTimeout=function(a,b){"function"===typeof a&&a.apply(l,Ca.slice.call(arguments,2));return 1});String.prototype.contains||(String.prototype.contains=function(a){return this.indexOf(a)!==-1},String.prototype.yc=function(){return this.indexOf("#op ")===
0});RegExp.quote=function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")};window.GM_log||(window.GM_log=function(a){console.error(a)});window.GM_xmlhttpRequest||(window.GM_xmlhttpRequest=function(a){var b,c=new window.XMLHttpRequest;if(a.onreadystatechange)c.onreadystatechange=function(){a.onreadystatechange(c)};c.onload=function(){if(a.onload)a.onload(c);c=a=l};c.open(a.method,a.url,i);c.setRequestHeader("Accept-Encoding","deflate, gzip, x-gzip");for(b in a.headers)c.setRequestHeader(b,
a.headers[b]);c.send(l)})}function ec(a){n.head.appendChild(s("script",{type:"text/javascript",text:a},l))}function ca(a){return U("ancestor::*[@de-post]",a)}function La(a){return a.querySelectorAll('.thumb, img[src*="thumb"], img[src*="/spoiler"], img[src^="blob:"]')}function Wd(a){return(a=a.querySelector(d.pc))&&(a=a.textContent)?+(a.match(/\d+/)||[0])[0]:0}function xa(a){return a.Lb||(a.Lb=a.l.innerHTML.replace(/<\/?(?:br|p|li)[^>]*?>/gi,"\n").replace(/<[^>]+?>/g,"").replace(/&gt;/g,">").replace(/&lt;/g,
"<").trim())}function Xd(a){var a=B(d.V,a).textContent.match(/(\d+(?:\.\d+)?)\s*([mkк])[bб]/i),b=parseFloat(a[1]);return"M"===a[2]?1E3*b|0:!a[2]?Math.round(b/1E3):b}function fc(a){a=B(d.V,a);return d.w?(a=a.onclick.toString().split("', '"),[a[3],a[4]]):(a=a?a.textContent.match(/(\d+)[x\u00d7](\d+)/):m)?a.slice(1):[l,l]}function vb(a){return"/"+a+(a?"/":"")}function pa(a,b,c){return"//"+a+vb(b)+(/(?:^|\.)krautchan\.net$/.test(a)?"thread-":"res/")+c+(/(?:^|\.)(?:dobrochan\.(?:ru|org)|tenhou\.ru)$/.test(a)?
".xhtml":/(?:^|\.)420chan\.org$/.test(a)?".php":/(?:^|\.)2chan\.net$/.test(a)?".htm":".html")}function wb(a,b,c){return vb(b)+(0<c?c+xb:/(?:^|\.)(?:dobrochan\.(?:ru|org)|tenhou\.ru)$/.test(a)?"index.xhtml":"")}function Ya(a,b){var c,e,k=a instanceof Array;if(k){if(0==a.length)return"[]";c="["}else{if(Da(a))return"{}";c="{"}e=0;g.forEach(a,function(a){var d=this[a],u=typeof d;"function"!==u&&("object"===u&&(u=d===l?"null":d instanceof Array?"array":d instanceof Date?"date":d instanceof RegExp?"regex":
"object"),0<e&&(c+=","),c+="\n"+b+"    "+(k?"":'"'+a+'": ')+("array"===u||"object"===u?Ya(d,b+"    "):"boolean"===u||"number"===u?d.toString():"string"===u?'"'+d.replace(/(["\n\\])/g,"\\$1")+'"':u),e++)});return c+="\n"+b+(k?"]":"}")}function Za(a){for(var b,c=0,e=0,k=a.length;e<k;++e){c=(c<<4)+a.charCodeAt(e);if(b=c&4026531840)c^=b>>>24;c&=~b}return c}function Ea(a){return g.va?GM_getValue(a):Ia?Ia.getItem(a):localStorage.getItem(a)}function K(a,b){g.va?GM_setValue(a,b):Ia?Ia.setItem(a,b):localStorage.setItem(a,
b)}function yb(a,b){try{return JSON.parse(Ea(a))||b}catch(c){return b}}function zb(a){for(var b in a)this[b]=a[b]}function gc(a){try{var b=JSON.parse(Ea(a));if(b.version)return new zb(b)}catch(c){}return m}function Yd(a){a=a&&gc("DESU_GlobalCfg")||new zb({version:Ma.version});a.captchaLang=d.wc?2:1;a.language=navigator.language.contains("ru")?0:1;a.timePattern=a.timeOffset="";a.correctTime=0;return a}function P(a,b){f[a]!==b&&(f[a]=b,K("DESU_Config_"+d.c,JSON.stringify(f)))}function Ab(a){P(a,!f[a]?
1:0)}function Zd(){Z=[];if(r){var a=(sessionStorage["de-hidden"]||"").split(",");if(2===a.length&&+a[0]===(f.hideBySpell?F.hash:0))if(Z=a[1].split(""),a=sessionStorage["de-deleted"])a.split(",").forEach(function(a){Z.splice(a,1)}),delete sessionStorage["de-deleted"]}Z.length=x.length;Q=yb("DESU_Posts_"+d.c+"_"+C,{});$d()}function Na(){r&&(sessionStorage["de-hidden"]=(f.hideBySpell?F.hash+",":"0,")+Z.join(""));qa("hid",i)}function Oa(){var a,b=JSON.stringify(Q);9E3<b.length&&(a=Date.now()-432E6,g.forEach(Q,
function(b){Q[b][1]<a&&delete Q[b]}),b=JSON.stringify(Q));K("DESU_Posts_"+d.c+"_"+C,b);qa("hid",i)}function $d(){W=yb("DESU_Threads_"+d.c,{});Fa=W[C]||{}}function ae(a,b){W[C]||(W[C]=Fa);0===b?Fa[a.a]=a.ma:(delete Fa[a.a],Da(Fa)&&delete W[C]);K("DESU_Threads_"+d.c,JSON.stringify(W))}function hc(){H=yb("DESU_Favorites",{})}function $a(a){K("DESU_Favorites",a);qa("fav",i)}function ic(a,b,c){delete H[a][b][c];Da(H[a][b])&&delete H[a][b];Da(H[a])&&delete H[a];I[c]&&((B("de-btn-fav-sel",I[c].G)||{}).className=
"de-btn-fav")}function be(a,b){var c=d.host,e=C,k=a.a;b&&(hc(),H[c]&&H[c][e]&&H[c][e][k]?ic(c,e,k):(H[c]||(H[c]={}),H[c][e]||(H[c][e]={}),H[c][e][k]={cnt:a.K.P+1,txt:a.ma},b.className="de-btn-fav-sel"),$a(JSON.stringify(H)))}function ef(){var a=sessionStorage["de-viewed"];a&&a.split(",").forEach(function(a){if(a=I[a])g.r(a,"de-viewed"),a.ab=i})}function aa(a,b,c,e,k){return t("li",l,[s("a",{id:"de-btn-"+a,"class":"de-abtn",title:Pb[a][h],href:c||"#",onmouseout:k},{click:b,mouseover:e})])}function ce(){var a=
La(A).length;$(A,t("div",{id:"de-main",lang:de()},[t("div",{id:"de-panel"},[s("span",{id:"de-btn-logo"},{click:function(){Ab("expandPanel");ja()}}),t("ul",{id:"de-panel-btns"},[aa("settings",function(a){w(a);qa("cfg",m)},l,l,l),aa("hidden",function(a){w(a);qa("hid",m)},l,l,l),aa("favor",function(a){w(a);qa("fav",m)},l,l,l),aa("refresh",function(a){w(a);window.location.reload()},l,function(){r||ff()},"de_delSelection(event)"),aa("goback",l,"//"+d.host+wb(d.host,C,jc-1),l,l),G(!r,aa("gonext",l,"//"+
d.host+wb(d.host,C,jc+1),l,l)),aa("goup",function(a){w(a);window.scrollTo(0,0)},l,l,l),aa("godown",function(a){w(a);window.scrollTo(0,n.body.scrollHeight||n.body.offsetHeight)},l,l,l),G(!r&&(j.O||ba),aa("newthr",ee,l,l,l)),G(0<a,aa("expimg",function(a){w(a);f.expandImgs=1;ab=!ab;x.forEach(function(a){kc(a,ab)})},l,l,l)),G(j.file||ba,aa("maskimg",function(a){w(a);Ab("maskImgs");ja()},l,l,l)),G(r&&3!==f.updThread,aa("upd-on",function(a){w(a);bb?fe():(this.id="de-btn-upd-on",ge())},l,l,l)),G(!g.oa&&
r&&1===f.updThread,aa("audio-off",function(a){w(a);he();Ua=m;this.id=Va?"de-btn-audio-on":"de-btn-audio-off";v(q("de-select"))},l,gf,"de_delSelection(event)")),G(d.ya,aa("catalog",l,"//"+d.host+"/"+C+"/catalog.html",l,l))]),G(r,t("div",{id:"de-panel-info"},[s("span",{title:Pb.counter[h],text:x.length+"/"+a},l)]))]),s("div",{"class":"de-content"},l),s("div",{id:"de-alert"},l),s("hr",{style:"clear: both;"},l)]))}function qa(a,b){if(!cb){var c=B("de-content",n),e="de-content-"+a;b&&c.id!==e||(c.childElementCount&&
f.animation?(g.U(c,function(c){ie(c,e,a,b);e=a=b=l}),c.className="de-content de-cfg-close"):ie(c,e,a,b))}}function ie(a,b,c,e){a.innerHTML=a.style.backgroundColor="";if(!e&&a.id===b)a.removeAttribute("id");else{a.id=b;if("cfg"===c)hf(a);else if(f.attachPanel&&(a.style.backgroundColor=getComputedStyle(n.body).getPropertyValue("background-color")),"hid"===c&&($d(),jf(a)),"fav"===c)hc(),kf(a);f.animation&&(a.className="de-content de-cfg-open")}}function ya(a,b){for(var c=b.length;c--;)(n.querySelector(b[c])||
{}).disabled=!a}function lc(){ya(1===f.updThread||2===f.updThread,['input[info="updThrDelay"]','input[info="favIcoBlink"]','input[info="desktNotif"]']);ya(f.preLoadImgs,['input[info="findRarJPEG"]','input[info="showGIFs"]','input[info="noImgSpoil"]']);ya(f.linksNavig,['input[info="linksOver"]','input[info="linksOut"]','input[info="markViewed"]','input[info="strikeHidd"]','input[info="noNavigHidd"]']);ya(f.addYouTube&&4!==f.addYouTube,['select[info="YTubeType"]','input[info="YTubeHD"]']);ya(f.addYouTube,
['input[info="YTubeWidth"]','input[info="YTubeHeigh"]','input[info="YTubeTitles"]']);ya(2===f.ajaxReply,['input[info="postSameImg"]','input[info="removeEXIF"]','input[info="removeFName"]']);ya(f.addTextBtns,['input[info="txtBtnsLoc"]']);ya(f.updScript,['select[info="scrUpdIntrv"]'])}function y(a,b,c){var e=s("input",{info:a,type:"checkbox"},{click:function(){Ab(this.getAttribute("info"));lc();c&&c(this)}});e.checked=f[a];return t("label",b?{"class":"de-blockinp"}:l,[e,Y(" "+ha[a][h])])}function ka(a,
b,c){return s("input",{info:a,type:"text",size:b,value:f[a]},{keyup:c?c:function(){P(this.getAttribute("info"),this.value)}})}function da(a,b,c){for(var e=0,k=ha[a],d=k.q[h].length,o=[];e<d;e++)o[e]='<option value="'+e+'">'+k.q[h][e]+"</option>";(c=S(E('<select info="'+a+'">'+o.join("")+"</select>"),{change:c?c:function(){P(this.getAttribute("info"),this.selectedIndex);lc()}})).selectedIndex=f[a];return t("label",b?{"class":"de-blockinp"}:l,[c,Y(" "+k.s[h])])}function Pa(a){return t("div",{"class":d.u+
" de-cfg-tab-back",selected:m},[s("div",{"class":"de-cfg-tab",text:Ic[a][h],info:a},{click:function(){var a,c;c=this.parentNode;if("true"!==c.getAttribute("selected")){if(a=B("de-cfg-body",n))a.className="de-cfg-unvis",n.querySelector('.de-cfg-tab-back[selected="true"]').setAttribute("selected",m);c.setAttribute("selected",i);c=this.getAttribute("info");(a=q("de-cfg-"+c))||N(q("de-cfg-bar"),a="posts"===c?lf():"links"===c?mf():"form"===c?nf():"common"===c?of():pf());a.className="de-cfg-body";"filters"===
c&&(F.update(),q("de-spell-edit").value=F.list);lc()}}})])}function qf(){return t("div",{"class":"de-cfg-unvis",id:"de-cfg-filters"},[t("div",l,[t("span",{id:"de-spell-panel"},[s("a",{text:Jc[h],href:"#","class":"de-abtn",onmouseout:"de_delSelection(event)"},{click:w,mouseover:rf}),s("a",{text:Kc[h],href:"#","class":"de-abtn"},{click:function(a){w(a);P("hideBySpell",1);n.querySelector('input[info="hideBySpell"]').checked=i;mc()}}),s("a",{text:ob[h],href:"#","class":"de-abtn"},{click:function(a){w(a);
q("de-spell-edit").value="";mc()}}),s("a",{text:"?",target:"_blank",href:"//www.freedollchan.org/scripts/spells","class":"de-abtn"},l)]),y("hideBySpell",m,mc),s("textarea",{id:"de-spell-edit",rows:16,cols:50},l)]),y("filterThrds",i,l),y("menuHiddBtn",i,l),y("hideRefPsts",i,l),y("delHiddPost",i,function(){D(X("de-post-hid",A),function(a){J(d.ta(a))});ja()})])}function lf(){return t("div",{"class":"de-cfg-unvis",id:"de-cfg-posts"},[da("updThread",m,l),t("label",l,[ka("updThrDelay",4,l),Y(ha.updThrDelay[h])]),
t("div",{style:"padding-left: 25px;"},[G(!g.m,y("favIcoBlink",i,l)),G(g.m,y("desktNotif",i,function(){f.desktNotif&&window.webkitNotifications.requestPermission()}))]),da("expandPosts",i,l),da("expandImgs",i,l),G(!g.Y,y("preLoadImgs",i,l)),G(!g.Y,t("div",{style:"padding-left: 25px;"},[G(!d.F&&!d.b,y("findRarJPEG",i,l)),y("showGIFs",i,l),y("noImgSpoil",i,l)])),y("postBtnsTxt",i,l),y("imgSrcBtns",i,l),y("noSpoilers",i,ja),y("noPostNames",i,ja),y("noPostScrl",i,ja),t("div",l,[y("keybNavig",m,l),s("a",
{text:"?",href:"#","class":"de-abtn"},{click:function(a){w(a);L(Lc[h],"help-keybnavig",m)}})]),y("correctTime",i,za.zc),t("div",{style:"padding-left: 25px;"},[t("div",l,[ka("timeOffset",3,l),Y(ha.timeOffset[h])]),t("div",l,[ka("timePattern",30,l),Y(" "),s("a",{text:ha.timePattern[h],href:"#","class":"de-abtn"},{click:function(a){w(a);L('"s" - second (one digit),\n"i" - minute (one digit),\n"h" - hour (one digit),\n"d" - day (one digit),\n"w" - week (string)\n"n" - month (one digit),\n"m" - month (string),\n"y" - year (one digit),\n"-" - any symbol\n"+" - any symbol except digits\n"?" - previous char may not be\n\nExamples:\n0chan.ru: "w+yyyy+m+dd+hh+ii+ss"\niichan.ru, 2ch.so: "w+dd+m+yyyy+hh+ii+ss"\ndobrochan.ru: "dd+m+?+?+?+?+?+yyyy++w++hh+ii-?s?s?"\n410chan.org: "dd+nn+yyyy++w++hh+ii+ss"\n4chan.org: "nn+dd+yy+w+hh+ii-?s?s?"\n4chon.net: "nn+dd+yy++w++hh+ii+ss"\nkrautchan.net: "yyyy+nn+dd+hh+ii+ss+--?-?-?-?-?"',
"help-correcttime",m)}})])])])}function mf(){return t("div",{"class":"de-cfg-unvis",id:"de-cfg-links"},[da("linksNavig",i,l),t("div",{style:"padding-left: 25px;"},[t("div",l,[ka("linksOver",6,function(){P("linksOver",+this.value|0)}),Y(ha.linksOver[h])]),t("div",l,[ka("linksOut",6,function(){P("linksOut",+this.value|0)}),Y(ha.linksOut[h])]),y("markViewed",i,l),y("strikeHidd",i,l),y("noNavigHidd",i,l)]),y("crossLinks",i,l),y("insertNum",i,l),y("addMP3",i,l),y("addImgs",i,l),da("addYouTube",i,l),t("div",
{style:"padding-left: 25px;"},[t("div",l,[da("YTubeType",m,l),ka("YTubeWidth",6,l),Y("\u00d7"),ka("YTubeHeigh",6,l),Y(" "),y("YTubeHD",m,l)]),G(!(g.e&&12>g.e),y("YTubeTitles",m,l))])])}function nf(){return t("div",{"class":"de-cfg-unvis",id:"de-cfg-form"},[da("ajaxReply",i,l),G(!g.oa&&!g.Y,t("div",{style:"padding-left: 25px;"},[y("postSameImg",i,l),y("removeEXIF",i,l),y("removeFName",i,l)])),G(j.O,da("addPostForm",i,l)),G(j.O,y("noThrdForm",i,function(){r||(q("de-parea").style.display=f.noThrdForm?
"none":"")})),y("favOnReply",i,l),G(j.M,t("div",l,[y("addSageBtn",m,l),y("saveSage",m,l)])),da("captchaLang",i,l),G(j.O,t("div",l,[da("addTextBtns",m,function(){P("addTextBtns",this.selectedIndex);nc()}),y("txtBtnsLoc",m,nc)])),G(j.S,t("div",l,[ka("passwValue",20,je),Y(ha.userPassw[h])])),G(j.name,t("div",l,[ka("nameValue",20,oc),y("userName",m,oc)])),G(j.g,t("div",l,[ka("signatValue",20,l),y("userSignat",m,l)])),t("div",l,[G(j.O||ba,Y(Mc[h])),y("noBoardRule",m,ja),G(j.ua,y("noGoto",m,function(){J(j.ua)})),
G(j.S,y("noPassword",m,function(){J(j.S.parentNode.parentNode)}))])])}function of(){return t("div",{"class":"de-cfg-unvis",id:"de-cfg-common"},[G(g.wa,t("div",l,[Y(ha.excludeList[h]),s("textarea",{value:Ea("DESU_Exclude")||"",rows:6,cols:50},{keyup:function(){K("DESU_Exclude",this.value)}})])),da("scriptStyle",i,function(){P("scriptStyle",this.selectedIndex);q("de-main").lang=de()}),y("attachPanel",i,function(){qa("cfg",m);ja()}),y("panelCounter",i,ja),y("rePageTitle",i,l),G(g.Ca,y("animation",i,
l)),y("closePopups",i,l),G(!g.e,t("div",l,[y("updScript",i,l),t("div",{id:"de-upd-cont",style:"padding: 2px 0 10px 25px;"},[da("scrUpdIntrv",i,l),T(Nc[h],"",function(){var a=q("de-updresult");a.innerHTML='<span class="de-wait">'+Qb[h]+"</div>";ke(i,function(b){a.innerHTML=b})})]),s("div",{id:"de-updresult",style:"font-size: 1.1em; text-align: center"},l)]))])}function pf(){return t("div",{"class":"de-cfg-unvis",id:"de-cfg-info"},[E('<span style="width: 179px;"><b>'+Oc[h]+f.version+"</b><br><br>"+
Pc[h]+(g.va?"Mozilla config":Ia?"Opera ScriptStorage":"Local Storage")+"<br>"+Qc[h]+ea.view+"<br>"+Rc[h]+ea.op+"<br>"+Sc[h]+ea.reply+"</span>"),E('<span style="padding-left: 7px; border-left: 1px solid grey;">'+ub.split("\n").join("<br>")+"<br>"+Rb[h]+pc+"ms</span>"),t("div",{style:"display: table;"},[E('<span style="display: table-cell; width: 100%;"><a href="//www.freedollchan.org/scripts/" target="_blank">http://www.freedollchan.org/scripts</a></span>'),V(T(Tc[h],Sb[h],function(){var a,b=new zb(f),
c=ub.split("\n");c[c.length-1]=Rb[h]+pc+"ms";delete b.nameValue;delete b.passwValue;delete b.signatValue;delete b.lastScrUpd;for(a in b)b[a]===Ma[a]&&delete b[a];L(Sb[h]+':<br /><textarea readonly rows="20" cols="75">'+Ya({version:Ma.version,location:""+window.location,nav:g,cfg:b,spells:F.list.split("\n"),cSpells:Ea("DESU_CSpells_"+d.c),oSpells:sessionStorage["de-spells"],perf:c},"")+"</textarea>","help-debug",m)}),{style:"display: table-cell;"})])])}function hf(a){a.appendChild(t("div",{"class":d.u},
[s("div",{id:"de-cfg-head",text:"Dollchan Extension Tools"},l),t("div",{id:"de-cfg-bar"},[Pa("filters"),Pa("posts"),Pa("links"),Pa("form"),Pa("common"),Pa("info")]),qf(),t("div",{id:"de-cfg-btns"},[t("span",{style:"float: right;"},[da("language",m,function(){P("language",h=this.selectedIndex);v(q("de-main"));v(q("de-css"));v(q("de-css-dynamic"));le();ce();qa("cfg",m)}),G(g.wa,T(Uc[h],Vc[h],function(){gc("DESU_GlobalCfg")?(K("DESU_Config_"+d.c,""),window.location.reload()):L(Wc[h],"err-noglobalcfg",
m)})),G(g.wa,T(Ja[h],Xc[h],function(){K("DESU_GlobalCfg",JSON.stringify(f));qa("cfg",i)})),T(pb[h],qb[h],function(){J(V(R("textarea",this.parentNode.parentNode),{value:Ya(f,"")}).parentNode)}),T(Yc[h],Zc[h],function(){confirm($c[h])&&(K("DESU_Config_"+d.c,JSON.stringify(Yd(m))),K("DESU_Stat_"+d.c,""),K("DESU_Favorites",""),K("DESU_Threads_"+d.c,""),K("DESU_Spells_"+d.c,'[1,85765385,"#wipe(samelines,samewords,longwords,numbers)"]'),window.location.reload())})]),s("br",{style:"clear: both;"},l),t("div",
{style:"display: none;"},[s("textarea",{rows:10,cols:50},l),T(Ja[h],rb[h],function(){K("DESU_Config_"+d.c,this.previousSibling.value.trim().replace(/\t|\n/g,""));window.location.reload()})])])]));B("de-cfg-tab",a).click()}function me(a,b){return a.appendChild(t("div",{"class":"de-content-block"},[s("input",{type:"checkbox"},{click:function(){var a=this.checked;D(this.parentNode.querySelectorAll(".de-entry > div > input"),function(b){b.checked=a});a=l}}),b]))}function jf(a){var b,c,e;D(X("de-post-hid",
A),function(b){if(!b.k){var c=b.cloneNode(i);c.removeAttribute("id");c.style.display="";c.h=i;c.mc=b;c.ra=c.querySelector(".de-btn-hide, .de-btn-lock");c.ra.parentNode.className="de-ppanel";c.ra.onmouseover=c.ra.onmouseout=l;c.ra.onclick=function(){var a=ca(this);db(a,a.h=!a.h)};(e||(e=a.appendChild(t("div",{"class":"de-content-block"},[E("<b>"+ad[h]+":</b>")])))).appendChild(t("div",{"class":"de-entry"},[c]))}});e?fa(a,[T(Tb[h],"",function(){D(this.parentNode.querySelectorAll(".de-entry > [de-post]"),
function(a){db(a,a.h=!a.h)});this.value=this.value==Ub[h]?Tb[h]:Ub[h]}),T(Ja[h],"",function(){D(this.parentNode.querySelectorAll(".de-entry > [de-post]"),function(a){a.h||Qa(a.mc,m)});Oa()})]):a.appendChild(E("<b>"+bd[h]+"</b>"));fa(a,[E("<hr />"),E("<b>"+(Da(W)?cd[h]:dd[h]+":")+"</b>")]);if(!Da(W))for(b in W)for(c in e=me(a,E("<b>"+b+"</b>")),W[b])e.appendChild(t("div",{"class":"de-entry",info:b+";"+c},[t("div",{"class":d.u},[s("input",{type:"checkbox"},l),E('<a href="'+pa(d.host,b,c)+'" target="_blank">№'+
c+"</a>"),Y(" - "+W[b][c])])]));fa(a,[E("<hr />"),T(pb[h],qb[h],function(){J(V(R("textarea",this.parentNode),{value:Ya(W,"")}).parentNode)}),T(Vb[h],Wb[h],function(){D(this.parentNode.querySelectorAll(".de-entry[info]"),function(a){var b=a.getAttribute("info").split(";"),c=b[0],b=b[1];R("input",a).checked&&(I[b]?Qa(I[b],m):delete W[c][b],Da(W[c])&&delete W[c])});K("DESU_Threads_"+d.c,JSON.stringify(W));Oa()}),t("div",{style:"display: none;"},[s("textarea",{rows:9,cols:70},l),T(Ja[h],rb[h],function(){K("DESU_Threads_"+
d.c,this.previousSibling.value.trim().replace(/\t|\n/,""));window.location.reload()})])])}function kf(a){var b,c,e,k;for(b in H)for(c in H[b])for(e in k=me(a,E('<a href="http://'+b+wb(b,c,0)+'">'+b+"/"+c+"</a>")),H[b][c])k.appendChild(t("div",{"class":"de-entry",info:b+";"+c+";"+e},[t("div",{"class":d.u},[E('<input type="checkbox" />'),s("span",{"class":"de-btn-expthr"},{click:sf}),E('<a href="'+pa(b,c,e)+'">№'+e+"</a>"),E('<span class="de-fav-title"> - '+H[b][c][e].txt+"</span>"),E('<span class="de-fav-inf-page"></span>'),
E('<span class="de-fav-inf-posts">[<span class="de-fav-inf-old">'+H[b][c][e].cnt+"</span>]</span>")])]));k||a.appendChild(E("<b>"+ed[h]+"</b>"));fa(a,[n.createElement("hr"),T(pb[h],qb[h],function(){J(V(R("textarea",this.parentNode),{value:Ya(H,"")}).parentNode)}),T(fd[h],gd[h],function(){D(X("de-entry",n),function(a){var b,c=a.getAttribute("info").split(";");c[0]===d.host&&(b=V(B("de-fav-inf-posts",a).firstElementChild,{"class":"de-wait",text:""}),ra(l,c[1],c[2],i,function(a,e,k){a=k?k:a.length+1;
b.textContent=a;!k&&a>H[c[0]][c[1]][c[2]].pb?(b.className="de-fav-inf-new",H[c[0]][c[1]][c[2]].pb=a,K("DESU_Favorites",JSON.stringify(H))):b.className="de-fav-inf-old";b=c=l}))})}),T(Xb[h],hd[h],function(){var a=6,b=0;for(L(wa[h],"load-pages",i);a--;)ne(E("<div></div>"),a,function(a,c){D(X("de-entry",n),function(e){var k=e.getAttribute("info").split(";");k[0]!==d.host||k[1]!==C||(e=B("de-fav-inf-page",e),RegExp("(?:№|No.|>)\\s*"+k[2]+"\\s*<").test(a.innerHTML)?e.innerHTML="@"+c:5===b&&!e.textContent.contains("@")&&
(e.innerHTML="@?"))});5===b&&la(q("de-alert-load-pages"));b++;a=c=l})}),T(ob[h],id[h],function(){D(X("de-entry",n),function(a){var b=a.getAttribute("info").split(";");g.e&&b[0]!==d.host||ra(pa(b[0],b[1],b[2]),l,l,m,function(a,c,e){e&&(ic(b[0],b[1],b[2]),$a(JSON.stringify(H)));b=l})})}),T(Vb[h],Wb[h],function(){D(X("de-entry",n),function(a){var b=a.getAttribute("info").split(";");R("input",a).checked&&ic(b[0],b[1],b[2])});$a(JSON.stringify(H))}),t("div",{style:"display: none;"},[s("textarea",{rows:9,
cols:70},l),T(Ja[h],rb[h],function(){$a(this.previousSibling.value.trim().replace(/\n|\r/,""))})])])}function la(a){a&&(a.ob=l,f.animation?(g.U(a,v),g.r(a,"de-close")):v(a))}function L(a,b,c){var e=q("de-alert-"+b),k="de-alert-msg"+(c?" de-wait":""),z=c?"":"\u00d7 ";e?(V(R("div",e),{"class":k}).innerHTML=a.trim(),R("span",e).textContent=z,clearTimeout(e.ob),f.animation&&(g.U(e,function(a){g.T(a,"de-blink")}),g.r(e,"de-blink"))):(e=q("de-alert").appendChild(t("div",{"class":d.u,id:"de-alert-"+b},[s("span",
{"class":"de-alert-btn",text:z},{click:function(){la(this.parentNode)}}),E('<div class="'+k+'">'+a.trim()+"</div>")])),f.animation&&(g.U(e,function(a){g.T(a,"de-open")}),g.r(e,"de-open")));f.closePopups&&!c&&!b.contains("help")&&(e.ob=setTimeout(la,4E3,e))}function Ra(a,b,c){var e,k=ca(a);f.attachPanel&&b?(e="fixed",b="de-btn-refresh"===a.id||"de-btn-audio-off"===a.id?"bottom: 25":"top: "+(a.getBoundingClientRect().top+a.offsetHeight-(g.d?0.5:0))):(e="absolute",b="top: "+(oa(a).top+a.offsetHeight-
(g.d?0.5:0)));n.body.appendChild(S(E('<div class="'+d.u+'" id="de-select" style="position: '+e+"; "+("de-btn-src"===a.className?"left: "+oa(a).left:"right: "+(n.body.clientWidth-oa(a).left-a.offsetWidth))+"px; "+b+'px;" onmouseout="de_delSelection(event)">'+c+"</div>"),{mouseover:function(){k&&eb(k,m)}}));return q("de-select").getElementsByTagName("a")}function rf(a){D(Ra(a.target,i,'<div style="display: inline-block; border-right: 1px solid grey;"><a href="#">'+"#words,#exp,#exph,#imgn,#ihash,#subj,#name,#trip,#img".split(",").join('</a><a href="#">')+
'</a></div><div style="display: inline-block;"><a href="#">'+"#sage,#op,#tlen,#all,#video,#num,#wipe,#rep,#outrep".split(",").join('</a><a href="#">')+"</a></div>"),function(a){a.onclick=function(a){var b=this.textContent;w(a);Xa(q("de-spell-edit"),b+(r&&"#op"!==b&&"#rep"!==b&&"#outrep"!==b?"["+C+","+r+"]":"")+(F.ic(b.substr(1))?"(":""))}})}function tf(a){if(f.menuHiddBtn&&(f.filterThrds||!a.k)){var b=Ra(a.G.firstChild,m,'<a href="#">'+jd[h].join('</a><a href="#">')+"</a>");b[1].onclick=function(b){w(b);
a.H[0]?Ga("#img","(="+Xd(a)+"@"+fc(a).join("x")+")"):Ga("!#img","")};b[2].onclick=function(b){w(b);a.H[0]?Ga("#ihash","("+oe(a)+")"):Ga("!#img","")};b[3].onclick=function(b){w(b);uf(a)};(b=b[0]).onclick=function(a){w(a);Ga("#words","("+Sa+")")};b.onmouseover=function(){Sa=cc().trim()}}}function vf(a){D(Ra(a.G.querySelector("span:nth-child(3)"),m,'<a href="#">'+kd[h].join('</a><a href="#">')+"</a>"),function(b){b.onclick=function(b){w(b);fb(a,parseInt(this.textContent,10),l)}})}function ff(){D(Ra(q("de-btn-refresh"),
i,'<a href="#">'+ld[h].join('</a><a href="#">')+"</a>"),function(a){a.onclick=function(a){w(a);pe(Ca.indexOf.call(this.parentNode.children,this)+1)}})}function gf(){"de-btn-audio-off"===this.id&&D(Ra(q("de-btn-audio-off"),i,'<a href="#">'+md[h].join('</a><a href="#">')+"</a>"),function(a){a.onclick=function(a){w(a);a=Ca.indexOf.call(this.parentNode.children,this);Ua=0===a?3E4:1===a?6E4:2===a?12E4:3E5;he();q("de-btn-audio-off").id="de-btn-audio-on";v(this.parentNode)}})}function wf(a){var b=a.nextSibling.href+
'" target="_blank">'+nd[h],c=n.body.getAttribute("de-image-search"),e="";c&&(c=c.split(";"),c.forEach(function(a){a=a.split(",");e+='<a class="de-src'+a[0]+(!a[1]?'" onclick="de_cImgSearch(event, \''+a[0]+'\')" href="#" de-url="':'" href="'+a[1])+b+a[0]+"</a>"}));Ra(a,m,'<a class="de-src-iqdb" href="//iqdb.org/?url='+b+'IQDB</a><a class="de-src-tineye" href="//tineye.com/search/?url='+b+'TinEye</a><a class="de-src-google" href="//google.ru/searchbyimage?image_url='+b+'Google</a><a class="de-src-saucenao" href="//saucenao.com/search.php?url='+
b+"SauceNAO</a>"+e);e=l}function xf(){function a(){try{e=c(x,0>=e?0:e-1,-1,i,m),o=i}catch(a){}}function b(){if(e!==x.length-1)try{e=c(x,e+1,1,x[e+1].k||x[e+1].getBoundingClientRect().top>window.innerHeight/2-x[e+1].clientHeight/2,m),o=i}catch(a){}}function c(a,b,c,e,k){for(var d=b;a[d].h||a[d].K.h;)d+=c;a=a[d];if(d!==b||e)window.scrollTo(0,k?oa(a).top:oa(a).top-window.innerHeight/2+a.clientHeight/2);(b=B("de-selected",n))&&g.T(b,"de-selected");a.k&&(a=a.K);g.r(a,"de-selected");return d}var e,k=0,
z=m,o=i,u=i;window.onscroll=function(){z?z=m:u=o=i};n.addEventListener("keydown",function(p){var f=p.target.tagName,h=p.keyCode;if("TEXTAREA"===f||"INPUT"===f&&"text"===p.target.type)27===h&&p.target.blur();else if(!p.ctrlKey&&!p.altKey&&!(p.shiftKey||74!==h&&75!==h&&77!==h&&78!==h&&86!==h&&116!==h))if(116===h)r||(w(p),pe(1));else{w(p);p.stopPropagation();if(u){if(o)a:{for(var p=x,f=0,j=window.pageYOffset;f<p.length;f++)if(oa(p[f]).top>j){p=f-1;break a}p=ta}else p=x.indexOf(ga[k]);e=p}if(!r&&o)if((x[e]||
{}).k)k=f=ga.indexOf(x[e]);else if(u){for(f=0>=e?0:e;0<f&&!x[f].k;f--);k=f=ga.indexOf(x[f])}else f=k;else f=k;o=u=m;if(86===h)r?qc(x[e]):g.d?GM_openInTab(pa(d.host,C,ga[f].a),m,i):window.open(pa(d.host,C,ga[f].a),"_blank");else if(z=i,75===h)if(r)a();else try{k=c(ga,0>=k?0:k-1,-1,i,i),u=i}catch(n){}else if(74===h)if(r)b();else{if(k!==ga.length-1)try{k=c(ga,k+1,1,i,i),u=i}catch(q){}}else!r&&77===h?a():!r&&78===h&&b()}},i)}function qe(a,b){if(d.z||d.Ba)return a.replace(/\?[^?]+$|$/,(d.aa?"?board="+
C+"&":"?")+Math.random());0<b&&(a=a.replace(/mainpage|res\d+/ig,"res"+b));return a.replace(/dummy=[\d\.]*/,"dummy="+Math.random())}function gb(a){var b=j.$?q("recaptcha_image")||j.$:U(j.Q+"//img",j.j);d.i||j.$?(a=n.createEvent("MouseEvents"),a.initEvent("click",i,i),b.dispatchEvent(a)):(a=qe(b.getAttribute("src"),a),b.src="",b.src=a)}function re(){var a=f.sageReply;q("de-sagebtn").innerHTML="&nbsp;"+(a?'<span class="de-btn-sage"></span><b style="color: red;">SAGE</b>':"<i>(no&nbsp;sage)</i>");"text"===
j.M.type?j.M.value=a?"sage":d.b?"noko":"":j.M.checked=a}function oc(){var a=n.querySelector('input[info="nameValue"]');a&&P("nameValue",a.value);j.name.value=f.userName?f.nameValue:""}function je(){var a=n.querySelector('input[info="passwValue"]');a&&P("passwValue",a.value);(j.ac||{}).value=j.S.value=f.passwValue}function zf(){function a(){$b(n.body,{mousemove:b,mouseup:a});P("textaWidth",parseInt(j.g.style.width,10));P("textaHeight",parseInt(j.g.style.height,10))}function b(a){var b=oa(j.g);j.g.style.width=
a.pageX-b.left+"px";j.g.style.height=a.pageY-b.top+"px"}N(j.g,s("div",{id:"de-txt-resizer"},{mousedown:function(c){w(c);S(n.body,{mousemove:b,mouseup:a})}}))}function rc(a){D(a.querySelectorAll('input[type="file"]'),function(a){S(a,{change:se})})}function te(a){D(a.querySelectorAll(".de-file-util"),v);D(a.querySelectorAll('input[type="file"]'),function(a){a.Z=l})}function se(){this.ec?this.Z&&(this.Z=l,v(this.nextSibling)):(this.ec=i,N(this,V(s("button",{"class":"de-file-util de-file-del",text:ob[h],
type:"button"},{click:function(a){w(a);a=this.parentNode;te(a);S(j.file=Ud('input[type="file"]',Vd(a,a.innerHTML)),{change:se})}}))));!d.F&&!d.b&&(v(B("de-file-rar",this.parentNode)),/^image\/(?:png|jpeg)$/.test(this.files[0].type)&&N(this,V(s("button",{"class":"de-file-util de-file-rar",text:qd[h],type:"button"},{click:function(a){w(a);var a=q("de-file-rar")||n.body.appendChild(s("input",{id:"de-file-rar",type:"file",style:"display: none"},l)),b=this.parentNode.querySelector('input[type="file"]'),
c=this;a.onchange=function(){v(c);var a=this.files[0],k=new FileReader,d=E('<span class="de-file-util" style="margin: 0 5px;"><span class="de-wait"></span>'+rd[h]+"</span>");N(b,d);k.onload=function(){if(b.nextSibling===d){V(d,{style:"font-weight: bold; margin: 0 5px; cursor: default;",title:b.files[0].name+" + "+a.name,text:"rarJPEG"});b.Z=this.result}d=b=a=l};k.readAsArrayBuffer(a);c=l};a.click()}}))));rc(U(j.Q,this))}function ue(a,b,c){j.form.style.display="inline-block";j.form.style.textAlign=
"left";g.e?zf():S(j.g,{mouseup:function(){P("textaWidth",parseInt(this.style.width,10));P("textaHeight",parseInt(this.style.height,10))}});nc();j.g.style.cssText="width: "+f.textaWidth+"px; height: "+f.textaHeight+"px;";S(j.g,{keypress:function(a){var b=a.charCode||a.keyCode;if((33===b||34===b)&&0===a.which)a.target.blur(),window.focus()}});S(j.la,{click:function(){var a=j.g.value,b=f.signatValue;F.vb&&(a=F.jc(a));f.userSignat&&b&&(a+="\n"+b);if(j.J&&"Dollchan Extension Tools"===(B("filetitle",I[j.J])||
{}).textContent&&!/`\n`\-{50}`/.test(a))a+="\n\n`--------------------------------------------------`\n`"+window.navigator.userAgent+"`\n`v"+f.version+"`\n`--------------------------------------------------`";j.g.value=a;f.ajaxReply&&L(Qb[h],"upload",i);f.favOnReply&&j.J&&be(I[j.J],B("de-btn-fav",I[j.J].G));j.J?ea.reply=+ea.reply+1:ea.op=+ea.op+1;K("DESU_Stat_"+d.c,JSON.stringify(ea));if(j.na&&(a=j.na.value)&&(a=a.match(hb())))j.na.value="http://www.youtube.com/watch?v="+a[1];j.I&&(J(q("de-qarea")),
N(q("de-togglereply"),q("de-pform")))}});D(j.form.querySelectorAll('input[type="text"], input[type="file"]'),function(a){a.size=30});f.noGoto&&j.ua&&J(j.ua);f.noPassword&&j.S&&J(U(j.Q,j.S));S(window,{load:function(){f.userName&&j.name&&setTimeout(oc,1E3);j.S&&setTimeout(je,1E3)}});j.$&&(V(j.la,{onclick:"Recaptcha.focus_response_field = function() {}"}),(c=q("recaptcha_image"))&&V(c,{onclick:"Recaptcha.reload()",style:"width: 300px; cursor: pointer;"}));if(j.j&&(d.F&&setTimeout(function(){gb(0);j.j.onclick=
l},50),j.j.autocomplete="off",j.j.onfocus=l,j.j.onkeypress=function(a){if(f.captchaLang&&a.which!==0){var b,c=a.charCode||a.keyCode,d=String.fromCharCode(c).toLowerCase();if(f.captchaLang===1){if(c<1040||c>1279||(b="йцукенгшщзхъфывапролджэячсмитьбюё".indexOf(d))===-1)return;d="qwertyuiop[]asdfghjkl;'zxcvbnm,.`"[b]}else{if(c<33||c>122||
(b="qwertyuiop[]asdfghjkl;'zxcvbnm,.`".indexOf(d))===-1)return;d="йцукенгшщзхъфывапролджэячсмитьбюё"[b]}w(a);Xa(a.target,d)}},!d.i&&!j.$)){a=d.z?Ud("a, img",U(j.Q,j.j)):U(j.Q+"//img",j.j);b=s("img",{alt:wa[h],title:sd[h],style:"display: block; border: none; cursor: pointer;"},{click:function(){gb(r||0)}});if(a)a.parentNode.replaceChild(b,
a);else{for(;j.j.nextSibling;)v(j.j.nextSibling);N(j.j,b)}setTimeout(function(b){b.src=qe(d.aa?"/faptcha.php?board="+C:d.xb?"/securimage/securimage_show.php?"+Math.random():d.z?"/"+C.substr(0,C.indexOf("/")+1)+"captcha.php?"+Math.random():a?a.src:"/"+C+"/captcha.pl?key=mainpage&amp;dummy="+Math.random(),r||0)},50,b)}f.addSageBtn&&j.M&&(b=s("span",{id:"de-sagebtn"},{click:function(a){a.stopPropagation();w(a);Ab("sageReply");re()}}),c=U("ancestor::label",j.M)||j.M,c.nextElementSibling||c.previousElementSibling?
(J(c),N(c,b)):(J(U(j.Q,j.M)),N(j.name||j.la,b)),setTimeout(re,0));if(2===f.ajaxReply){if(j.form.onsubmit=function(a){w(a);sc(new Bb(j.form,j.la),ve)},A.onsubmit=w,b=A.querySelector(d.oc))b.onclick=function(a){w(a);Ha();L(Yb[h],"deleting",i);sc(new Bb(A,this),we)}}else 1===f.ajaxReply&&(fa(q("de-main"),[E('<iframe id="de-iframe-pform" name="de-iframe-pform" src="about:blank"/>'),E('<iframe id="de-iframe-dform" name="de-iframe-dform" src="about:blank"/>')]),V(j.form,{target:"de-iframe-pform"}).onsubmit=
l,V(A,{target:"de-iframe-dform"}).onsubmit=function(){Ha();L(Yb[h],"deleting",i)});j.file&&rc(U(j.Q,j.file))}function xe(a){if(!a.body.firstChild||a.querySelector(d.ia))return"";var b="";D(a.querySelectorAll(d.i?".post-error, h2":d.z?'h1, h2, div[style*="1.25em"]':d.b?"#errmsg":d.f?".message_text":d.n?"pre":'h1, h2, font[size="5"]'),function(a){b+=a.innerHTML+"\n"});(b=b.replace(/<a [^>]+>Назад.+|<br.+/,""))||(b=sb[h]+"\n"+a.body.innerHTML);return/successful|uploaded|updating|обновл|удален[о\.]/i.test(b)?
"":b.replace(/"/g,"'")}function ye(){la(q("de-alert-upload"));2===f.updThread&&sa(l,0)}function ve(a,b){var c;a?(j.I&&(J(c=q("de-qarea")),c.appendChild(q("de-pform"))),j.j&&/captch|капч|подтвер/i.test(a)&&(j.j.value="",j.j.focus(),gb(j.J)),L(a,"upload",m)):(j.g.value="",j.file&&(c=U(j.Q,j.file),te(c),c=Vd(c,c.innerHTML),j.file=c.querySelector('input[type="file"]'),rc(c)),j.na&&(j.na.value=""),c=j.J)?(Ha(),r?Cb(m,ye):fb(I[c],5,ye),j.j&&(j.j.value=
"",gb(c))):window.location=b}function ze(a,b){if(b)return window.location;var c=a.querySelector(d.ia);return c?pa(d.host,C,d.sa(c)):""}function Ae(){var a=q("de-alert-deleting");a&&(la(a),L(td[h],"deleted",m))}function we(a){var b=[];a?L(ud[h]+a,"deleting",m):(D(A.querySelectorAll("[de-post] input:checked"),!r?function(a){a=ca(a).K.a;-1===b.indexOf(a)&&b.push(a)}:function(a){a.checked=m}),r?Cb(m,Ae):b.forEach(function(a){fb(I[a],5,Ae)}));b=l}function sc(a,b){if(!a.error)if(0<a.Oa)setTimeout(sc,200,
a,b);else{var c={"Content-type":"multipart/form-data; boundary="+a.qa};g.d&&(c.Referer=""+n.location);a.data.push("--"+a.qa+"--\r\n");GM_xmlhttpRequest({method:"POST",headers:c,data:new Blob(a.data),url:g.Qa(a.url),onreadystatechange:function(a){4===a.readyState&&(200===a.status?(a=g.Kb(a.responseText),b(xe(a),ze(a,m)),b=l):L(0===a.status?na[h]:"HTTP ["+a.status+"] "+a.statusText,"upload",m))}})}}function Af(a,b){var c=0,e=0,k=a.length,d=0,o=!!f.removeEXIF,u=m;if(!f.postSameImg&&!o&&!b)return[a];
if(255===a[0]&&216===a[1]){for(;c<k-1;)a:{if(255===a[c]){if(o){if(225===a[c+1]&&69===a[c+4]&&!u)b:{var p=c+10,u=(a[c+2]<<8)+a[c+3],h=ta,g=ta,j=ta,n=ta,q=ta,s=0,r=0,t=0,v="MM"!==String.fromCharCode(a[p],a[p+1]),p=new DataView(a.buffer,p);if(42!==p.getUint16(2,v))u=m;else if(h=p.getUint32(4,v),h>u)u=m;else{q=p.getUint16(h,v);for(g=0;g<q;g++)if(n=p.getUint16(j=h+2+12*g,v),!(282!==n&&283!==n&&296!==n))if(296===n)t=p.getUint16(j+8,v)-1;else{j=p.getUint32(j+8,v);if(j>u){u=m;break b}282===n?s=Math.round(p.getUint32(j,
v)/p.getUint32(j+4,v)):r=Math.round(p.getUint32(j,v)/p.getUint32(j+4,v))}s=s||r;r=r||s;u=[t,s>>8,s&255,r>>8,r&255]}}else 224===a[c+1]&&70===a[c+7]&&!u&&(u=[a[c+11],a[c+12],a[c+13],a[c+14]]);if(14===a[c+1]>>4||254===a[c+1]){c+=2+(a[c+2]<<8)+a[c+3];break a}}if(216===a[c+1])d++;else if(217===a[c+1]&&0===--d){a[e]=a[c];break}}e!==c&&(a[e]=a[c]);c++;e++}e+=2;c+=2;if(e!==c)a[e-1]=a[c-1];else if(e===k)return[a];if(!b&&75<k-c)for(;c<k;a[e++]=a[c++]);if(o){d=new Uint8Array(k=e+18);d.set(Ca.concat.apply([255,
216,255,224,0,16,74,70,73,70,0,1,1],u||[0,0,1,0,1]));c=2;for(e=20;e<k;c++,e++)d[e]=a[c];return[d]}}else if(137===a[0]&&80===a[1]){for(;e<k-7&&!(73===a[e]&&69===a[e+1]&&78===a[e+2]&&68===a[e+3]);e++);e+=8;if(e===k||!b&&75<k-e)return[a]}else return l;return[new Uint8Array(a,e)]}function Bb(a,b){this.qa="---------------------------"+Math.round(1E11*Math.random());this.data=[];this.Oa=0;this.error=m;this.url=a.action;D(a.querySelectorAll('input:not([type="submit"]):not([type="button"]), textarea, select'),
this.append.bind(this));this.append(b)}function qc(a){var b=a.K.a,c=q("de-qarea");j.J=b;if(j.I){if(d.ta(a).nextElementSibling===c){J(c);Ha();return}}else j.I=i,c.appendChild(q("de-pform")),J(q("de-togglereply")),!r&&!d.z&&!d.i&&(v(j.form.querySelector('#thr_id, input[name="parent"]')),$(j.form.firstChild,E('<input type="hidden" id="thr_id" value="'+b+'" name="'+(d.b||d.o?"resto":d.p?"thread":"parent")+'">')),ba&&(v(ba.querySelector('input[name="oek_parent"]')),$(ba.firstChild,E('<input type="hidden" value="'+
b+'" name="oek_parent">'))));N(d.ta(a),c);c.style.display="";r||(Be(b),f.noThrdForm&&(q("de-parea").style.display="none"));j.j&&!j.$&&!d.z&&gb(b);d.n&&"Comment"===j.g.value&&(j.g.value="");Xa(j.g,">>"+a.a+(Sa||"").replace(/(?:^|\n)(.)/gm,"\n> $1")+"\n");3===f.addPostForm&&V(R("a",q("de-qarea-target")),{href:pa(d.host,C,b),text:"#"+b})}function Ha(){if(j.I){var a=q("de-togglereply"),b=q("de-qarea");j.I=m;r||(Be(0),v(q("thr_id")));J(a);b.style.display="none";N(q("de-parea"),b);N(a,q("de-pform"))}}function Be(a){j.form.querySelector('#thr_id, input[name*="thread"]').value=
a;ba&&(ba.querySelector('input[name="oek_parent"], input[name="replyto"]').value=a);d.Cb&&(j.form.querySelector('input[name="quickreply"]').value=a||"")}function ee(a){var b=q("de-parea");w(a);j.I?(b.style.display="",Ha()):J(b);bc(b)}function Bf(a){/Reply|Ответ/.test(a.target.textContent)||((a.stopPropagation(),w(a),!r&&f.noThrdForm&&!j.I&&(q("de-parea").style.display=""),a=ca(a.target).a,r&&1<f.addPostForm&&!j.I)?qc(I[a]):(d.n&&"Comment"===j.g.value&&(j.g.value=""),Xa(j.g,
">>"+a)))}function nc(){if(j.g){var a=d.z||d.f||d.n||d.N||d.xc,b={bold:[d.n?"**":a?"b":"**","B"],italic:[d.n?"*":a?"i":"*","i"],under:[a?"u":"__","U"],strike:[d.N?"-":a?"s":d.aa?"^^":"","S"],spoil:[d.N?"s":d.n?"%":a||d.b?"spoiler":"%%","%"],code:[d.N?"c":d.f?"aa":d.n?"pre":a?"code":"`","C"],quote:[,"&gt;"]},c=function(e){var k=j.g,z=q("de-btn-"+e),o=b[e][1];z||(z=s("span",{id:"de-btn-"+e,title:vd[e][h]},l),"&gt;"!==o?z.onclick=function(c){var e,o,z=k.selectionStart,f=k.selectionEnd,h=k.scrollTop,
g=k.value.substring(z,f).split("\n"),j=g.length;e=b[this.id.substring(7)][0];w(c);a||d.b&&"spoiler"===e?(c="["+e+"]",e="[/"+e+"]"):c=e;for(;j--;){if(!c)for(o=g[j].trim().length;o--;)e+="^H";o=f+c.length+e.length;g[j].match(/^\s+/)&&(c=g[j].match(/^\s+/)[0]+c);g[j].match(/\s+$/)&&(e+=g[j].match(/\s+$/)[0]);g[j]=c+g[j].trim()+e}k.value=k.value.substr(0,z)+g.join("\n")+k.value.substr(f);k.setSelectionRange(o,o);k.focus();k.scrollTop=h}:(z.onmouseover=function(){Sa=cc()},z.onclick=function(a){var b=k.selectionStart,
c=k.selectionEnd;w(a);Xa(k,"> "+(b===c?Sa:k.value.substring(b,c)).replace(/\n/gm,"\n> "))}),q("de-txt-panel").appendChild(z));z.innerHTML=2===f.addTextBtns?("B"===o?"[ ":"")+'<a href="#">'+o+"</a>"+("&gt;"!==o?" / ":" ]"):3===f.addTextBtns?'<input type="button" value="'+o+'" style="font-weight: bold;" />':"";return c};N(f.txtBtnsLoc?q("de-txt-resizer")||j.g:d.n?B("popup",j.form):j.la,V(q("de-txt-panel")||s("span",{id:"de-txt-panel"},l),{lang:!f.addTextBtns?"en":!f.txtBtnsLoc?"ru":""}));c("bold")("italic");
d.n||c("under")("strike");c("spoil")("code")("quote")}}function tc(a){var b,c=a.querySelector(d.Fb),e='<span class="de-ppanel'+(a.k?"-op":"")+' de-ppanel-cnt" info="'+a.a+'"><span class="de-btn-hide" onclick="de_hideClick(this)" onmouseover="de_hideOver(this)" onmouseout="de_btnOut(event)"></span>'+(j.nc||ba?'<span class="de-btn-rep" onclick="de_qReplyClick(this)" onmouseover="de_qReplyOver(this)"></span>':"");a.k&&(b=d.host,r||(e+='<span class="de-btn-expthr" onclick="de_expandClick(this)" onmouseover="de_expandOver(this)" onmouseout="de_btnOut(event)"></span>'),
H[b]&&H[b][C]&&H[b][C][a.a]?(e+='<span class="de-btn-fav-sel" onclick="de_favorClick(this)"></span>',H[b][C][a.a].pb=a.K.P+1):e+='<span class="de-btn-fav" onclick="de_favorClick(this)"></span>');g.ga(c,e+(a.Jb?'<span class="de-btn-sage" title="SAGE" onclick="de_sageClick(this)"></span>':"")+"</span>");a.G=c.nextSibling;j.O&&f.insertNum&&((d.ya||r&&(d.z||d.Ba))&&D(c.getElementsByTagName("a"),function(a){a.onclick=l}),d.w||(c.onclick=Bf))}function Cf(){ec('function de_removeSel() {\t\t\tvar el = document.getElementById("de-select");\t\t\tif(el) {\t\t\t\tel.parentNode.removeChild(el);\t\t\t}\t\t}\t\tfunction de_delSelection(e) {\t\t\tif(e.relatedTarget && !document.evaluate("ancestor-or-self::div[@id=\'de-select\']", e.relatedTarget, null, 3, null).booleanValue) {\t\t\t\tde_removeSel();\t\t\t}\t\t}\t\tfunction de_btnOut(e) {\t\t\tclearTimeout(e.target.de_overDelay);\t\t\tde_delSelection(e);\t\t}\t\tfunction de_btnOver(el, data) {\t\t\tel.de_overDelay = setTimeout(function(msg) {\t\t\t\twindow.postMessage(msg, "*");\t\t\t}, '+
f.linksOver+', data);\t\t}\t\tfunction de_hideOver(el) {\t\t\tde_btnOver(el, "A" + el.parentNode.getAttribute("info"));\t\t}\t\tfunction de_imgSOver(el) {\t\t\tde_btnOver(el, "L" + el.getAttribute("de-id"));\t\t}\t\tfunction de_expandOver(el) {\t\t\tde_btnOver(el, "B" + el.parentNode.getAttribute("info"));\t\t}\t\tfunction de_hideClick(el) {\t\t\twindow.postMessage("D" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_qReplyClick(el) {\t\t\twindow.postMessage("F" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_qReplyOver(el) {\t\t\twindow.postMessage("C" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_expandClick(el) {\t\t\twindow.postMessage("E" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_favorClick(el) {\t\t\twindow.postMessage("G" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_sageClick(el) {\t\t\twindow.postMessage("H" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_cImgSearch(e, name) {\t\t\te.preventDefault();\t\t\twindow.postMessage("_" + name + ";" + e.target.getAttribute("de-url"), "*");\t\t\tde_removeSel();\t\t}');
S(window,{message:function(a){var b=a.data.substring(1);switch(a.data[0]){case "A":tf(I[+b]);break;case "B":vf(I[+b]);break;case "C":Sa=cc();break;case "D":a=I[+b];Qa(a,!a.h);Oa();break;case "E":fb(I[+b],1,l);break;case "F":qc(I[+b]);break;case "G":a=I[+b];be(a,B("de-btn-fav",a)||B("de-btn-fav-sel",a));break;case "H":Ga("#sage","");break;case "I":v(q("de-fav-wait"));q("de-iframe-fav").style.height=b+"px";break;case "J":a=b.split("$#$");"de-iframe-pform"===a[0]?ve(a[1],a[2]):we(a[1]);q(a[0]).src="about:blank";
break;case "L":wf(A.querySelector('.de-btn-src[de-id="'+b+'"]'))}}});g.Y||ec('(function() {\t\t"use strict";\t\twindow.addEventListener("message", function(e) {\t\t\tvar id = e.data[0],\t\t\t\tdata = e.data.substring(1);\t\t\tif(id === "K") {\t\t\t\tvar mReqs = data === "all" ? 4 : 1, i = mReqs, rjw'+(f.findRarJPEG?'= []; while(i--) rjw.push(new Worker("'+window.URL.createObjectURL(new Blob(["self.onmessage = "+Df]))+'"));':";")+"preloadImages(data, mReqs, rjw);\t\t\t\treturn;\t\t\t}\t\t});\t\tvar $x = function(path, root) {\t\t\t\treturn document.evaluate(path, root, null, 8, null).singleNodeValue;\t\t\t},\t\t\tgetPostImages = "+
(""+La)+",\t\t\tgetPicWrap = "+(""+d.ub)+";\t\tfunction preloadImages(pNum, mReqs, rjw) {\t\t\tvar len, el, cReq = 0, i = 0, arr = [],\t\t\t\tbwrk = mReqs === 4 ? [0, 0, 0, 0] : [0],\t\t\t\tloadFunc = function(idx) {\t\t\t\t\tif(idx >= arr.length) {\t\t\t\t\t\tif(cReq === 0) {\t\t\t\t\t\t\tmReqs = cReq = i = arr = loadFunc = null;\t\t\t\t\t\t}\t\t\t\t\t\treturn;\t\t\t\t\t}\t\t\t\t\tvar xhr, url, type, eImg = "+!!f.noImgSpoil+",\t\t\t\t\t\ta = arr[idx];\t\t\t\t\tif(!a || !(url = a.href)) {\t\t\t\t\t\tloadFunc(i++);\t\t\t\t\t\treturn;\t\t\t\t\t}\t\t\t\t\tif(/.gif$/i.test(url)) {\t\t\t\t\t\teImg |= "+
!!f.showGIFs+';\t\t\t\t\t\ttype = "image/gif";\t\t\t\t\t} else if(/.jpe?g$/i.test(url)) {\t\t\t\t\t\ttype = "image/jpeg";\t\t\t\t\t} else if(/.png$/i.test(url)) {\t\t\t\t\t\ttype = "image/png";\t\t\t\t\t} else {\t\t\t\t\t\tloadFunc(i++);\t\t\t\t\t\treturn;\t\t\t\t\t}\t\t\t\t\tif(cReq === mReqs) {\t\t\t\t\t\tsetTimeout(loadFunc, 500, idx);\t\t\t\t\t\treturn;\t\t\t\t\t}\t\t\t\t\tcReq++;\t\t\t\t\txhr = new XMLHttpRequest();\t\t\t\t\txhr.open("GET", url, true);\t\t\t\t\txhr.responseType = "arraybuffer";\t\t\t\t\txhr.onload = function() {\t\t\t\t\t\tif(this.status == 200) {\t\t\t\t\t\t\ta.download = url.substring(url.lastIndexOf("/") + 1);\t\t\t\t\t\t\tvar href = a.href = window.'+
(g.m?"webkit":"")+'URL.createObjectURL(new Blob([new Uint8Array(this.response)], {"type": type}));\t\t\t\t\t\t\tif(eImg) {\t\t\t\t\t\t\t\ta.getElementsByTagName("img")[0].src = href;\t\t\t\t\t\t\t}'+(f.findRarJPEG?"parseRJ(a);":"")+"cReq--; loadFunc(i++); a = eImg = url = type = null;\t\t\t\t\t\t}\t\t\t\t\t};\t\t\t\t\txhr.send(null);\t\t\t\t}"+(f.findRarJPEG?",\t\t\t\tparseRJ = function(link) {\t\t\t\t\tvar wI = bwrk.indexOf(0), w;\t\t\t\t\tif(wI === -1) {\t\t\t\t\t\tsetTimeout(parseRJ, 500, link);\t\t\t\t\t\treturn;\t\t\t\t\t}\t\t\t\t\tw = rjw[wI];\t\t\t\t\tbwrk[wI] = 1;\t\t\t\t\tw.onmessage = function(e) {\t\t\t\t\t\tif(e.data) {\t\t\t\t\t\t\tgetPicWrap(link).querySelector('"+
d.Db+'\').className += " de-archive";\t\t\t\t\t\t}\t\t\t\t\t\tbwrk[wI] = 0;\t\t\t\t\t\tlink = wI = null;\t\t\t\t\t};\t\t\t\t\tw.onerror = function(e) {\t\t\t\t\t\tconsole.error("RARJPEG ERROR, line: " + e.lineno + " - " + e.message);\t\t\t\t\t\tbwrk[wI] = 0;\t\t\t\t\t\tlink = wI = null;\t\t\t\t\t};\t\t\t\t\tw.postMessage(link.href);\t\t\t\t};':";")+'el = getPostImages(pNum === "all" ? document : document.querySelector("[de-post=\'" + pNum + "\']"));\t\t\tfor(i = 0, len = el.length; i < len; i++) {\t\t\t\tarr.push($x("ancestor::a[1]", el[i]));\t\t\t}\t\t\tfor(i = 0; i < mReqs; i++) {\t\t\t\tloadFunc(i);\t\t\t}\t\t}})()')}
function za(a,b,c,e,k){za.nb(a)?this.disabled=i:(this.Ib=a.replace(/(?:[sihdny]\?){2,}/g,function(a){return"(?:"+a.replace(/\?/g,"")+")?"}).replace(/\-/g,"[^<]").replace(/\+/g,"[^0-9]").replace(/([sihdny]+)/g,"($1)").replace(/[sihdny]/g,"\\d").replace(/m|w/g,"([a-zA-Zа-яА-Я]+)"),this.pattern=a.replace(/[\?\-\+]+/g,"").replace(/([a-z])\1+/g,"$1"),this.$b=parseInt(b,10),this.Vb=wd[c],this.Ub=xd[c],this.Tb=yd[c],e&&k&&Za(e)===+k&&(this.yb=i,this.ja=e.substring(1),this.Ra=!!+e[0]))}
function Ef(a,b){GM_xmlhttpRequest({method:"GET",url:"https://www.youtube.com/watch?v="+a,onload:function(a){var e,k,d,o,f=[];e="%2C";var p="%26",g="%3D";if(k=a.responseText.match(/\"url_encoded_fmt_stream_map\":\s*\"([^\"]+)\"/)){k=k[1];k.contains(",")&&(e=",",p=k.contains("&")?"&":"\\u0026",g="=");a=0;e=k.split(e);for(k=e.length;a<k;a++)d=e[a].split(p),5>d.length||(o=d[0].split(g),2>o.length||(o=unescape(unescape(o[1])).replace(/\\\//g,"/").replace(/\\u0026/g,"&"),d=d[4].split(g),2>d.length||0===
o.toLowerCase().indexOf("http")&&(f[d[1]]=o)));b(f)}else b(m);b=l}})}function Ce(a,b,c){var e=' width="'+f.YTubeWidth+'" height="'+f.YTubeHeigh+'" />';a.innerHTML=1===f.YTubeType?'<iframe type="text/html" src="https://www.youtube.com/embed/'+b+(f.YTubeHD?"?hd=1&":"?")+"start="+c+'&html5=1" frameborder="0"'+e:'<embed type="application/x-shockwave-flash" src="https://www.youtube.com/v/'+b+(f.YTubeHD?"?hd=1&":"?")+"start="+c+'" wmode="transparent"'+e}function uc(a,b){var c=b[1],e=(b[2]?3600*b[2]:0)+
(b[3]?60*b[3]:0)+(b[4]?+b[4]:0);2!==f.YTubeType?Ce(a,c,e):Ef(c,function(b){(b=b?!f.YTubeHD?b[43]:b[45]||b[44]||b[43]:m)?(a.innerHTML='<video poster="https://i.ytimg.com/vi/'+c+'/0.jpg" controls="controls" preload="none" src="'+b+(g.d&&14>g.d?"&"+Math.random():"")+'" width="'+f.YTubeWidth+'" height="'+f.YTubeHeigh+'"></video>',0!==e&&(a.firstChild.Cc=function(){this.currentTime=e;e=l})):Ce(a,c,e)})}function vc(a,b){a.innerHTML='<a href="https://www.youtube.com/watch?v='+b[1]+'" target="_blank"><img src="https://i.ytimg.com/vi/'+
b[1]+'/0.jpg" width="360" height="270" /></a>';3===f.addYouTube&&(a.firstChild.onclick=function(a){w(a);uc(this.parentNode,b)})}function hb(){return/^https?:\/\/(?:www\.)?youtu(?:be\.com\/(?:watch\?.*?v=|v\/|embed\/)|\.be\/)([^&#?]+).*?(?:t(?:ime)?=(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s?)?)?$/}function De(a){var b=this.href.match(hb()),c=B("de-ytube-obj",ca(this));w(a);ia('*[contains(@src,"'+b[1]+'")]|video[contains(@poster,"'+b[1]+'")]',c)?c.innerHTML="":2<f.addYouTube&&!ia('a[contains(@href,"'+b[1]+'")]',
c)?vc(c,b):uc(c,b)}function Db(a){f.addYouTube&&(D((a||A).querySelectorAll("embed"),function(b){var c,e;if(e=b.src.match(hb())){c="https://www.youtube.com/watch?v="+e[1];if(e[4]||e[3]||e[2])c+="#t="+(e[2]?e[2]+"h":"")+(e[3]?e[3]+"m":"")+(e[4]?e[4]+"s":"");e=a||ca(b);(e.l||e.querySelector(d.A)).appendChild(E('<p class="de-ytube-ext"><a href="'+c+'">'+c+"</a></p>"));v(b.parentNode)}}),D((a||A).querySelectorAll('a[href*="youtu"]'),function(b){var c,e,k,z,o=b.href.match(hb());o&&((b.href=b.href.replace(/^http:/,
"https:"),c=a||ca(b),c.$a||(c.$a=e=s("div",{"class":"de-ytube-obj"},l),2<f.addYouTube?vc(e,o):2===f.addYouTube&&uc(e,o),k=c.l||c.querySelector(d.A),d.f?(k=k.parentNode,z=k.previousElementSibling,$(z.hasAttribute("style")?z:k,e)):$(k,e)),b.className="de-ytube-link",b.onclick=De,f.YTubeTitles)?(b.Ya=1,GM_xmlhttpRequest({method:"GET",url:"https://gdata.youtube.com/feeds/api/videos/"+o[1]+"?alt=json&fields=title/text(),media:group/media:keywords",onreadystatechange:function(a){if(a.readyState===4){if(a.status===
200)try{b.textContent=JSON.parse(a.responseText).entry.title.$t;b.Ya=2;return}catch(e){}b.Ya=3;b=c=l}}})):b.textContent=b.textContent.replace(/^http:/,"https:"))}))}function Eb(a){f.addMP3&&D((a||A).querySelectorAll('a[href*=".mp3"]'),function(b){if("_blank"===b.target||"nofollow"===b.rel){var c=a||ca(b),e=B("de-mp3",c);e||(e=s("div",{"class":"de-mp3"},l),$(c.l||c.querySelector(d.A),e));ia('.//object[contains(@FlashVars,"'+b.href+'")]',e)||(e.innerHTML+='<object data="//junglebook2007.narod.ru/audio/player.swf" type="application/x-shockwave-flash" wmode="transparent" width="220" height="16" FlashVars="playerID=1&amp;bg=0x808080&amp;leftbg=0xB3B3B3&amp;lefticon=0x000000&amp;rightbg=0x808080&amp;rightbghover=0x999999&amp;rightcon=0x000000&amp;righticonhover=0xffffff&amp;text=0xffffff&amp;slider=0x222222&amp;track=0xf5f5dc&amp;border=0x666666&amp;loader=0x7fc7ff&amp;loop=yes&amp;autostart=no&amp;soundFile='+
b.href+'" /><br>')}})}function Ff(a){function b(){$b(n.body,{mousemove:c,mouseup:b})}function c(b){a.style.left=b.clientX-a.Xb+"px";a.style.top=b.clientY-a.Yb+"px";a.Ab=i}a.onmousedown=function(e){w(e);a.Xb=e.clientX-parseInt(a.style.left,10);a.Yb=e.clientY-parseInt(a.style.top,10);S(n.body,{mousemove:c,mouseup:b})}}function Gf(a){var b=a.clientX,c=a.clientY,e=parseInt(this.style.left,10),d=parseInt(this.style.top,10),z=parseFloat(this.style.width||this.width),o=parseFloat(this.style.height||this.height),
f=g.d?-a.detail:a.wheelDelta,p=z*(0<f?1.25:0.8),f=o*(0<f?1.25:0.8);w(a);this.style.width=p+"px";this.style.height=f+"px";this.style.left=parseInt(b-p/z*(b-e),10)+"px";this.style.top=parseInt(c-f/o*(c-d),10)+"px"}function Ee(a,b,c){var e="",d="",z=+b[0],b=+b[1],o=n.body.clientWidth,u=window.innerHeight,p=B("de-img-full",a);if(!(p&&c||!p&&c===m))if(1===f.expandImgs&&!ia('img[contains(@style,"fixed")]',a)&&J(R("img",a)),p)p.Ab?p.Ab=m:(J(p),setTimeout(v,0,p));else if(1===f.expandImgs?o-=oa(a).left+25:
v(B("de-img-center",n)),z&&b&&(e=z<o?z:o,d=e*b/z,2===f.expandImgs&&d>u&&(d=u,e=d*z/b)),p=a.appendChild(E('<img class="de-img-full" src="'+a.href+'" alt="'+a.href+'" width="'+e+'" height="'+d+'"/>')),2===f.expandImgs)g.r(p,"de-img-center"),p.style.cssText="left: "+(o-e)/2+"px; top: "+(u-d)/2+"px;",p.addEventListener(g.d?"DOMMouseScroll":"mousewheel",Gf,m),Ff(p)}function Fe(a){a.onclick=function(a){f.expandImgs&&1!==a.button&&(w(a),Ee(this,this.firstChild.title.split("x"),l))}}function Fb(a){if(f.addImgs)for(var b,
c=0,e=a.querySelectorAll(d.A+' a[href*=".jpg"], '+d.A+' a[href*=".png"], '+d.A+' a[href*=".gif"]'),k=e.length;c<k;c++){b=e[c];if("SMALL"===b.parentNode.tagName)break;a=b.cloneNode(m);a.target="_blank";J(a);a.appendChild(s("img",{"class":"de-img-pre",src:a.href,alt:a.href},{load:function(){var a,b;J(this.parentNode);a=this.width;b=this.height;this.title=a+"x"+b;200>=a&&200>=b||(a/=b,this.width=1>a?200*a:200,this.height=1>a?200:200/a)}}));Fe(a);$(b,a)}}function Gb(a){if(f.imgSrcBtns)for(var b=a.a||
"",a=a.querySelectorAll(d.Db),c=a.length-1,e;0<=c;c--)e=a[c],/google\.|tineye\.com|iqdb\.org/.test(e.href)?v(e):e.firstElementChild||g.zb(e,'<span de-id="'+b+c+'" class="de-btn-src" onmouseover="de_imgSOver(this)" onmouseout="de_btnOut(event)"></span>')}function Ge(a,b){/\.jpe?g|\.png|.\gif|^blob:/i.test(a.href)&&Ee(a,fc(d.ub(a)),b)}function kc(a,b){D(a.H,function(a){Ge(U("ancestor::a[1]",a),b)})}function Hb(a){D(a.H,function(a){var c=U("ancestor::a[1]",a);c&&(a.onclick=l,d.rb&&(a.parentNode.onclick=
l),c.onclick=function(a){if(a.button!==1){w(a);Ge(this,l)}})})}function Df(a){var b,c,e;b=new XMLHttpRequest;b.open("GET",a.data,m);b.responseType="arraybuffer";b.send();a=new Uint8Array(b.response);e=a.length;if(255===a[0]&&216===a[1])for(c=b=0;b<e-1;b++){if(255===a[b])if(216===a[b+1])c++;else if(217===a[b+1]&&0===--c){b+=2;break}}else if(137===a[0]&&80===a[1])for(b=0;b<e-7;b++){if(73===a[b]&&69===a[b+1]&&78===a[b+2]&&68===a[b+3]){b+=8;break}}else{self.postMessage(m,l);return}if(b!==e&&60<e-b)for(e=
b+50;b<e;b++)if(55===a[b]&&122===a[b+1]||80===a[b]&&75===a[b+1]||82===a[b]&&97===a[b+1]){self.postMessage(i,l);return}self.postMessage(m,l)}function He(a){var b='<div class="de-refmap">'+a.v.join(", ").replace(/(\d+)/g,'<a href="#$1">&gt;&gt;$1</a>')+"</div>";try{g.ga(a.l,b)}catch(c){a.appendChild(E(b))}}function wc(a){var b=[];g.forEach(a,function(c){for(var e,d,f=this[c].l.getElementsByTagName("a"),o=f.length-1;0<=o;o--)if((e=f[o].textContent.match(/^>>(\d+)$/))&&(d=a[e[1]]))d.v?-1===d.v.indexOf(c)&&
d.v.push(c):(d.v=[c],b.push(d))});b.forEach(He);b=a=l}function Ib(a){if(a){a.parent?a.parent.X=l:ua=l;do{clearTimeout(a.tc);var b=a;f.animation?(g.U(b,v),g.r(b,"de-pview-anim"),b.style[g.ea]="de-post-close-"+(b.kb?"t":"b")+(b.jb?"l":"r")):v(b)}while(a=a.X)}}function eb(a,b){a&&(clearTimeout(nb),nb=setTimeout(Ib,f.linksOut,b?a:a.X))}function xc(){this.style[g.ea]&&(g.T(this,"de-pview-anim"),this.style.cssText=this.xa,this.xa=m,D(X("de-css-move",n.head),v),this.removeEventListener(g.da,xc,m))}function Ie(a,
b,c){if(b.link!==a){b.link=a;var e,d;e=a.getBoundingClientRect();d=e.left+window.pageXOffset+a.offsetWidth/2;var z=e.top+window.pageYOffset,o=n.body.clientWidth,u=d<o/2,o=(u?o-d:d)-10,p="max-width:"+o+"px; left:"+(u?d:d-Math.min(parseInt(b.offsetWidth,10),o))+"px;";c?(o=b.style.cssText,b.style.cssText="opacity: 0; "+p):b.style.cssText=p;d=b.offsetHeight;e=d+e.top+a.offsetHeight<window.innerHeight||5>e.top-d;d=(e?z+a.offsetHeight:z-d)+"px";b.jb=u;b.kb=e;!f.animation||!c?b.style.top=d:(a="de-movecss-"+
Math.round(1E3*Math.random()),n.head.appendChild(s("style",{"class":"de-css-move",type:"text/css",text:"@"+g.qb+"keyframes "+a+" {to { "+p+" top:"+d+"; }}"},l)),b.xa?(b.style.cssText=b.xa,b.removeEventListener(g.da,xc,m)):b.style.cssText=o,b.xa=p+" top:"+d+";",b.addEventListener(g.da,xc,m),g.r(b,"de-pview-anim"),b.style[g.ea]=a)}}function Je(a,b){(B("de-pview-link",a)||{}).className="";(U('.//a[starts-with(text(),">>") and contains(text(),"'+b+'")]',a)||{}).className="de-pview-link"}function Jb(a,
b,c,e,k){clearTimeout(nb);var z;if(a){if(k=(z=a.ownerDocument===n)?a.cloneNode(i):Kb(a),k.setAttribute("de-post",l),k.className=d.u+" de-pview"+(a.ab?" de-viewed":""),k.style.display="",d.ba&&(k.firstElementChild.style.cssText="max-width: 100%; margin: 0;",v(B("doubledash",k))),k.a=b,D(k.querySelectorAll(".de-img-full, .de-ppanel, .de-ppanel-op"),v),z?(f.addYouTube&&(D(X("de-ytube-link",k),function(a){a.onclick=De}),3===f.addYouTube&&D(X("de-ytube-obj",k),function(a){vc(a,a.firstChild.href.match(hb()))})),
f.addImgs&&D(X("de-img-pre",k),function(a){Fe(a.parentNode)}),f.imgSrcBtns&&D(X("de-btn-src",k),function(a){a.setAttribute("de-id","pv"+a.getAttribute("de-id"))})):(Eb(k),Db(k),Fb(k),Gb(k)),D(k.H=La(k),function(a){a.style.display=""}),f.expandImgs&&Hb(k),2===f.linksNavig&&Je(k,c.a),ib(k),f.markViewed)k.tc=setTimeout(function(a,b){if(!a.ab){g.r(a,"de-viewed");a.ab=i}var c=(sessionStorage["de-viewed"]||"").split(",");c.push(b);sessionStorage["de-viewed"]=c},2E3,a,b)}else k||(Ob[b]=i),k=E('<div class="'+
d.u+' de-pview-info de-pview">'+(k||Zb[h])+"</div>");A.appendChild(k);Ie(e,k,m);k.onmouseover=function(){eb(this,m)};k.onmouseout=function(){eb(ua,i)};k.Bb=i;ua&&c.Bb?(Ib(c.X),k.parent=c,c.X=k):(Ib(ua),ua=k);f.animation&&(g.U(k,function(a){g.T(a,"de-pview-anim");a.style[g.ea]=""}),g.r(k,"de-pview-anim"),k.style[g.ea]="de-post-open-"+(k.kb?"t":"b")+(k.jb?"l":"r"));return k}function Ke(a,b,c){if(!va[a])return l;var e=va[a][b];if(a===C||!e||e.Sb)return e;b=vb(a)+d.ka+c+(d.Za?".html":xb);a=e.getElementsByTagName("a");
for(c=a.length-1;0<=c;c--)/^>>\d+$/.test(a[c].textContent)&&(a[c].href=b);e.Sb=i;return e}function Hf(a){var b=a.pathname.match(d.sc)[1],c=(a.pathname.match(/[^\/]+\/[^\d]*(\d+)/)||[,0])[1],e=(a.textContent.match(/\d+$/)||[c])[0],k=I[e]||Ke(b,e,c),z=ca(a),o=z.Bb?z.X:ua;if(!f.noNavigHidd||!k||!k.h)Ob[e]?Jb(l,e,z,a,Zb[h]):o&&o.a===e?(eb(o,m),Ib(o.X),Ie(a,o,i),Je(o,z.a)):k?Jb(k,e,z,a,l):(o=Jb(l,e,z,a,'<span class="de-wait">'+wa[h]+"</span>"),va[b]=[],ra(l,b,c,i,function(k,f,g){if(!g){var h=0,j=k.length;
f.k=i;f.l=f.querySelector(d.A);for(va[b][c]=f;h<j;h++)f=k[h],f.l=f.querySelector(d.A),va[b][d.fa(f)]=f;wc(va[b]);o&&o.parentNode&&Jb(Ke(b,e,c),e,z,a,g)}b=e=c=z=o=l}))}function If(){2<this.textContent.length&&(this.lc=setTimeout(Hf,f.linksOver,this))}function Jf(){clearTimeout(this.lc);eb(ua,i)}function ib(a){if(f.linksNavig)for(var b=n.evaluate('.//a[starts-with(text(),">>")]',a,l,4,l);a=b.iterateNext();)a.onmouseover=If,a.onmouseout=Jf}function ra(a,b,c,e,k){GM_xmlhttpRequest({method:"GET",url:g.Qa(a||
vb(b)+d.ka+c+(d.Za?".html":xb)),onreadystatechange:function(a){if(4===a.readyState){if(200===a.status){var b=g.Kb(a.responseText);!j.O&&ba&&(j=Le(n.importNode(b.querySelector(d.Eb),i)),$(ba,j.form));e?Me(b.querySelector(d.ia),b,function(a){k(d.Sa(a),d.tb(a,b),l)}):k(l,b,l)}else k(l,l,0===a.status?na[h]:"HTTP ["+a.status+"] "+a.statusText);k=e=b=l}}})}function Ne(a,b){GM_xmlhttpRequest({method:"GET",url:g.Qa(a),onreadystatechange:function(a){if(4===a.readyState)if(304===a.status)la(q("de-alert-newposts"));
else{try{b(a.status,a.statusText,JSON.parse(a.responseText))}catch(e){b(1,e.toString(),l)}b=l}}})}function Kb(a){return yc(n.importNode(a,i))}function Oe(a){f.expandImgs&&Hb(a);a.h||Pe(a);var b,c,e=[];c=a.l.getElementsByTagName("a");for(var d=c.length-1;0<=d;d--)(b=c[d].textContent.match(/^>>(\d+)$/))&&-1===e.indexOf(b=b[1])&&e.push(b);b=a.a;for(d=e.length-1;0<=d;d--)if(c=I[e[d]])c.v?-1===c.v.indexOf(b)&&c.v.push(b):c.v=[b],v(B("de-refmap",c)),He(c),ib(B("de-refmap",c)),f.hideRefPsts&&c.h&&zc(a,"reference to >>"+
e[d]);ib(a);Eb(a);Db(a);Fb(a);ab&&kc(a,l)}function Lb(a,b,c,e){var k;Ac(b,c,a,e);tc(b);f.expandPosts&&!r&&Bc(b);Oe(b);Gb(b);jb&&0!==e?(e=jb.cloneNode(i),(k=d.Sa(e)[0])?k.parentNode.replaceChild(b,k):e=b):e=b;a.appendChild(e);f.preLoadImgs&&window.postMessage("K"+c,"*");d.p&&a.appendChild(n.createElement("br"));return+!b.h}function Qe(a){d.Va&&(a.innerHTML=Cc(a.innerHTML),a.H=La(a));D(a.querySelectorAll(".de-ytube-obj"),v);Oe(a)}function Re(a,b){function c(b,c){if(e.a===c){v(a);var f=e.l.querySelector(".de-ytube-ext");
e.l.parentNode.replaceChild(n.importNode(b.querySelector(d.A),i),e.l);e.l=e.querySelector(d.A);f&&e.l.appendChild(f);Qe(e);a=e=l;throw l;}}var e=ca(a);d.i?(v(a.nextSibling),v(a.previousSibling),v(a),e.l.replaceChild(e.querySelector(".alternate > div"),e.l.firstElementChild),b&&Qe(e)):ra(l,C,e.K.a,i,function(b,f,o){if(!o)try{c(f,d.sa(f)),D(b,function(a){c(a,d.fa(a))})}catch(u){}a=e=l})}function Bc(a){if(!a.h&&(a=a.querySelector(d.f?'p[id^="post_truncated"]':d.i?".abbrev > span":".abbrev, .abbr, .omittedposts, .shortened"))&&
/long|full comment|gek\u00fcrzt|слишком|длинн|мног|полная версия/i.test(a.textContent))1===f.expandPosts?Re(a,m):R("a",a).onclick=function(a){w(a);Re(this,i)}}function fb(a,b,c){c||L(wa[h],"load-thr",i);ra(l,C,a.a,i,function(e,k,f){var o,u,p=a.K,j=e.length;if(f)L(f,"load-thr",m);else{Ha();v(q("de-select"));u=p.Ac||p.P-Wd(p)+1;p.innerHTML="";(f=Kb(k)).k=i;Lb(p,
f,d.sa(k),0);f.ma=(B(d.lb,f)||{}).textContent||xa(f).substring(0,70).replace(/\s+/g," ");ga[ga.indexOf(a)]=f;g.ga(f.G,'<span>&nbsp;[<a href="'+pa(d.host,C,f.a)+'">'+zd[h]+"</a>]</span>");1===b||b>=j?k=0:(k=j-b,p.Ac=b+1,p.appendChild(s("div",{"class":"de-omitted",text:Ad[h]+k},l)));for(o=[f];k<j;k++)Lb(p,f=Kb(e[k]),d.fa(e[k]),k+1),o.push(f);if(5<b||1===b)p.appendChild(E('<span>[<a href="#">'+Bd[h]+"</a>]</span>")).onclick=function(b){w(b);fb(a,5,l);a=l};Ca.splice.apply(x,[x.indexOf(a),u].concat(o));
p.P=j+1;la(q("de-alert-load-thr"))}bc(a);c&&c();b=c=l})}function sf(){var a=this.parentNode.parentNode,b=R("iframe",a),c=a.getAttribute("info").split(";")[2],e=B("de-content",n);v(q("de-fav-wait"));b?(v(b),e.style.overflowY="auto"):(c=I[c])&&!c.h?bc(c):(v(q("de-iframe-fav")),B("de-content",n).style.overflowY="scroll",fa(a,[E('<iframe name="de-iframe-fav" id="de-iframe-fav" src="'+R("a",a).href+'" scrolling="no" style="border: none; width: '+(n.body.clientWidth-55)+'px; height: 1px;" />'),E('<div id="de-fav-wait" class="de-wait" style="font-size: 1.1em; text-align: center">'+
wa[h]+"</div>")]))}function ne(a,b,c){ra(wb(d.host,C,b),l,l,m,function(e,k){for(var f,e=n.importNode(k.querySelector(d.ia),i);f=e.firstChild;)a.appendChild(f);c(yc(a),b);c=a=b=l})}function pe(a){L(wa[h],"load-pages",i);f.preLoadImgs&&D(A.querySelectorAll('a[href^="blob:"]'),function(a){window.URL.revokeObjectURL(a.href)});var b=-1,c=A,e=Array(a),d=1;A.innerHTML="";x=[];for(va={};++b<a;)1<a&&(c=s("div",{id:"de-page"+b},l),fa(A,[s("center",{text:b+" "+Xb[h],style:"font-size: 2em;"},l),n.createElement("hr"),
c])),ne(c,b,function(b,c){e[c]=b;if(d===a){e.forEach(function(a){Se(a);Te(a)});x.forEach(tc);x.forEach(Hb);x.forEach(Bc);Eb(l);Db(l);Fb(A);Gb(A);wc(I);ib(A);Zd();Ue();ab&&x.forEach(function(a){kc(a,l)});la(q("de-alert-load-pages"));window.postMessage("Kall","*");d=e=l}else d++})}function Dc(a){r&&3!==f.updThread&&(n.querySelector('a[id^="de-btn-upd"]').id="de-btn-upd-"+a)}function fe(){Dc("off");clearInterval(bb);bb=ta}function he(){Wa||(Wa=s("audio",{preload:"auto",src:"https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/master/signal.ogg"},
l));Va=!Va}function Ve(){ma?lb=m:(Wa.play(),setTimeout(Ve,Ua),lb=i)}function Kf(a){if(0===window.webkitNotifications.checkPermission()){var b=window.webkitNotifications.createNotification("/favicon.ico",Ta,Cd[h].replace(/%m/g,a));b.ondisplay=function(){setTimeout(function(){b.cancel();b=l},8E3)};b.onclick=function(){window.focus&&window.focus();this.cancel()};b.show()}}function sa(a,b){if(a)a!==na[h]?(L(Dd[h]+r+"): \n"+a,"newposts",m),n.title="{"+a.match(/(?:\[)(\d+)(?:\])/)[1]+"} "+n.title,fe()):
(L(na[h],"newposts",m),Dc("warn"));else if(la(q("de-alert-newposts")),3!==f.updThread){Dc("on");if(1===f.updThread){if(ma)return;b+=+(n.title.match(/^\[(\d+)\]/)||[,0])[1]}f.favIcoBlink&&Aa&&(clearInterval(mb),0<b&&(mb=setInterval(function(){var a=ia('.//link[@href="'+Aa+'"]',n.head)?"data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII=":Aa;D(n.head.querySelectorAll('link[rel="shortcut icon"]'),
v);n.head.appendChild(s("link",{href:a,rel:"shortcut icon"},l))},800)));n.title=(0<b?" ["+b+"] ":"")+Ta;g.m&&f.desktNotif&&0<b&&Kf(b);Va&&!lb&&0<b&&(Ua?Ve():Wa.play())}}function Lf(){S(n.querySelector('input[type="button"]'),{click:function(){n.cookie=escape("de-rating")+"="+escape(q("rating").value)+";expires="+(new Date(Date.now()+1E12)).toGMTString()+";path=/"}})}function Mf(a,b){var c,e=a.src,d=a.thumb,f=a.thumb_width,o=a.thumb_height,u=a.size,p=a.rating;a:{for(var g=n.cookie.split("; "),h=g.length;h--;)if(c=
g[h].split("="),c[0]===escape("de-rating")){c=unescape(c[1]);break a}c=m}g=c||"r-15";"b"===C||"rf"===C?c=d.substring(d.lastIndexOf("/")+1):(c=e.substring(e.lastIndexOf("/")+1),17<c.length&&(c=c.substring(0,17)+"..."));d="r-18g"===p&&"r-18g"!==g?"images/r-18g.png":"r-18"===p&&("r-18g"!==g||"r-18"!==g)?"images/r-18.png":"r-15"===p&&"sfw"===g?"images/r-15.png":"illegal"===p?"images/illegal.png":a.thumb;d!==a.thumb&&(o=f=200);return E('<div class="file"><div class="fileinfo">Файл: <a href="/'+
e+'" target="_blank">'+c+"</a><br /><em>"+a.thumb.substring(a.thumb.lastIndexOf(".")+1)+", "+(1024>u?u+" B":1048576>u?(u/1024).toFixed(2)+" KB":1073741824>u?(u/1048576).toFixed(2)+" MB":(u/1073741824).toFixed(2)+" GB")+", "+a.metadata.width+"x"+a.metadata.height+'</em><br /><a class="edit_ icon" href="/utils/image/edit/'+a.file_id+"/"+b+'"><img title="edit" alt="edit" src="/images/blank.png" /></a></div><a href="/'+e+'" target="_blank"><img class="thumb" src="/'+d+'" width="'+f+'" height="'+o+'" /></a></div>')}
function We(a,b){if(d.Ua&&!a.gc){var c=b.querySelector(d.Ua);c&&(a.querySelector(d.Ua)||a.l.appendChild(n.importNode(c,i)),a.gc=i)}}function Xe(a){if(!a.Zb){var b=sessionStorage["de-deleted"];sessionStorage["de-deleted"]=(b?b+",":"")+a.count;a.Zb=i;g.T(a.G,"de-ppanel-cnt");g.r(a.G,"de-ppanel-del")}}function Cb(a,b){a&&L(wa[h],"newposts",i);d.i?Ne("//dobrochan.ru/api/thread/"+C+"/"+r+"/new.json?message_html&new_format&last_post="+x[x.length-1].a,function(a,e,k){if(200!==a||k.error)sa(0===a?na[h]:e||
k.message,l);else{var f,a=0,o=(k.result||{}).posts,u=B("de-thread",A);if(o&&0<o.length){k=0;for(e=o.length;k<e;k++){f=o[k];var p=ta,p=f.display_id,g=f.files,j=g.length,n=s("td",{id:"reply"+p,"class":"reply","de-post":p},l);n.innerHTML='<a name="i'+p+'"></a><label><a class="delete icon"><input type="checkbox" id="delbox_'+p+'" class="delete_checkbox" value="'+f.post_id+'" id="'+p+'" /></a><span class="postername">'+f.name+"</span> "+d.dc.sb(f.date)+' </label><span class="reflink"><a onclick="Highlight(0, '+
p+')" href="/'+C+"/res/"+r+".xhtml#i"+p+'">No.'+p+"</a></span><br />";for(p=0;p<j;p++)n.appendChild(Mf(g[p],f.post_id));fa(n,[G(1<j,s("div",{style:"clear: both;"},l)),E('<div class="postbody">'+f.message_html+"</div>"),s("div",{"class":"abbrev"},l)]);f=yc(n);a+=Lb(u,f,o[k].display_id,u.P+k);x.push(f)}u.P+=o.length}sa(l,a)}b&&b();b=l}):ra(l,C,r,i,function(a,e,k){if(k)sa(k,l);else{var f,o,u,p,g=0,h=x.length,j=a.length,n=B("de-thread",A);We(x[0],e);e=1;for(f=0;e<h||f<j;e++,f++)o=x[e],(u=a[f])?(p=d.fa(u),
o?o.a!==p?(Xe(o),f--):We(o,u):(g+=Lb(n,o=Kb(u),p,e),x.push(o))):Xe(o);sa(k,g);n.P=h;Na();q("de-panel-info").firstChild.textContent=e+"/"+La(A).length}b&&b();b=l})}function ge(){1===f.updThread?bb=setInterval(function(){Cb(m,l)},1E3*f.updThrDelay):2===f.updThread&&(bb=setInterval(function(){d.i?Ne("//dobrochan.ru/api/thread/"+C+"/"+r+".json?new_format",function(a,b,c){200!==a||c.error?sa(0===a?na[h]:b||c.message,l):sa(l,c.result.posts_count-x.length)}):ra(l,C,r,i,function(a,b,c){sa(c,a.length-x.length+
1)})},1E3*f.updThrDelay))}function Ye(a){f.hideRefPsts&&a.v&&(a.v.forEach(function(b){var c=I[b];c&&!Q[b]&&Ec(c,"reference to >>"+a.a)}),a=l)}function Fc(a){f.hideRefPsts&&a.v&&a.v.forEach(function(a){var c=I[a];c&&!Q[a]&&(0!==Z[c.count]&&kb(c,m,l),Fc(c))})}function Pe(a){!f.filterThrds&&a.k?Z[a.count]=1:(Z[a.count]=1,F.W(a,zc,m))}function Ue(){for(var a,b,c,e=x.length-1;0<=e;e--)if(c=Z[e],a=x[e],Q[b=a.a]){if(a.k&&(Q[b][0]="undefined"===typeof Fa[b]?1:0),0===Q[b][0]?Qa(a,i):(Q[b][1]=Date.now(),a.G.firstChild.className=
"de-btn-lock"),"undefined"===typeof c)Z[e]=1,F.W(a,function(a){Z[a.count]=0},m)}else a.k&&("undefined"!==typeof Fa[b]?Z[e]=c="0":"0"===c&&(c=l)),"0"===c?Ec(a,l):"1"!==c&&Pe(a)}function db(a,b){b?g.r(a,"de-post-hid"):g.T(a,"de-post-hid")}function Gc(a,b){b&&a.G.appendChild(s("a",{"class":"de-post-note de-abtn",text:" autohide: "+b+" ",href:"#"},{click:function(a){w(a);v(this)}}))}function kb(a,b,c){var e,k,g=a.K;db(a,a.h=b);if(a.k){if(g.style.display=b?"none":"",g.h=b,e=q("de-thr-hid-"+(k=a.a)),!b&&
e&&(v(e),ae(a,1)),b&&!e)e=E('<div class="'+d.u+' de-thr-hid" id="de-thr-hid-'+k+'">'+Ed[h]+' <a href="#">№'+k+"</a><i> ("+(c?"autohide: "+c:a.ma.replace(/</g,"&lt;").replace(/>/g,"&gt;"))+")</i></div>"),R("a",e).onclick=function(b){w(b);Qa(a,!a.h);Oa()},$(g,e),ae(a,0)}else f.delHiddPost?d.ta(a).style.display=b?"none":"":((e=B("de-post-note",a))?b?c&&(e.innerText=" autohide: "+c+" "):v(e):b&&Gc(a,c),e=a.querySelector(d.Fb),e.onmouseover=b&&function(){db(ca(this),m)},e.onmouseout=b&&function(){db(ca(this),
i)}),f.strikeHidd&&setTimeout(D,0,A.querySelectorAll('a[href*="#'+a.a+'"]'),b?function(a){a.className="de-ref-hid"}:function(a){a.className=l})}function Ec(a,b){kb(a,i,b);Ye(a)}function zc(a,b){Q[a.a]||(a.h?(v(B("de-post-note",a)),Gc(a,b)):(Z[a.count]=0,Ec(a,b)))}function Ze(a){Q[a.a]||(Z[a.count]=1,kb(a,m,l),Fc(a),v(B("de-post-note",a)))}function Qa(a,b){var c=a.a;kb(a,b,l);a.G.firstChild.className="de-btn-lock";b?Ye(a):Fc(a);Q[c]||(Q[c]=Array(2));Q[c][0]=+!b;Q[c][1]=Date.now()}function $e(a){return a.replace(/\s+/g,
" ").replace(/[^a-zа-яё ]/ig,"").substring(0,800).split(" ")}function uf(a){var b,c,e,d=xa(a);d?(b=$e(d),e=a.a,c=a.h,x.forEach(function(a){var d=e,k=c,f=b,g,h=$e(xa(a)),j=h.length,n=f.length,q=n,s=n,r=0;if(!(j<0.4*q||j>3*q)){for(;n--;)if(6<q&&3>f[n].length)s--;else for(g=j;g--;)(h[g]===f[n]||f[n].match(/>>\d+/)&&h[g].match(/>>\d+/))&&r++;r<0.4*s||j>3*s||(v(B("de-post-note",a)),k?(0!==Z[a.count]&&kb(a,m,l),Q[n=a.a]&&delete Q[n]):(Qa(a,i),Gc(a,"similar to >>"+d)))}}),Oa()):Ga("!#tlen",
"");c=e=b=l}function oe(a){var b,c,e=a.H[0];if(e.hash)return e.hash;c=q("de-canvas")||n.body.appendChild(s("canvas",{id:"de-canvas",style:"display: none;"},l));a=c.width=e.width;b=c.height=e.height;c=c.getContext("2d");c.drawImage(e,0,0);c=c.getImageData(0,0,a||1,b||1).data;var d,f,o,g,p,h;p=a*b;var j=256/3,r=0;for(f=d=0;d<p;d++,f+=4)c[d]=0.3*c[f]+0.59*c[f+1]+0.11*c[f+2];for(d=0;8>d;d++)for(f=0;8>f;f++){p=d/7*(b-1);o=Math.min(p|0,b-2);h=p-o;p=f/7*(a-1);g=Math.min(p|0,a-2);p-=g;r=(r<<4)+Math.min(128*
((c[o*a+g]*(1-p)*(1-h)+c[o*a+g+1]*p*(1-h)+c[(o+1)*a+g+1]*p*h+c[(o+1)*a+g]*(1-p)*h)/j|0),255);if(o=r&4026531840)r^=o>>>24;r&=~o}return e.hash=r}function M(a){a?this.update():this.Fa()}function af(a){(f.filterThrds||!a.k)&&F.W(a,zc,a.h&&Ze)}function Hc(){la(q("de-alert-help-err-spell"));F.wb&&x.forEach(function(a){F.W(a,Ze,l)})}function mc(){var a=q("de-spell-edit"),b=a.value;if(b){if(F.ha(b)){Hc();F.Xa();a.value=F.list;f.hideBySpell?x.forEach(af):F.disable();Na();return}}else Hc(),Na();F.Wa("");n.querySelector('input[info="hideBySpell"]').checked=
m}function Ga(a,b){var c,e=q("de-spell-edit"),d=e&&e.value;d||(F.Hb||F.Gb(),d=F.list);if(c=F.ha(d))if(a=a+(r?"["+C+","+r+"]":"")+b,d=c[0].split(RegExp("(?:^|\\n)"+RegExp.quote(a)+"(?: \\|\\n|$)","g")),c=1===d.length?F.ha(a+(d[0]?" |\n"+d[0]:"")+"\n\n"+c[1]):F.ha(d.join("")+"\n\n"+c[1])){Hc();F.Xa();e&&(e.previousSibling.firstChild.checked=!!(e.value=F.list));F.list&&(P("hideBySpell",1),x.forEach(af));return}F.disable();e&&(e.previousSibling.firstChild.checked=m);P("hideBySpell",0)}function de(){return!f.scriptStyle?
"fr":1===f.scriptStyle?"en":"de"}function le(){function a(a,b){e+=a+':before { content: ""; padding: 0 16px 0 0; margin: 0 4px; background: url('+b+") no-repeat center; }"}function b(a,b){e+=a+" { background: url(data:image/gif;base64,"+b+") no-repeat center !important; }"}J(A);var c,e="",e=e+('#de-content-cfg > div { float: left; border-radius: 10px 10px 0 0; width: auto; min-width: 0; padding: 0; margin: 5px 20px; overflow: hidden; }\t\t#de-cfg-info > span { display: inline-block; vertical-align: top; }\t\t#de-cfg-head { padding: 4px; border-radius: 10px 10px 0 0; color: #fff; text-align: center; font: bold 14px arial; cursor: default; }\t\t#de-cfg-head:lang(en), #de-panel:lang(en) { background: linear-gradient(to bottom, #4b90df, #3d77be 5px, #376cb0 7px, #295591 13px, rgba(0,0,0,0) 13px), linear-gradient(to bottom, rgba(0,0,0,0) 12px, #183d77 13px, #1f4485 18px, #264c90 20px, #325f9e 25px); }\t\t#de-cfg-head:lang(de), #de-panel:lang(de) { background: #777; }\t\t#de-cfg-head:lang(fr), #de-panel:lang(fr) { background: linear-gradient(to bottom, #7b849b, #616b86 2px, #3a414f 13px, rgba(0,0,0,0) 13px), linear-gradient(to bottom, rgba(0,0,0,0) 12px, #121212 13px, #1f2740 25px); }\t\t.de-cfg-body { width: 372px; min-height: 348px; padding: 11px 7px 7px; margin-top: -1px; font: 13px sans-serif; }\t\t.de-cfg-body input[type="text"] { width: auto; padding: 0px; }\t\t.de-cfg-body input[value=">"] { width: 20px; }\t\t.de-blockinp { display: block; }\t\t.de-cfg-body, #de-cfg-btns { border: 1px solid #183d77; border-top: none; }\t\t.de-cfg-body:lang(de), #de-cfg-btns:lang(de) { border-color: #444; }\t\t#de-cfg-btns { padding: 7px 2px 2px; }\t\t#de-cfg-bar { height: 25px; width: 100%; display: table; background-color: #1f2740; margin: 0; padding: 0; }\t\t#de-cfg-bar:lang(en) { background-color: #325f9e; }\t\t#de-cfg-bar:lang(de) { background-color: #777; }\t\t.de-cfg-tab { padding: 4px 6px; border-radius: 4px 4px 0 0; font: bold 14px arial; text-align: center; cursor: default; }\t\t.de-cfg-tab-back { display: table-cell !important; float: none !important; min-width: 0; padding: 0 !important; box-shadow: none !important; border: 1px solid #183d77 !important; border-radius: 4px 4px 0 0; opacity: 1; }\t\t.de-cfg-tab-back:lang(de) { border-color: #444 !important; }\t\t.de-cfg-tab-back:lang(fr) { border-color: #121421 !important; }\t\t.de-cfg-tab-back[selected="true"] { border-bottom: none !important; }\t\t.de-cfg-tab-back[selected="false"] > .de-cfg-tab { background-color: rgba(0,0,0,.2); }\t\t.de-cfg-tab-back[selected="false"] > .de-cfg-tab:lang(en), .de-cfg-tab-back[selected="false"] > .de-cfg-tab:lang(fr) { background: linear-gradient(to bottom, rgba(132,132,132,.35) 0%, rgba(79,79,79,.35) 50%, rgba(40,40,40,.35) 50%, rgba(80,80,80,.35) 100%) !important; }\t\t.de-cfg-tab-back[selected="false"] > .de-cfg-tab:hover { background-color: rgba(99,99,99,.2); }\t\t.de-cfg-tab-back[selected="false"] > .de-cfg-tab:hover:lang(en), .de-cfg-tab-back[selected="false"] > .de-cfg-tab:hover:lang(fr)  { background: linear-gradient(to top, rgba(132,132,132,.35) 0%, rgba(79,79,79,.35) 50%, rgba(40,40,40,.35) 50%, rgba(80,80,80,.35) 100%) !important; }\t\t.de-cfg-tab::'+
(g.d?"-moz-":"")+"selection { background: transparent; }\t\t#de-spell-panel { float: right; }\t\t#de-spell-panel > a { padding: 0 7px; text-align: center; }\t\t#de-cfg-wipe { display: table; padding-left: 25px; }\t\t#de-cfg-wipe > div { display: table-row; }\t\t#de-cfg-wipe > div > label { display: table-cell; }\t\t.de-cfg-unvis { display: none; }"),e=e+"#de-btn-logo { margin-right: 3px; cursor: pointer; }\t\t#de-panel { height: 25px; z-index: 9999; border-radius: 15px 0 0 0; cursor: default;}\t\t#de-panel-btns { display: inline-block; padding: 0 2px; margin: 0; height: 25px; border-left: 1px solid #8fbbed; }\t\t#de-panel-btns:lang(de), #de-panel-info:lang(de) { border-color: #ccc; }\t\t#de-panel-btns:lang(fr), #de-panel-info:lang(fr) { border-color: #616b86; }\t\t#de-panel-btns > li { margin: 0 1px; padding: 0; }\t\t#de-panel-btns > li, #de-panel-btns > li > a, #de-btn-logo { display: inline-block; width: 25px; height: 25px; }\t\t#de-panel-btns:lang(en) > li, #de-panel-btns:lang(fr) > li  { transition: all 0.3s ease; }\t\t#de-panel-btns:lang(en) > li:hover, #de-panel-btns:lang(fr) > li:hover { background-color: rgba(255,255,255,.15); box-shadow: 0 0 3px rgba(143,187,237,.5); }\t\t#de-panel-btns:lang(de) > li > a { border-radius: 5px; }\t\t#de-panel-btns:lang(de) > li > a:hover { width: 21px; height: 21px; border: 2px solid #444; }\t\t#de-panel-info { display: inline-block; vertical-align: top; padding: 0 6px; height: 25px; border-left: 1px solid #8fbbed; color: #fff; font: 18px serif; }";
c="R0lGODlhGQAZAIAAAPDw8P///yH5BAEAAAEALAAAAAAZABkAQA";b("#de-btn-logo",c+"I5jI+pywEPWoIIRomz3tN6K30ixZXM+HCgtjpk1rbmTNc0erHvLOt4vvj1KqnD8FQ0HIPCpbIJtB0KADs=");b("#de-btn-settings",c+"JAjI+pa+API0Mv1Ymz3hYuiQHHFYjcOZmlM3Jkw4aeAn7R/aL6zuu5VpH8aMJaKtZR2ZBEZnMJLM5kIqnP2csUAAA7");b("#de-btn-hidden",c+"I5jI+pa+CeHmRHgmCp3rxvO3WhMnomUqIXl2UmuLJSNJ/2jed4Tad96JLBbsEXLPbhFRc8lU8HTRQAADs=");b("#de-btn-favor",c+"IzjI+py+AMjZs02ovzobzb1wDaeIkkwp3dpLEoeMbynJmzG6fYysNh3+IFWbqPb3OkKRUFADs=");b("#de-btn-refresh",
c+"JAjI+pe+AfHmRGLkuz3rzN+1HS2JWbhWlpVIXJ+roxSpr2jedOBIu0rKjxhEFgawcCqJBFZlPJIA6d0ZH01MtRCgA7");b("#de-btn-goback",c+"IrjI+pmwAMm4u02gud3lzjD4biJgbd6VVPybbua61lGqIoY98ZPcvwD4QUAAA7");b("#de-btn-gonext",c+"IrjI+pywjQonuy2iuf3lzjD4Zis0Xd6YnQyLbua61tSqJnbXcqHVLwD0QUAAA7");b("#de-btn-goup",c+"IsjI+pm+DvmDRw2ouzrbq9DmKcBpVfN4ZpyLYuCbgmaK7iydpw1OqZf+O9LgUAOw==");b("#de-btn-godown",c+"ItjI+pu+DA4ps02osznrq9DnZceIxkYILUd7bue6WhrLInLdokHq96tnI5YJoCADs=");b("#de-btn-newthr",c+"IyjI+pG+APQYMsWsuy3rzeLy2g05XcGJqqgmJiS63yTHtgLaPTY8Np4uO9gj0YbqM7bgoAOw==");
b("#de-btn-expimg",c+"I9jI+pGwDn4GPL2Wep3rxXFEFel42mBE6kcYXqFqYnVc72jTPtS/KNr5OJOJMdq4diAXWvS065NNVwseehAAA7");b("#de-btn-maskimg",c+"JQjI+pGwD3TGxtJgezrKz7DzLYRlKj4qTqmoYuysbtgk02ZCG1Rkk53gvafq+i8QiSxTozIY7IcZJOl9PNBx1de1Sdldeslq7dJ9gsUq6QnwIAOw==");d.ya&&b("#de-btn-catalog",c+"I2jI+pa+DhAHyRNYpltbz7j1Rixo0aCaaJOZ2SxbIwKTMxqub6zuu32wP9WsHPcFMs0XDJ5qEAADs=");b("#de-btn-audio-off",c+"I7jI+pq+DO1psvQHOj3rxTik1dCIzmSZqfmGXIWlkiB6L2jedhPqOfCitVYolgKcUwyoQuSe3WwzV1kQIAOw==");b("#de-btn-audio-on",c+"JHjI+pq+AewJHs2WdoZLz7X11WRkEgNoHqimadOG7uAqOm+Y6atvb+D0TgfjHS6RIp8YQ1pbHRfA4n0eSTI7JqP8Wtahr0FAAAOw==");
c="Dw8P///wAAACH5BAEAAAIALAAAAAAZABkAQAJElI+pe2EBoxOTNYmr3bz7OwHiCDzQh6bq06QSCUhcZMCmNrfrzvf+XsF1MpjhCSainBg0AbKkFCJko6g0MSGyftwuowAAOw==";b("#de-btn-upd-on","R0lGODlhGQAZAJEAADL/Mv"+c);b("#de-btn-upd-off","R0lGODlhGQAZAJEAAP8yMv"+c);b("#de-btn-upd-warn","R0lGODlhGQAZAJEAAP/0Qf"+c);e+=".de-ppanel, .de-ppanel-op { margin-left: 4px; }\t\t.de-btn-hide, .de-btn-lock, .de-btn-rep, .de-btn-expthr, .de-btn-fav, .de-btn-fav-sel, .de-btn-sage, .de-btn-src { display: inline-block; margin: 0 4px -2px 0 !important; cursor: pointer; ";
f.postBtnsTxt?e+="color: "+getComputedStyle(R("a",n)).getPropertyValue("color")+'; font-size:14px; }\t\t\t.de-btn-hide:after { content: "\u00d7"; }\t\t\t.de-post-hid .de-btn-hide:after { content: "+"; }\t\t\t.de-btn-lock:after { content: "\u25a0"; }\t\t\t.de-btn-rep:after { content: "R"; }\t\t\t.de-btn-expthr:after { content: "E"; }\t\t\t.de-btn-fav:after { content: "F"; }\t\t\t.de-btn-fav-sel:after { content: "[F]"; }\t\t\t.de-btn-sage:after { content: "Sage!"; }\t\t\t.de-btn-src:after { content: "[Sauce]"; }':
(e+="padding: 0 14px 14px 0; }",c="R0lGODlhDgAOAKIAAPDw8KCgoICAgEtLS////wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAA4AQAM",b(".de-btn-hide",c+"8SLLcS2MNQGsUMYi6uB5BKI5hFgojel5YBbDDNcmvpJLkcgLq1jcuSgPmgkUmlJgFAyqNmoEBJEatxggJADs="),b(".de-post-hid .de-btn-hide",c+"5SLLcS2ONCcCMIoYdRBVcN4Qkp4ULmWVV20ZTM1SYBJbqvXmA3jk8IMzlgtVYFtkoNCENIJdolJAAADs="),b(".de-btn-lock",c+"zSLLcS2MNQGsUMQRRq9CYJo5iRp6Y1FHXcGFuzJjnuIjOBzYr0LS9FnAlrJEGkJhSSUgAADs="),b(".de-btn-rep",c+"4SLLcS2MNQGsUMQRRwdLbAI5kpn1kKHUWdk3AcDFmOqKcJ5AOq0srX0QWpBAlIo3MNoDInlAZIQEAOw=="),
b(".de-btn-expthr",c+"7SLLcS6MNACKLIQjKgcjCkI2DOAbYuHlnKFHWUl5dnKpfm2vd7iyUXywEk1gmnYrMlEEyUZCSdFoiJAAAOw=="),b(".de-btn-fav",c+"5SLLcS2MNQGsUl1XgRvhg+EWhQAllNG0WplLXqqIlDS7lWZvsJkm92Au2Aqg8gQFyhBxAlNCokpAAADs="),b(".de-btn-fav-sel","R0lGODlhDgAOAKIAAP/hAKCgoICAgEtLS////wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAA4AQAM5SLLcS2MNQGsUl1XgRvhg+EWhQAllNG0WplLXqqIlDS7lWZvsJkm92Au2Aqg8gQFyhBxAlNCokpAAADs="),b(".de-btn-sage","R0lGODlhDgAOAJEAAPDw8EtLS////wAAACH5BAEAAAIALAAAAAAOAA4AQAIZVI55duDvFIKy2vluoJfrD4Yi5lWRwmhCAQA7"),
b(".de-btn-src",c+"9SLLcS0MMQMesUoQg6PKbtFnDaI0a53VAml2ARcVSFC0WY6ecyy+hFajnWDVssyQtB5NhTs1mYAAhWa2EBAA7"));a(".de-src-google","//google.ru/favicon.ico");a(".de-src-tineye","//tineye.com/favicon.ico");a(".de-src-iqdb","//iqdb.org/favicon.ico");a(".de-src-saucenao","//saucenao.com/favicon.ico");r&&(e+='.de-thread { counter-reset: i 1; }\t\t.de-ppanel.de-ppanel-cnt:after { counter-increment: i 1; content: counter(i, decimal); vertical-align: 1px; color: #4f7942; font: italic bold 13px serif; cursor: default; }\t\t.de-ppanel-del:after { content: "'+
Fd[h]+'"; color: #727579; font: italic bold 13px serif; cursor: default; }');e+="#de-txt-panel { display: block; height: 23px; font-weight: bold; cursor: pointer; }\t\t#de-txt-panel > span:empty { display: inline-block; width: 27px; height: 23px }\t\t#de-txt-panel:lang(en) { display: none; }\t\t#de-txt-panel:lang(ru) { float: right; }";c="R0lGODlhFwAWAJEAAPDw8GRkZAAAAP///yH5BAEAAAMALAAAAAAXABYAQAJ";b("#de-btn-bold:empty",c+"T3IKpq4YAoZgR0KqqnfzipIUikFWc6ZHBwbQtG4zyonW2Vkb2iYOo8Ps8ZLOV69gYEkU5yQ7YUzqhzmgsOLXWnlRIc9PleX06rnbJ/KITDqTLUAAAOw==");
b("#de-btn-italic:empty",c+"K3IKpq4YAYxRCSmUhzTfx3z3c9iEHg6JnAJYYSFpvRlXcLNUg3srBmgr+RL0MzxILsYpGzyepfEIjR43t5kResUQmtdpKOIQpQwEAOw==");b("#de-btn-under:empty",c+"V3IKpq4YAoRARzAoV3hzoDnoJNlGSWSEHw7JrEHILiVp1NlZXtKe5XiptPrFh4NVKHh9FI5NX60WIJ6ATZoVeaVnf8xSU4r7NMRYcFk6pzYRD2TIUAAA7");b("#de-btn-strike:empty",c+"S3IKpq4YAoRBR0qqqnVeD7IUaKHIecjCqmgbiu3jcfCbAjOfTZ0fmVnu8YIHW6lgUDkOkCo7Z8+2AmCiVqHTSgi6pZlrN3nJQ8TISO4cdyJWhAAA7");b("#de-btn-spoil:empty","R0lGODlhFwAWAJEAAPDw8GRkZP///wAAACH5BAEAAAIALAAAAAAXABYAQAJBlIKpq4YAmHwxwYtzVrprXk0LhBziGZiBx44hur4kTIGsZ99fSk+mjrMAd7XerEg7xnpLIVM5JMaiFxc14WBiBQUAOw==");
b("#de-btn-code:empty",c+"O3IKpq4YAoZgR0KpqnFxokH2iFm7eGCEHw7JrgI6L2F1YotloKek6iIvJAq+WkfgQinjKVLBS45CePSXzt6RaTjHmNjpNNm9aq6p4XBgKADs=");b("#de-btn-quote:empty",c+"L3IKpq4YAYxRUSKguvRzkDkZfWFlicDCqmgYhuGjVO74zlnQlnL98uwqiHr5ODbDxHSE7Y490wxF90eUkepoysRxrMVaUJBzClaEAADs=");g.Ca&&(e+="@keyframes de-open {\t\t\t\t0% { transform: translateY(-1500px); }\t\t\t\t40% { transform: translateY(30px); }\t\t\t\t70% { transform: translateY(-10px); }\t\t\t\t100% { transform: translateY(0); }\t\t\t}\t\t\t@keyframes de-close {\t\t\t\t0% { transform: translateY(0); }\t\t\t\t20% { transform: translateY(20px); }\t\t\t\t100% { transform: translateY(-4000px); }\t\t\t}\t\t\t@keyframes de-blink {\t\t\t\t0%, 100% { transform: translateX(0); }\t\t\t\t10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }\t\t\t\t20%, 40%, 60%, 80% { transform: translateX(10px); }\t\t\t}\t\t\t@keyframes de-cfg-open { from { transform: translate(0,50%) scaleY(0); opacity: 0; } }\t\t\t@keyframes de-cfg-close { to { transform: translate(0,50%) scaleY(0); opacity: 0; } }\t\t\t@keyframes de-post-open-tl { from { transform: translate(-50%,-50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-open-bl { from { transform: translate(-50%,50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-open-tr { from { transform: translate(50%,-50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-open-br { from { transform: translate(50%,50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-close-tl { to { transform: translate(-50%,-50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-close-bl { to { transform: translate(-50%,50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-close-tr { to { transform: translate(50%,-50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-close-br { to { transform: translate(50%,50%) scale(0); opacity: 0; } }\t\t\t.de-pview-anim { animation-duration: .2s; animation-timing-function: ease-in-out; animation-fill-mode: both; }\t\t\t.de-open { animation: de-open .7s ease-out both; }\t\t\t.de-close { animation: de-close .7s ease-in both; }\t\t\t.de-blink { animation: de-blink .7s ease-in-out both; }\t\t\t.de-cfg-open { animation: de-cfg-open .2s ease-out backwards; }\t\t\t.de-cfg-close { animation: de-cfg-close .2s ease-in both; }");
a(".de-ytube-link","//youtube.com/favicon.ico");e+=".de-img-pre, .de-img-full { display: block; margin: "+(d.f?0:"2px 10px")+"; border: none; outline: none; cursor: pointer; }\t\t.de-img-full { float: left; }\t\t.de-img-center { position: fixed; z-index: 9999; border: 1px solid black; }\t\t.de-mp3, .de-ytube-obj { margin: 5px 20px; }\t\ttd > a + .de-ytube-obj { display: inline-block; }";a(".de-wait","data:image/gif;base64,R0lGODlhEAAQALMMAKqooJGOhp2bk7e1rZ2bkre1rJCPhqqon8PBudDOxXd1bISCef///wAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAAMACwAAAAAEAAQAAAET5DJyYyhmAZ7sxQEs1nMsmACGJKmSaVEOLXnK1PuBADepCiMg/DQ+/2GRI8RKOxJfpTCIJNIYArS6aRajWYZCASDa41Ow+Fx2YMWOyfpTAQAIfkEBQAADAAsAAAAABAAEAAABE6QyckEoZgKe7MEQMUxhoEd6FFdQWlOqTq15SlT9VQM3rQsjMKO5/n9hANixgjc9SQ/CgKRUSgw0ynFapVmGYkEg3v1gsPibg8tfk7CnggAIfkEBQAADAAsAAAAABAAEAAABE2QycnOoZjaA/IsRWV1goCBoMiUJTW8A0XMBPZmM4Ug3hQEjN2uZygahDyP0RBMEpmTRCKzWGCkUkq1SsFOFQrG1tr9gsPc3jnco4A9EQAh+QQFAAAMACwAAAAAEAAQAAAETpDJyUqhmFqbJ0LMIA7McWDfF5LmAVApOLUvLFMmlSTdJAiM3a73+wl5HYKSEET2lBSFIhMIYKRSimFriGIZiwWD2/WCw+Jt7xxeU9qZCAAh+QQFAAAMACwAAAAAEAAQAAAETZDJyRCimFqbZ0rVxgwF9n3hSJbeSQ2rCWIkpSjddBzMfee7nQ/XCfJ+OQYAQFksMgQBxumkEKLSCfVpMDCugqyW2w18xZmuwZycdDsRACH5BAUAAAwALAAAAAAQABAAAARNkMnJUqKYWpunUtXGIAj2feFIlt5JrWybkdSydNNQMLaND7pC79YBFnY+HENHMRgyhwPGaQhQotGm00oQMLBSLYPQ9QIASrLAq5x0OxEAIfkEBQAADAAsAAAAABAAEAAABE2QycmUopham+da1cYkCfZ94UiW3kmtbJuRlGF0E4Iwto3rut6tA9wFAjiJjkIgZAYDTLNJgUIpgqyAcTgwCuACJssAdL3gpLmbpLAzEQA7");
e+=".de-abtn { text-decoration: none !important; outline: none; }\t\t#de-alert { position: fixed; right: 0; top: 0; z-index: 9999; font: 14px arial; cursor: default; }\t\t#de-alert > div { float: right; clear: both; width: auto; min-width: 0pt; padding: 10px; margin: 1px; border: 1px solid grey; white-space: pre-wrap; }\t\t.de-alert-btn { display: inline-block; vertical-align: top; font-size: 150%; color: green; cursor: pointer; }\t\t.de-alert-msg { display: inline-block; margin-top: .25em; }\t\t.de-content { text-align: left; }\t\t.de-content textarea { display: block; margin: 2px 0; font: 12px courier new; "+
(g.e?"":"resize: none !important; ")+'}\t\t.de-content-block > a { color: inherit; font-weight: bold; }\t\t#de-content-fav, #de-content-hid { font-size: 16px; padding: 10px; border: 1px solid gray; }\t\t.de-entry { margin: 2px 0; }\t\t.de-entry > :first-child { float: none !important; }\t\t.de-entry > div > a { text-decoration: none; }\t\t.de-fav-inf-posts, .de-fav-inf-page { float: right; margin-right: 5px; font: bold 16px serif; }\t\t.de-fav-inf-old { color: #4f7942; }\t\t.de-fav-inf-new { color: blue; }\t\t.de-fav-title { margin-right: 15px; }\t\t.de-omitted { color: grey; font-style: italic; }\t\t.de-post-note { color: inherit; font: italic bold 12px serif; }\t\t.de-ref-hid { text-decoration: line-through !important; }\t\t.de-refmap { margin: 10px 4px 4px 4px; font-size: 70%; font-style: italic; }\t\t.de-refmap:before { content: "'+
Gd[h]+' "; }\t\t.de-refmap > a { text-decoration: none; }\t\t#de-sagebtn { margin-right: 7px; cursor: pointer; }\t\t#de-select { padding: 0 !important; margin: 0 !important; width: auto; min-width: 0; z-index: 9999; border: 1px solid grey;}\t\t#de-select a { display: block; padding: 3px 10px; color: inherit; text-decoration: none; font: 13px arial; white-space: nowrap; }\t\t#de-select a:hover { background-color: #222; color: #fff; }\t\t.de-selected { '+(g.e?"border-left: 4px solid red; border-right: 4px solid red; }":
"box-shadow: 6px 0 2px -2px red, -6px 0 2px -2px red; }")+'\t\t#de-txt-resizer { display: inline-block !important; float: none !important; padding: 5px; margin: 0 0 -6px -12px; border-bottom: 2px solid #555; border-right: 2px solid #444; cursor: se-resize; }\t\t.de-viewed { color: #888 !important; }\t\t.de-pview { position: absolute; width: auto; min-width: 0; z-index: 9999; border: 1px solid grey; margin: 0 !important; display: block !important; }\t\t.de-pview-info { padding: 3px 6px !important; }\t\t.de-pview-link { font-weight: bold; }\t\t.de-archive:after { content: ""; padding: 0 16px 3px 0; margin: 0 4px; background: url(data:image/gif;base64,R0lGODlhEAAQALMAAF82SsxdwQMEP6+zzRA872NmZQesBylPHYBBHP///wAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAAkALAAAAAAQABAAQARTMMlJaxqjiL2L51sGjCOCkGiBGWyLtC0KmPIoqUOg78i+ZwOCUOgpDIW3g3KJWC4t0ElBRqtdMr6AKRsA1qYy3JGgMR4xGpAAoRYkVDDWKx6NRgAAOw==) no-repeat center; }\t\t#de-iframe-pform, #de-iframe-dform, small[id^="rfmap"], div[id^="preview"], div[id^="pstprev"], body > hr, .theader, .postarea { display: none !important; }';
d.z?e+="#newposts_get, .extrabtns, .ui-resizable-handle, .replymode { display: none !important; }\t\t\t.ui-wrapper { display: inline-block; width: auto !important; height: auto !important; padding: 0 !important; }":d.N&&(e+='#de-pform > div, .mentioned, form > div[style="text-align: center;"], form > div[style="text-align: center;"] + hr { display: none !important; }');d.f?e+='.de-post-hid > div:not(.postheader), img[id^="translate_button"], img[src$="button-expand.gif"], img[src$="button-close.gif"], body > center > hr, h2, form > div:first-of-type > hr'+
(cb?', div[id^="disclaimer"]':"")+' { display: none !important; }\t\t\tdiv[id^="Wz"] { z-index: 10000 !important; }\t\t\t.de-thr-hid { margin-bottom: '+(!r?"7":"2")+"px; }\t\t\t.file_reply + .de-ytube-obj, .file_thread + .de-ytube-obj { margin: 5px 20px 5px 5px; float: left; }\t\t\t.de-ytube-obj + div { clear: left; }":d.b?e+=".de-spoiler { color: #000; background-color: #000; }\t\t\t.de-post-hid > .file, .de-post-hid > blockquote, #mpostform, .navLinks, .postingMode { display: none !important; }":
d.p?e+="form, form table { margin: 0; }\t\t\t.de-post-hid > .intro ~ *, .post-hover { display: none !important; }":d.n?e+=".de-post-hid > .replyheader ~ *, .opqrbtn, .qrbtn, .ignorebtn, .hidethread, noscript, #content > hr { display: none !important; }\t\t\t.de-thr-hid { margin: 1em 0; }":(e+=".de-post-hid > .de-ppanel ~ * { display: none !important; }",d.F?e+=".ABU_refmap, .postpanel, #CommentToolbar, #usrFlds + tbody > tr:first-child, #postform > div:nth-child(2), #BottomNormalReply, body > center { display: none !important; }\t\t\t\t#de-txt-panel { font-size: 16px !important; }\t\t\t\t.de-abtn { transition: none; }":
d.ya?e+='#postform nobr, .replieslist, #captcha_status, a[href="#top"], #posttypeindicator, .content-background > hr { display: none !important; }\t\t\t\t.ui-wrapper { position: static !important; margin: 0 !important; overflow: visible !important; }\t\t\t\t.ui-resizable { display: inline !important; }':d.i?e+="#hideinfotd, .reply_, .delete > img, .popup { display: none; }\t\t\t\t.delete { background: none; }\t\t\t\t.delete_checkbox { position: static !important; }\t\t\t\t.file + .de-ytube-obj { float: left; margin: 5px 20px 5px 5px; }\t\t\t\t.de-ytube-obj + div { clear: left; }":
d.ba?e+=".reply { background-color: "+getComputedStyle(n.body).getPropertyValue("background-color")+"; }":d.o?e+=".de-content, .de-cfg-body { font-family: arial; }\t\t\t\t.ftbl { width: auto; margin: 0; }\t\t\t\t.reply { background: #f0e0d6; }":d.w?e+=".de-ppanel, .de-ppanel-op { float: left; margin-top: 0.45em; }\t\t\t\ta + .threadlinktext { position: relative; top: 17px; }\t\t\t\t.postthreadlinks, .pagethreadlinks, .pwpostblock { display: none; }\t\t\t\t.de-btn-src { padding: 0px 10px 10px 0px !important; background-size: cover !important; }":
d.Ba?e+="br.clear { display: none !important; }":d.Cb&&(e+="#bodywrap3 > hr, .blotter { display: none !important; }"));cb&&(e+="body > :not("+(d.w?".threadz":"form")+") { display: none; }");16>g.d&&(e=e.replace(/(transition|keyframes|transform|animation|linear-gradient)/g,g.qb+"$1"),g.e||(e=e.replace(/\(to bottom/g,"(top").replace(/\(to top/g,"(bottom")));fa(n.head,[s("style",{id:"de-css",type:"text/css",text:e},l),s("style",{id:"de-css-dynamic",type:"text/css"},l)]);e=b=a=l;ja();J(A)}function ja(){var a;
a=f.attachPanel?".de-content { position: fixed; right: 0; bottom: 25px; z-index: 9999; max-height: 95%; overflow-x: visible; overflow-y: auto; }\t\t#de-panel { position: fixed; right: 0; bottom: 0; }":".de-content { clear: both; float: left; }\t\t#de-panel { float: right; clear: both; }";a=3===f.addPostForm?a+"#de-qarea { position: fixed; right: 0; bottom: 25px; z-index: 9990; padding: 3px; border: 1px solid gray; }\t\t\t#de-qarea-target { font-weight: bold; }\t\t\t#de-qarea-close { float: right; color: green; font: bold 20px arial; cursor: pointer; }":
a+"#de-qarea { float: none; clear: left; width: 100%; padding: 3px 0 3px 3px; margin: 2px 0; }";f.panelCounter||(a+="#de-panel-info { display: none; }");f.expandPanel||(a+="#de-panel-btns, #de-panel-info { display: none; }");f.maskImgs&&(a+='.de-img-pre, .de-ytube-obj, img[src*="spoiler"], img[src*="thumb"] { opacity: 0.07 !important; }\t\t\t.de-img-pre:hover, .de-ytube-obj:hover, img[src*="spoiler"]:hover, img[src*="thumb"]:hover { opacity: 1 !important; }');f.delHiddPost&&(a+=".de-thr-hid, .de-thr-hid + div + br, .de-thr-hid + div + br + hr { display: none; }");
f.noPostNames&&(a+=".commentpostername, .postername, .postertrip { display: none; }");f.noSpoilers&&(a+=".spoiler, .de-spoiler { background: #888 !important; color: #ccc !important; }");f.noPostScrl&&(a+="blockquote, blockquote > p, .code_part { max-height: 100% !important; overflow: visible !important; }");f.noBoardRule&&(a+=(d.o?".chui":".rules, #rules, #rules_row")+" { display: none; }");d.F&&f.addYouTube&&(a+='div[id^="post_video"] { display: none !important; }');q("de-css-dynamic").textContent=
a}function ke(a,b){var c=f.scrUpdIntrv;if(!a){switch(c){case 0:c=1728E5;break;case 1:c=3456E5;break;case 2:c=12096E5;break;case 3:c=24192E5;break;default:c=5184E6}if(Date.now()-+f.lastScrUpd<c)return}GM_xmlhttpRequest({method:"GET",url:"https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/master/Dollchan_Extension_Tools.meta.js",headers:{"Content-Type":"text/plain"},onreadystatechange:function(c){if(4===c.readyState)if(200===c.status){var c=c.responseText.match(/@version\s+([0-9.]+)/)[1].split("."),
d=f.version.split("."),g=d.length>c.length?d.length:c.length,o=0,u=m;if(c){for(P("lastScrUpd",Date.now());o<g;){if((+c[o]||0)>(+d[o]||0)){u=i;break}else if((+c[o]||0)<(+d[o]||0))break;o++}u?b('<a style="color: blue; font-weight: bold;" href="https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/master/Dollchan_Extension_Tools.user.js">'+Hd[h]+"</a>"):a&&b(Id[h])}else a&&b('<div style="color: red; font-weigth: bold;">'+na[h]+"</div>")}else a&&b('<div style="color: red; font-weigth: bold;">'+
na[h]+"</div>")}})}function Nf(){if(/^(?:about|chrome|opera|res)/i.test(window.location))return m;if(!window.localStorage||!("object"===typeof localStorage&&window.sessionStorage))return GM_log("WEBSTORAGE ERROR: please, enable webstorage!"),m;Of();switch(window.name){case "de-iframe-pform":case "de-iframe-dform":return ec(('window.top.postMessage("J'+window.name+"$#$"+xe(n)+"$#$"+ze(n,i)+'", "*");').replace(/\n|\r/g,"\\n")),m;case "de-iframe-fav":var a=setInterval(function(){v(q("de-fav-script"));
n.head.appendChild(s("script",{id:"de-fav-script",type:"text/javascript",text:'window.top.postMessage("I'+(n.body.offsetHeight+5)+'", "*");'},l))},1500);S(window,{load:function(){setTimeout(function(){clearInterval(a);a=l},3E4)}});cb=i;j={}}if(d.i&&"/settings"===window.location.pathname)return Lf(),m;if(!A||q("de-panel"))return m;Pf();return-1!==(Ea("DESU_Exclude")||"").indexOf(d.c)?m:i}function Pf(){var a=window.navigator.userAgent;g={d:+(a.match(/mozilla.*? rv:(\d+)/i)||[,0])[1],e:window.opera?
+window.opera.version():0,m:+(a.match(/WebKit\/([\d.]+)/i)||[,0])[1]};g.oa=g.m&&!/chrome/i.test(a);g.va=!!g.d&&"function"===typeof GM_setValue;g.wa=g.va||!!Ia;g.qb=g.m?"-webkit-":g.e?12.5>g.e?"-o-":"":16>g.d?"-moz-":"";if(!g.e||12<=g.e)g.Ca=i,g.ea=g.m?"webkitAnimationName":g.e?"OAnimationName":16>g.d?"MozAnimationName":"animationName",g.da=g.m?"webkitAnimationEnd":g.e&&12.5>g.e?"oAnimationEnd":"animationend",g.U=function(a,c){a.addEventListener(g.da,function k(){this.removeEventListener(g.da,k,m);
c(this);c=l},m)};g.Y=15>g.d&&536.1>g.m;g.ga=g.d&&8>g.d?function(a,c){N(a,E(c))}:function(a,c){a.insertAdjacentHTML("afterend",c)};g.zb=g.d&&8>g.d?function(a,c){$(a,E(c))}:function(a,c){a.insertAdjacentHTML("beforebegin",c)};g.forEach=g.m||g.d?function(a,c){Object.keys(a).forEach(c,a)}:function(a,c){for(var e in a)a.hasOwnProperty(e)&&c.call(a,e)};g.Qa=g.oa?function(a){return"/"===a[1]?"http:"+a:"/"===a[0]?"http://"+d.host+a:a}:function(a){return a};g.m&&(window.URL=window.webkitURL);g.r=g.e&&11.5>
g.e?function(a,c){a.className=a.className+(" "+c)}:function(a,c){a.classList.add(c)};g.T=g.e&&11.5>g.e?function(a,c){a.className=a.className.replace(RegExp("(?:^| )"+c,"g"),"")}:function(a,c){a.classList.remove(c)};g.Kb=12<=g.d?function(a){return(new DOMParser).parseFromString(a,"text/html")}:function(a){var c=n.implementation.createHTMLDocument("");c.documentElement.innerHTML=a;return c}}function Le(a){if(!a||d.F&&B("locked",a))return{};var b=d.ba?"li":"tr",c=".//"+b+'[not(contains(@style,"none"))]//input[not(@type="hidden") and ',
e=a.querySelector("#recaptcha_response_field");return{O:i,I:m,nc:!d.p||!!r,J:r,form:a,Q:"ancestor::"+b+"[1]",$:e,j:a.querySelector('input[name*="aptcha"]:not([name="recaptcha_challenge_field"])')||e,g:a.querySelector(b+':not([style*="none"]) textarea:not([style*="display:none"])'),la:a.querySelector(b+' input[type="submit"]'),file:a.querySelector(b+' input[type="file"]'),S:a.querySelector(b+' input[type="password"]'),ac:A.querySelector('input[type="password"]'),ua:U('.//tr[@id="trgetback"]|.//input[@type="radio" or @name="gotothread"]/ancestor::tr[1]',
a),name:U(c+'(@name="field1" or @name="name" or @name="internal_n" or @name="nya1" or @name="akane")]',a),M:U(c+(d.aa?'@name="sage"]':'(@name="field2" or @name="em" or @name="sage" or @name="email" or @name="nabiki" or @name="dont_bump")]'),a),na:a.querySelector(b+' input[name="video"], '+b+' input[name="embed"]')}}function Of(){var a=window.location.hostname.match(/(?:(?:[^.]+\.)(?=org\.|net\.|com\.))?[^.]+\.[^.]+$|^\d+\.\d+\.\d+\.\d+$|localhost/)[0];switch(a){case "4chan.org":d.b=i;break;case "krautchan.net":d.f=
i;break;case "2chan.net":d.o=i;break;case "britfa.gs":d.w=i;break;case "420chan.org":d.n=i;break;default:d.i=ia('.//script[contains(@src,"hanabira")]',n),d.p=ia('.//form[@name="postcontrols"]',n)}d.ia=d.w?".threadz":d.i||d.f?'form[action*="delete"]':d.p?'form[name="postcontrols"]':d.o?"form:nth-of-type(2)":'#delform, form[name="delform"]';d.sa=d.b||d.f||d.o||d.p?function(a){return a.querySelector('input[type="checkbox"]').name.match(/\d+/)[0]}:d.i||d.w?function(a){return a.querySelector("a[name]").name.match(/\d+/)[0]}:
d.n?function(a){return a.querySelector("a[id]").id.match(/\d+/)[0]}:function(a){return a.querySelector('input[type="checkbox"]').value};if(A=n.querySelector(d.ia)){d.z=ia('.//script[contains(@src,"kusaba")]',n);d.host=window.location.hostname;switch(d.c=a){case "2ch.so":d.xc=d.F=i;break;case "0-chan.ru":case "0chan.ru":d.ya=d.z=i;break;case "2--ch.ru":d.Za=i;break;case "410chan.ru":d.aa=i;break;case "hiddenchan.i2p":d.xb=i;break;case "dfwk.ru":d.rb=i;break;case "7chan.org":d.ba=i;break;case "ponychan.net":d.Cb=
i;break;case "mlpg.co":d.N=i;break;case "ernstchan.com":case "ernstchan.net":d.Pa=i;break;default:d.F=!!q("ABU_css"),d.Ba=ia('.//form[contains(@action,"imgboard.php?delete")]',n)}df();d.wc=d.i||d.Ba||d.Za||"02ch.net"===a;d.u=d.f?"postreply":d.p||d.b?"post reply":"reply";d.Wb=d.z?"postnode":d.b?"op":d.N?"opMain":"oppost";d.qc=d.f?".thread_body":d.n?'[id*="thread"]':!d.Pa&&n.querySelector(".thread")?".thread":n.querySelector('div[id*="_info"][style*="float"]')?'div[id^="t"]:not([style])':'[id^="thread"]'+
(d.ba?":not(#thread_controls)":"");d.Fb=d.b?".postInfo > :last-child":d.p?".intro > :last-child":d.f?".postnumber":d.o?".del":".reflink";d.A=d.i?".postbody":d.p?".body":d.ba?".message":"blockquote";d.V=d.b?"fileText":d.f||d.p||d.i||d.w?"fileinfo":"filesize";d.Db=d.w?".fileinfo":d.f?".filename > a":(d.o?"":"."+d.V)+' a[href$=".jpg"],'+(d.o?"":"."+d.V)+' a[href$=".png"],'+(d.o?"":"."+d.V)+' a[href$=".gif"]';d.Eb=d.o?"form:nth-of-type(1)":d.b||d.p?'form[name="post"]':"#postform";d.lb=d.f?"postsubject":
d.p||d.b?"subject":d.i?"replytitle":"filetitle";d.pc=d.o?'font[color="#707070"]':d.f?".omittedinfo":d.i?".abbrev":d.b?".summary.desktop":".omittedposts";d.Ua=d.f?".ban_mark":d.b?'strong[style="color: red;"]':m;d.oc=(d.b?".deleteform.desktop > ":"")+'input[type="submit"]';d.ka=d.f?"thread-":d.Pa?"faden/":"res/";d.sc=RegExp("^\\/?(.*?)\\/?(?:"+RegExp.quote(d.ka)+"|index|\\d+|$)");d.rc=RegExp(">https?:\\/\\/[^\\/]*"+d.c+"\\/([a-z0-9]+)\\/"+RegExp.quote(d.ka)+"(\\d+)(?:[^#<]+)?(?:#i?(\\d+))?<","g");d.ub=
d.i?function(a){a.previousElementSibling||(a=a.parentNode);return a.parentNode}:d.f?function(a){return a.parentNode}:ca;d.Sa=d.o?function(a){return a.querySelectorAll("td:nth-child(2)")}:d.p||d.b?function(a){return X("reply",a)}:function(a){return X(d.u,a)};d.tb=d.w?function(a,c){var e,d=V(c.createElement("div"),{style:"clear: left;"}),f=B("originalpost",a);for(N(B("postmenu",f),d);"TABLE"!==(e=a.firstChild).tagName;)N(d,e),d=e;d=c.createElement("div");for($(a.firstChild,d);e=f.firstChild;)d.appendChild(e);
v(R("table",a));return d}:function(a,c){var e,f,g;if(f=B(d.Wb,a))return f;f=c.createElement("div");for(g=a.querySelector(d.za+', div[id^="repl"]');(e=a.firstChild)!==g;)f.appendChild(e);a.childElementCount?$(a.firstChild,f):a.appendChild(f);return f};d.fa=d.o?function(a){return R("input",a).name}:function(a){return a.id.match(/\d+/)[0]};d.cc=d.b?function(a){return!!B("id_Heaven",a)}:d.f?function(a){return!!B("sage",a)}:d.aa?function(a){return ia('.//span[@class="filetitle" and contains(text(),"'+
unescape("%u21E9")+'")]',a)}:function(a){return(a=a.querySelector('a[href^="mailto:"], a[href="sage"]'))&&/sage/i.test(a.href)}}}function Ac(a,b,c,e){a.K=c;a.count=e;a.l=a.querySelector(d.A);a.H=La(a);a.Jb=d.cc(a);a.setAttribute("de-post",b);I[a.a=b]=a}function Me(a,b,c){var e,f,g=m,o=a.querySelectorAll(d.qc);D(a.getElementsByTagName("script"),v);if(2>x.length&&(d.za=d.b||d.N?".replyContainer":d.w?'div[id^="replies"] > table':!d.p&&(d.o||a.querySelector("td."+d.u))?"form > table, div > table":m,d.ta=
d.b||d.N?function(a){return a.parentNode}:d.za?function(a){return a.k?a:U("ancestor::table[1]",a)}:function(a){return a},d.za&&(jb=a.querySelector(d.za))&&b!==n))jb=n.importNode(jb,i);if(0===o.length)for(e=R("hr",a).parentNode.firstChild;;){for(o=b.createElement("div");e&&(f=e.nextSibling)&&"HR"!==f.tagName;)o.appendChild(e),e=f;g?N(g,o):$(a.firstChild,o);if(!e||!f)return;o.childElementCount&&c(o);g=f;e=f.nextSibling}D(o,c)}function Se(a){try{Me(a,n,function(a){if(d.n||d.p)N(a,a.lastChild),v(B("clear",
a));var b,f=d.tb(a,n),h=Ca.slice.call(d.Sa(a)),o=h.length;Ac(f,a.a=d.sa(f),a,0);f.k=i;f.ma=(B(d.lb,f)||{}).textContent||xa(f).substring(0,70);for(b=0;b<o;b++)Ac(h[b],d.fa(h[b]),a,b+1);x.push(f);ga.push(f);x=x.concat(h);g.r(a,"de-thread");a.P=o+Wd(a)})}catch(b){return GM_log("DELFORM ERROR:\n"+(g.m?b.stack:b.name+": "+b.message+"\n"+(g.d?b.stack.replace(/^([^@]*).*\/(.+)$/gm,function(a,b,d){return"    at "+(b?b+" ("+d+")":d)}):b.stack))),m}a.removeAttribute("id");return i}function Cc(a){Mb&&(a=Mb.fc(a).sb(a,
l));if(d.b||d.f)a=a.replace(/(^|>|\s|&gt;)(https*:\/\/.*?)(?=$|<|\s)/ig,'$1<a href="$2">$2</a>');d.b&&f.noSpoilers&&(a=a.replace(/"spoiler">/g,'"de-spoiler">'));F.Ta&&(a=F.replace(a));f.crossLinks&&(a=a.replace(d.rc,function(a,c,e,d){return">&gt;&gt;/"+c+"/"+(d||e)+"<"}));return a}function yc(a){d.Va&&(a.innerHTML=Cc(a.innerHTML));return a}function Qf(){J(n.body);g.zb(A,Cc(A.outerHTML||(new XMLSerializer).serializeToString(A)));A.style.display="none";A.id="de-dform-old";A=A.previousSibling;J(n.body);
S(window,{load:function(){v(q("de-dform-old"))}})}function Te(a){if(d.F){var b;if(r&&(a=B("de-thread",a).nextSibling)){for(;b=a.nextSibling;)v(a),a=b;g.ga(a,"<hr />")}}else if(d.w)for(var a=X("reflink",a),c=a.length-1;0<=c;c--)b=a[c].firstChild,b.onclick=l,b.href=pa(d.host,C,b.textContent),b.target="_blank"}function bf(){ma=i;f.favIcoBlink&&Aa&&(clearInterval(mb),D(n.head.querySelectorAll('link[rel="shortcut icon"]'),v),n.head.appendChild(s("link",{href:Aa,rel:"shortcut icon"},l)));1===f.updThread&&
setTimeout(function(){n.title=Ta},200)}function Rf(){j=Le(n.querySelector(d.Eb));ba=n.querySelector('form[name="oeform"], form[action*="paint"]');r?(f.rePageTitle?(Ta="/"+C+" - "+I[r].ma,n.title=Ta):Ta=n.title,10<g.d||g.m?(n.addEventListener((g.m?"webkit":"moz")+"visibilitychange",function(){n.hc||n.Bc?ma=m:bf()},m),ma=!(n.hc||n.Bc)):(window.onblur=function(){ma=m},window.onfocus=bf,ma=m,S(window,{mousemove:function b(){ma=i;$b(window,{mousemove:b})}})),ge(),(2===f.updThread||3===f.updThread)&&N(B("de-thread",
n),S(E('<span>[<a href="#">'+Jd[h]+"</a>]</span>"),{click:function(b){w(b);Cb(i,function(){sa(l,0)})}}))):setTimeout(window.scrollTo,20,0,0);f.updScript&&ke(m,function(b){L(b,"updavail",m)})}function cf(){var a=dc=Date.now();if(Nf()){ac=n.createElement("div");var b=(window.location.pathname||"").match(RegExp("^(?:\\/?([^\\.]+?)\\/?)?("+RegExp.quote(d.ka)+")?(\\d+|index|wakaba.*?\\d+)?(\\.(?:[xme]*html?|php))?$"));C=b[1]||(d.rb?"df":"");r=b[2]?b[3]:m;jc=b[3]&&!r?+b[3]||0:0;xb=b[4]||(d.b||d.Pa?"":d.o?
".htm":d.n?".php":".html");Aa=(n.querySelector('head link[rel="shortcut icon"]')||{}).href;O("initBoard");f=gc("DESU_Config_"+d.c)||Yd(g.wa);f.version=Ma.version;g.Y&&(f.preLoadImgs=0);if((g.Y||g.oa)&&2===f.ajaxReply)f.ajaxReply=1;g.Ca||(f.animations=0);if(d.b||d.F)f.findRarJPEG=0;g.d||(Ma.favIcoBlink=0);g.m?f.favIcoBlink=0:f.desktNotif=0;g.e&&(11.6>g.e&&2>f.scriptStyle&&(f.scriptStyle=2),12>g.e&&(f.YTubeTitles=0),2===f.YTubeType&&(f.YTubeType=1),f.updScript=0);f.saveSage||(f.sageReply=0);f.passwValue||
(f.passwValue=Math.round(1E15*Math.random()).toString(32));K("DESU_Config_"+d.c,JSON.stringify(f));h=f.language;ea=yb("DESU_Stat_"+d.c,{view:0,op:0,reply:0});r&&(ea.view=+ea.view+1);K("DESU_Stat_"+d.c,JSON.stringify(ea));f.correctTime&&(Mb=new za(f.timePattern,f.timeOffset,h,sessionStorage.timeRPattern,sessionStorage.timeRPHash));d.i&&(d.dc=new za("yyyy-nn-dd-hh-ii-ss",f.timeOffset||0,f.correctTime?h:1,"1_d _m _y (_w) _h:_i ",152203056));F=new M(!!f.hideBySpell);d.Va=d.b||d.f||Mb||F.Ta||f.crossLinks;
O("readCfg");d.Va&&(Qf(),O("replaceDelform"));Se(A)&&(O("parseDelform"),hc(),O("readFavorites"),f.keybNavig&&(xf(),O("initKeyNavig")),Te(A),cb||(Rf(),O("initPage"),ce(),O("addPanel"),b=t("div",{id:"de-parea",style:"text-align: center;"},[t("div",{id:"de-togglereply",style:"display: none;"},[Y("["),s("a",{text:od[h],href:"#","class":"de-abtn"},{click:ee}),Y("]")]),t("div",{id:"de-pform"},[j.form,ba]),n.createElement("hr")]),r&&1===f.addPostForm?N(d.b?R("hr",A):A,b):$(A,b),(r&&1<f.addPostForm||!r&&
f.noThrdForm)&&J(b),g.ga(b,'<div id="de-qarea" class="'+d.u+'" style="display: none;"></div>'),3===f.addPostForm&&fa(q("de-qarea"),[E('<span id="de-qarea-target">'+pd[h]+' <a class="de-abtn"></a></span>'),s("span",{id:"de-qarea-close",text:"\u00d7"},{click:Ha})]),j.O?ue(l,l,l):ba&&ra(l,C,x[0].a,m,ue),O("initPostform")),Cf(),f.preLoadImgs&&window.postMessage("Kall","*"),x.forEach(tc),$a(JSON.stringify(H)),O("addPostButtons"),f.expandImgs&&(x.forEach(Hb),O("eventPostImg")),f.expandPosts&&!r&&(x.forEach(Bc),
O("expandPost")),f.addMP3&&(Eb(l),O("addLinkMP3")),f.addYouTube&&(Db(l),O("addLinkTube")),f.addImgs&&(Fb(A),O("addLinkImg")),f.imgSrcBtns&&(Gb(A),O("addImgSearch")),2===f.linksNavig&&(wc(I),O("genRefMap")),f.linksNavig&&(ib(A),O("eventRefLink")),Zd(),f.markViewed&&ef(),Ue(),O("readPosts"),le(),O("scriptCSS"),Na(),Oa(),pc=Date.now()-a)}}var Ma={version:"12.9.30.0",language:0,hideBySpell:1,filterThrds:1,menuHiddBtn:1,hideRefPsts:0,delHiddPost:0,updThread:1,updThrDelay:60,favIcoBlink:1,desktNotif:0,
expandPosts:2,expandImgs:2,maskImgs:0,preLoadImgs:0,findRarJPEG:0,showGIFs:0,noImgSpoil:0,postBtnsTxt:0,imgSrcBtns:1,noSpoilers:1,noPostNames:0,noPostScrl:1,keybNavig:0,correctTime:0,timeOffset:"",timePattern:"",linksNavig:2,linksOver:100,linksOut:1500,markViewed:0,strikeHidd:0,noNavigHidd:0,crossLinks:0,insertNum:1,addMP3:1,addImgs:1,addYouTube:3,YTubeType:0,YTubeWidth:360,YTubeHeigh:270,YTubeHD:0,YTubeTitles:0,ajaxReply:2,postSameImg:1,removeEXIF:1,removeFName:0,addPostForm:2,noThrdForm:1,favOnReply:1,
addSageBtn:1,saveSage:1,sageReply:0,captchaLang:1,addTextBtns:1,txtBtnsLoc:0,passwValue:"",userName:0,nameValue:"",userSignat:0,signatValue:"",noBoardRule:1,noGoto:1,noPassword:1,scriptStyle:0,expandPanel:0,attachPanel:1,panelCounter:1,rePageTitle:1,animation:1,closePopups:0,updScript:1,scrUpdIntrv:1,lastScrUpd:0,textaWidth:500,textaHeight:160};ha={hideBySpell:["Заклинания: ","Magic spells: "],filterThrds:["Применять фильтры к тредам",
"Apply filters to threads"],menuHiddBtn:["Дополнительное меню кнопок скрытия ","Additional menu of hide buttons"],hideRefPsts:["Скрывать ответы на скрытые посты*","Hide replies to hidden posts*"],delHiddPost:["Удалять скрытые посты",
"Delete hidden posts"],updThread:{q:[["Откл.","Авто","Счет+клик","По клику"],["Disable","Auto","Count+click","On click"]],s:["AJAX обновление треда* ","AJAX thread update* "]},updThrDelay:[" (сек)"," (sec)"],favIcoBlink:["мигать фавиконом при новых постах*",
"Favicon blinking on new posts*"],desktNotif:["Уведомления на рабочем столе","Desktop notifications"],expandPosts:{q:[["Откл.","Авто","По клику"],["Disable","Auto","On click"]],s:["AJAX загрузка сокращенных постов*",
"AJAX upload of shorted posts*"]},expandImgs:{q:[["Откл.","В посте","По центру"],["Disable","In post","By center"]],s:["раскрывать изображения ","expand images "]},preLoadImgs:["Предварительно загружать изображения*",
"Pre-load images*"],findRarJPEG:["Распознавать rarJPEG'и в изображениях*","Detect rarJPEGs in images*"],showGIFs:["Анимировать GIFы в постах*","Animate GIFs in posts*"],noImgSpoil:["Раскрывать изображения-спойлеры*",
"Open spoiler-images*"],postBtnsTxt:["Кнопки постов в виде текста*","Show post buttons as text*"],imgSrcBtns:["Добавлять кнопки для поиска изображений*","Add image search buttons*"],noSpoilers:["Открывать текстовые спойлеры",
"Open text spoilers"],noPostNames:["Скрывать имена в постах","Hide names in posts"],noPostScrl:["Без скролла в постах","No scroll in posts"],keybNavig:["Навигация с помощью клавиатуры* ",
"Navigation with keyboard* "],correctTime:["Корректировать время в постах* ","Correct time in posts* "],timeOffset:[" Разница во времени"," Time difference"],timePattern:["Шаблон замены","Replace pattern"],linksNavig:{q:[["Откл.",
"Без карты","С картой"],["Disable","No map","With map"]],s:["навигация по >>ссылкам* ","navigation by >>links* "]},linksOver:[" задержка появления (мс)"," delay appearance (ms)"],linksOut:[" задержка пропадания (мс)",
" delay disappearance (ms)"],markViewed:["Отмечать просмотренные посты*","Mark viewed posts*"],strikeHidd:["Зачеркивать >>ссылки на скрытые посты","Strike >>links to hidden posts"],noNavigHidd:["Не отображать превью для скрытых постов",
"Don't show previews for hidden posts"],crossLinks:["Преобразовывать http:// в >>/b/ссылки*","Replace http:// with >>/b/links*"],insertNum:["Вставлять >>ссылку по клику на №поста*","Insert >>link on №postnumber click*"],addMP3:["Добавлять плейер к mp3-ссылкам* ",
"Add player to mp3-links* "],addImgs:["Загружать изображения к .jpg-, .png-, .gif-ссылкам*","Load images to .jpg-, .png-, .gif-links*"],addYouTube:{q:[["Ничего","Плейер по клику","Авто плейер","Превью+плейер",
"Только превью"],["Nothing","On click player","Auto player","Preview+player","Only preview"]],s:["к YouTube-ссылкам* ","to YouTube-links* "]},YTubeType:{q:[["Flash","HTML5 iframe","HTML5 video"],["Flash","HTML5 iframe","HTML5 video"]],s:["",""]},YTubeHD:["HD ","HD "],YTubeTitles:["Загружать названия к YouTube-ссылкам*",
"Load titles into YouTube-links*"],ajaxReply:{q:[["Откл.","Iframe","HTML5"],["Disable","Iframe","HTML5"]],s:["AJAX отправка постов*","posting with AJAX*"]},postSameImg:["Возможность отправки одинаковых изображений",
"Ability to post same images"],removeEXIF:["Удалять EXIF из отправляемых JPEG-изображений","Remove EXIF from uploaded JPEG-images"],removeFName:["Удалять имя из отправляемых файлов","Remove names from uploaded files"],
addPostForm:{q:[["Сверху","Внизу","В постах","Отдельная"],["At top","At bottom","Inline","Hanging"]],s:["форма ответа в треде* ","reply form in thread* "]},noThrdForm:["Прятать форму создания треда",
"Hide thread creating form"],favOnReply:["Добавлять тред в избранное при ответе","Add thread to favorites on reply"],addSageBtn:["Sage вместо поля E-mail* ","Sage button instead of E-mail field* "],saveSage:["запоминать сажу",
"remember sage"],captchaLang:{q:[["Откл.","Eng","Rus"],["Disable","Eng","Rus"]],s:["язык ввода капчи","language input in captcha"]},addTextBtns:{q:[["Откл.","Графич.","Упрощ.","Стандарт."],["Disable","As images","As text","Standard"]],s:["кнопки форматирования текста ",
"text format buttons "]},txtBtnsLoc:["внизу","at bottom"],userPassw:[" Постоянный пароль"," Fixed password"],userName:["Постоянное имя","Fixed name"],userSignat:["Постоянная подпись","Fixed signature"],noBoardRule:["правила ",
"rules "],noGoto:["поле goto ","goto field "],noPassword:["пароль","password"],excludeList:["Список адресов, запрещающих запуск скрипта:","Address list, that excludes script launch:"],scriptStyle:{q:[["Glass black","Glass blue","Solid grey"],["Glass black","Glass blue",
"Solid grey"]],s:["стиль скрипта","script style"]},attachPanel:["Прикрепить главную панель","Attach main panel"],panelCounter:["Счетчик постов/изображений на главной панели",
"Counter of posts/images on main panel"],rePageTitle:["Название треда в заголовке вкладки*","Thread title in page tab*"],animation:["CSS3 анимация в скрипте","CSS3 animation in script"],closePopups:["Автоматически закрывать уведомления",
"Close popups automatically"],updScript:["Автоматически проверять обновления скрипта","Check for script update automatically"],scrUpdIntrv:{q:[["Каждый день","Каждые 2 дня","Каждую неделю",
"Каждые 2 недели","Каждый месяц"],["Every day","Every 2 days","Every week","Every 2 week","Every month"]],s:["интервал проверки","check interval"]},language:{q:[["Ru","En"],["Ru","En"]],s:["",""]}};vd={bold:["Жирный","Bold"],italic:["Наклонный",
"Italic"],under:["Подчеркнутый","Underlined"],strike:["Зачеркнутый","Strike"],spoil:["Спойлер","Spoiler"],code:["Код","Code"],quote:["Цитировать выделенное","Quote selected"]};Ic={filters:["Фильтры","Filters"],
posts:["Посты","Posts"],links:["Ссылки","Links"],form:["Форма","Form"],common:["Общее","Common"],info:["Инфо","Info"]};Pb={settings:["Настройки","Settings"],hidden:["Скрытое","Hidden"],favor:["Избранное","Favorites"],refresh:["Обновить",
"Refresh"],goback:["Назад","Go back"],gonext:["Следующая","Next"],goup:["Наверх","To the top"],godown:["В конец","To the bottom"],newthr:["Создать тред","New thread"],expimg:["Раскрыть картинки","Expand images"],maskimg:["Маскировать картинки",
"Mask images"],"upd-on":["Автообновление треда","Thread autoupdate"],"audio-off":["Звуковое оповещение о новых постах","Sound notification about new posts"],catalog:["Каталог","Catalog"],counter:["Постов/Изображений в треде",
"Posts/Images in thread"]};jd=[["Скрывать выделенное","Скрывать изображение","Скрыв. схожие изобр.","Скрыть схожий текст"],["Hide selected text","Hide same images",
"Hide similar images","Hide similar text"]];kd=[["5 постов","15 постов","30 постов","50 постов","100 постов"],["5 posts","15 posts","30 posts","50 posts","100 posts"]];ld=[["1 страница","2 страницы","3 страницы","4 страницы",
"5 страниц"],["1 page","2 pages","3 pages","4 pages","5 pages"]];md=[["Каждые 30 сек.","Каждую минуту","Каждые 2 мин.","Каждые 5 мин."],["Every 30 sec.","Every minute","Every 2 min.","Every 5 min."]];Jc=["Добавить","Add"];Kc=["Применить",
"Apply"];ob=["Очистить","Clear"];sd=["Обновить","Refresh"];Uc=["Загрузить","Load"];Ja=["Сохранить","Save"];pb=["Правка","Edit"];Yc=["Сброс","Reset"];Vb=["Удалить","Remove"];fd=["Инфо","Info"];Ub=["Отмена",
"Undo"];wa=["Загрузка...","Loading..."];Qb=["Проверка...","Checking..."];Yb=["Удаление...","Deleting..."];sb=["Ошибка:","Error:"];na=["Ошибка подключения","Connection failed"];Dd=["Тред недоступен (№",
"Thread is unavailable (№"];td=["Пост(ы) удален(ы)!","Post(s) deleted!"];ud=["Не могу удалить пост(ы):\n","Can't delete post(s):\n"];Kd=["Неправильные настройки времени","Invalid time settings"];Wc=["Глобальные настройки не найдены",
"Global config not found"];Zb=["Пост не найден","Post not found"];Nc=["Проверить сейчас","Check now"];Hd=["Доступно обновление!","Update available!"];Id=["У вас стоит самая последняя версия!",
"You have latest version!"];Cd=["В треде %m непрочитанных сообщений.","There are %m unreaded messages in thread."];Oc=["Версия: ","Version: "];Pc=["Хранение: ","Storage: "];Qc=["Тредов просмотрено: ","Threads viewed: "];
Rc=["Тредов создано: ","Threads created: "];Sc=["Постов: ","Posts: "];Rb=["Всего: ","Total: "];Mc=["Не отображать: ","Do not show: "];Vc=["Загрузить глобальные настройки","Load global settings"];
Xc=["Сохранить настройки как глобальные","Save settings as global"];Zc=["Сбросить в настройки по умолчанию","Reset settings to defaults"];rb=["Сохранить внесенные изменения",
"Save your changes"];qb=["Правка в текстовом формате","Edit in text format"];gd=["Обновить счетчики постов","Refresh posts counters"];hd=["Проверить актуальность тредов (до 5 страницы)",
"Check for threads actuality (up to 5 page)"];id=["Очистить записи недоступных тредов","Clear notes of inaccessible threads"];Wb=["Удалить выделенные записи","Remove selected notes"];ad=["Скрытые посты на странице",
"Hidden posts on page"];dd=["Скрытые треды","Hidden threads"];bd=["На этой странице нет скрытых постов...","No hidden posts on this page..."];cd=["Нет скрытых тредов...","No hidden threads..."];Tb=["Раскрыть все",
"Expand all"];ed=["Нет избранных тредов...","Favorites is empty..."];Gd=["Ответы:","Replies:"];Ad=["Пропущено ответов: ","Posts omitted: "];Bd=["Свернуть тред","Collapse thread"];Fd=["удалён","deleted"];Jd=["Получить новые посты",
"Get new posts"];Xb=["Страница","Page"];Ed=["Скрытый тред:","Hidden thread:"];od=["Раскрыть форму","Expand form"];nd=["Искать в ","Search in "];zd=["Ответ","Reply"];pd=["Ответ в","Reply to"];rd=["Ждите","Wait"];qd=["+ .rar","+ .rar"];
Lc=['На доске:\n"J" - тред ниже,\n"K" - тред выше,\n"N" - пост ниже,\n"M" - пост выше,\n"V" - вход в тред\n\nВ треде:\n"J" - пост ниже,\n"K" - пост выше,\n"V" - быстрый ответ',
'On board:\n"J" - thread below,\n"K" - thread above,\n"N" - post below,\n"M" - post above,\n"V" - enter a thread\n\nIn thread:\n"J" - post below,\n"K" - post above,\n"V" - quick reply'];xd=["янв,фев,мар,апр,мая,июн,июл,авг,сен,окт,ноя,дек".split(","),"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",")];yd=["января,февраля,марта,апреля,мая,июня,июля,августа,сентября,октября,ноября,декабря".split(","),
"January,February,March,April,May,June,July,August,September,October,November,December".split(",")];wd=["Вск,Пнд,Втр,Срд,Чтв,Птн,Сбт".split(","),"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",")];$c=["Данное действие удалит все ваши настройки и закладки. Продолжить?",
"This will delete all your preferences and favourites. Continue?"];Ld=["Файл повреждён: ","File is corrupted: "];Tc=["Отладка","Debug"];Sb=["Информация для отладки","Information for debugging"];Ba=["синтаксическая ошибка",
"syntax error"];Md=["неизвестный спелл: ","unknown spell: "];Nd=["пропущен оператор перед спеллом","missing operator before spell"];Od=["пропущен аргумент спелла ","missing argument of spell "];
Pd=["ошибка преобразования %1 в число","can't convert %1 to number"];Qd=["синтаксическая ошибка в регулярном выражении: ","syntax error in regular expression: "];Rd=["неожиданный символ ",
"unexpected character "];Sd=["пропущена открывающаяся скобка","missing ( in parenthetical"];Td=["пропущена закрывающаяся скобка","missing ) in parenthetical"];Ka=[" (строка "," (row "];tb=[", столбец ",
", column "];var n=window.document,Ca=Array.prototype,f,H,W,Fa,ea,I={},x=[],ga=[],Z,Q,d={},g,C,r,jc,xb,Ta,j,A,ba,ac,jb,F,Nb;Ob=[];va={};nb=ua=l;Aa="";mb=l;Va=ma=m;Wa=l;lb=Ua=m;var dc,pc,ub="",Mb,bb,h,Sa="",cb,ab;zb.prototype=Ma;Bb.prototype.append=function(a){if("file"===a.type){if(0<a.files.length){var b=a.files[0].name;this.data.push("--"+this.qa+'\r\nContent-Disposition: form-data; name="'+a.name+'"; filename="'+(!f.removeFName?b:" "+b.substring(b.lastIndexOf(".")))+'"\r\nContent-type: '+a.files[0].type+
"\r\n\r\n",l,"\r\n");this.uc(a,this.data.length-2)}}else("checkbox"!==a.type||a.checked)&&this.data.push("--"+this.qa+'\r\nContent-Disposition: form-data; name="'+a.name+'"\r\n\r\n'+a.value+"\r\n")};Bb.prototype.uc=function(a,b){var c=new FileReader,e=a.files[0],k=this;/^image\/(?:png|jpeg)$/.test(e.type)?(c.onload=function(){var g=Af(new Uint8Array(this.result),d.F||d.b||!!a.Z);g?(a.Z&&g.push(a.Z),f.postSameImg&&g.push(""+Math.round(1E6*Math.random())),k.data[b]=new Blob(g),k.Oa--):(k.error=i,L(Ld[h]+
e.name,"upload",m));c=k=a=b=e=l},c.readAsArrayBuffer(e),this.Oa++):this.data[b]=e};za.zc=function(a){if(a.checked&&(!/^[+-]\d{1,2}$/.test(f.timeOffset)||za.nb(f.timePattern)))L(Kd[h],"err-correcttime",m),P("correctTime",0),a.checked=m};za.nb=function(a){return!a.contains("i")||!a.contains("h")||!a.contains("d")||!a.contains("y")||!(a.contains("n")||a.contains("m"))||/[^\?\-\+sihdmwny]|mm|ww|\?\?|([ihdny]\?)\1+/.test(a)};za.prototype={fc:function(a){if(this.yb||this.disabled)return this;var b,c,e,
d=1,f=0,o=a.match(RegExp(this.Ib));if(!o)return this.disabled=i,this;this.ja="";for(e=o[0];c=o[d++];){if("m"===(b=this.pattern[d-2]))this.Ra=3<c.length;a=e.indexOf(c,f);this.ja+=e.substring(f,a)+"_"+b;f=a+c.length}sessionStorage.timeRPHash=Za(sessionStorage.timeRPattern=(this.Ra?"1":"0")+this.ja);this.yb=i;return this},sb:function(a){function b(a){return 10>a?"0"+a:a}if(this.disabled)return a;var c=this.Vb,e=this.Ra?this.Tb:this.Ub,d=this.pattern,f=this.ja,o=this.$b,a=a.replace(RegExp(this.Ib,"g"),
function(){var a,g,h,j,n,q,r,s,t;for(a=1;8>a;a++)g=arguments[a],h=d[a-1],"s"===h?j=g:"i"===h?n=g:"h"===h?q=g:"d"===h?r=g:"n"===h?s=g-1:"y"===h?t=g:"m"===h&&(s=/^янв|^jan/i.test(g)?0:/^фев|^feb/i.test(g)?1:/^мар|^mar/i.test(g)?2:/^апр|^apr/i.test(g)?3:/^май|^may/i.test(g)?4:/^июн|^jun/i.test(g)?5:/^июл|^jul/i.test(g)?6:/^авг|^aug/i.test(g)?7:/^сен|^sep/i.test(g)?8:
/^окт|^oct/i.test(g)?9:/^ноя|^nov/i.test(g)?10:/^дек|^dec/i.test(g)&&11);a=new Date(2===t.length?"20"+t:t,s,r,q,n,j||0);a.setHours(a.getHours()+o);return f.replace("_s",b(a.getSeconds())).replace("_i",b(a.getMinutes())).replace("_h",b(a.getHours())).replace("_d",b(a.getDate())).replace("_w",c[a.getDay()]).replace("_n",b(a.getMonth()+1)).replace("_m",e[a.getMonth()]).replace("_y",2===t.length?(""+a.getFullYear()).substring(2):a.getFullYear())}),c=e=d=f=
o=b=l;return a}};M.mb=function(a,b){var c,e;e=a[0];for(c=e.length-1;0<=c;c--)if(e[c]===b)return i;e=a[1];for(c=e.length-1;0<=c;c--)if(b>=e[c][0]&&b<=e[c][1])return i;return m};M.Aa=function(a,b,c,e,d,f,g){b=F.Da(c,b);b===l?F.bb(a,e,d,f,g):b?(e=e.pop(),d(a,F.Ha(e[2][e[0]-1]),g)):f&&f(a,g)};M.prototype={Ja:"words,exp,exph,imgn,ihash,subj,name,trip,img,sage,op,tlen,all,video,wipe,num".split(","),eb:[function(a,b){var c;return xa(a).toLowerCase().contains(b)||(c=a.querySelector(".replytitle, .filetitle"))&&
c.textContent.toLowerCase().contains(b)},function(a,b){return b.test(xa(a))},function(a,b){return b.test(a.innerHTML)},function(a,b){var c=B(d.V,a);return c&&b.test(c.textContent)},function(a,b){return a.H[0]&&oe(a)===b},function(a,b){var c=a.querySelector(".replytitle, .filetitle");return!c||!(c=c.textContent)?m:!b||b.test(c)},function(a,b){var c=a.querySelector(".commentpostername, .postername");return!c||!(c=c.textContent)?m:!b||c.contains(b)},function(a,b){var c=B("postertrip",a);return!c?m:!b||
c.textContent.contains(b)},function(a,b){if(!a.H[0])return m;if(b){var c,e,d;if(c=b[1]){d=Xd(a);switch(b[0]){case 0:e=d>=c[0]&&d<=c[1];break;case 1:e=d<c[0];break;case 2:e=d>c[0]}if(e){if(!b[2])return i}else return m}if(c=b[2])switch(e=fc(a),d=+e[0],e=+e[1],b[0]){case 0:return d>=c[0]&&d<=c[1]&&e>=c[2]&&e<=c[3];case 1:return d<c[0]&&e<c[3];case 2:return d>c[0]&&e>c[3]}}return i},function(a){return a.Jb},function(a){return a.k},function(a,b){var c=xa(a);return!b?!!c:M.mb(b,c.replace(/\n/g,"").length)},
function(){return i},function(a,b,c,e,d,g){if(b)if(!a.$a||!f.YTubeTitles)M.Aa(a,m,c,e,d,g,m);else{var o=X("de-ytube-link",a),h=21,j=0,n=o.length;(function yf(){var f;0===--h&&(h=21,j++);for(;j<n;)switch(f=o[j],f.Ya){case 1:setTimeout(yf,500);return;case 2:if(b.test(f.textContent)){M.Aa(a,i,c,e,d,g,20!==h);o=h=j=n=a=b=e=d=g=l;return}default:j++}M.Aa(a,m,c,e,d,g,20!==h);o=h=j=n=a=b=e=d=g=l})()}else M.Aa(a,!!a.$a,c,e,d,g,m)},function(a,b){var c,e,d,f,g,h,j,n,q=xa(a);if(b&1&&(c=q.replace(/>/g,"").split(/\s*\n\s*/),
5<(e=c.length))){c.sort();d=0;for(g=e/4;d<e;){h=c[d];for(f=0;c[d++]===h;)f++;if(4<f&&f>g&&h)return M.D='same lines: "'+h.substr(0,20)+'" x'+f,i}}if(b&2&&(c=q.replace(/[\s\.\?\!,>]+/g," ").toUpperCase().split(" "),3<(e=c.length))){c.sort();d=0;g=e/4;for(n=j=0;d<e;j++){h=c[d];for(f=0;c[d++]===h;)f++;if(25<e&&(f>n&&2<h.length&&(n=f),n>=g))return M.D='same words: "'+h.substr(0,20)+'" x'+n,i}h=j/e;if(0.25>h)return M.D="uniq words: "+(100*h).toFixed(0)+"%",i}if(b&4&&(c=q.replace(/https*:\/\/.*?(\s|$)/g,
"").replace(/[\s\.\?!,>:;-]+/g," ").split(" "),50<c[0].length||1<(e=c.length)&&10<c.join("").length/e))return M.D="long words",i;if(b&8&&(c=q.replace(/\s+/g,""),30<(e=c.length)&&0.4<(h=c.replace(/[0-9a-zа-я\.\?!,]/ig,"").length/e)))return M.D="specsymbols: "+(100*h).toFixed(0)+"%",i;if(b&16&&(c=q.replace(/[\s\.\?!;,-]+/g," ").trim().split(" "),4<(e=c.length))){for(j=f=g=d=0;d<e;d++)h=c[d],5>(h.match(/[a-zа-я]/ig)||[]).length||(2<(h.match(/[A-ZА-Я]/g)||[]).length&&j++,
h===h.toUpperCase()&&f++,g++);if(0.3<=f/g&&4<g)return M.D="CAPSLOCK: "+100*(f/c.length)+"%",i;if(0.3<=j/g&&8<g)return M.D="cAsE words: "+100*(j/c.length)+"%",i}return b&32&&(c=q.replace(/\s+/g," ").replace(/>>\d+|https*:\/\/.*?(?: |$)/g,""),30<(e=c.length)&&0.4<(h=(e-c.replace(/\d/g,"").length)/e))?(M.D="numbers: "+Math.round(100*h)+"%",i):M.D=m},function(a,b){return M.mb(b,a.count+1)}],Na:function(a,b){var c=a.lastIndexOf("/"),e=a.substr(c+1);return RegExp(a.substr(1,c-1),b?e.replace("g",""):e)},
Pb:function(a,b,c){if(2===this.t)return this.B=Nd[h],this.C=0;var e,d,f,g,j,p=b.substr(c+1).match(/^([a-z]+)(?:\[([a-z0-9]+)(?:(,)|,(\s*[0-9]+))?\])?/);if(!p)return this.B=Ba[h],this.C=0;d=this.Ja.indexOf(p[1]);if(-1===d)return this.B=Md[h]+p[1],this.C=1,0;this.ca?(f=d|256,this.ca=m):f=d;e=p[2]&&[p[2],p[4]?p[4]:p[3]?-1:m];b=b.substr(c+1+p[0].length);if("("===b[0])if(1===d||2===d||3===d||5===d||13===d){g=b.match(/^\(\)|\((\/.*?[^\\]\/[ig]*)\)/);if(!g)return this.B=Ba[h],this.C=0;b=g[1]||""}else{g=
b.match(/^\(\)|\((.*?[^\\])\)/);if(!g)return this.B=Ba[h],this.C=0;b=g[1].replace(/\\\)/g,")")||""}else b="";if(!b)if(4<d&&15>d)b="";else return this.B=Od[h]+p[0],this.C=p[0].length,0;switch(d){case 0:a.push([f,b.toLowerCase(),e]);break;case 4:b=+b;if(b!==b)return this.B=Pd[h].replace("%1",p[5]),this.C=p[0].length,0;a.push([f,b,e]);break;case 8:if(b){b=b.match(/^([><=])(?:(\d+(?:\.\d+)?)(?:-(\d+(?:\.\d+)?))?)?(?:@(\d+)(?:-(\d+))?x(\d+)(?:-(\d+))?)?$/);if(!b||!b[2]&&!b[4])return this.B=Ba[h],this.C=
p[0].length,0;a.push([f,["="===b[1]?0:"<"===b[1]?1:2,b[2]&&[+b[2],b[3]?+b[3]:+b[2]],b[4]&&[+b[4],b[5]?+b[5]:+b[4],+b[6],b[7]?+b[7]:+b[6]]],e])}else a.push([f,b,e]);break;case 14:if(b){if(j=0,b.split(/, */).some(function(a){switch(a){case "samelines":j=j|1;return m;case "samewords":j=j|2;return m;case "longwords":j=j|4;return m;case "symbols":j=j|8;return m;case "capslock":j=j|16;return m;case "numbers":j=j|32;return m;default:return i}}))return this.B=Ba[h],this.C=p[0].length,0}else j=63;a.push([f,
j,e]);break;case 11:if(!b){a.push([f,b,e]);break}case 15:b.split(/, */).forEach(function(a){if(a.contains("-")){a=a.split("-");a[0]=+a[0];a[1]=+a[1];this[1].push(a)}else this[0].push(+a)},j=[[],[]]);a.push([f,j,e]);break;case 13:case 5:if(!b){a.push([f,b,e]);break}case 1:case 2:case 3:try{this.Na(b,i)}catch(n){return this.B=Qd[h]+b,this.C=p[0].length,0}default:a.push([f,b,e])}this.t=2;return p[0].length+(g?g[0].length:0)},Rb:function(a,b){if(2===b){if(!this.t||3===this.t)return this.t=1,this.ca=i}else if(2===
this.t||4===this.t)return this.t=0,1===b&&(a[a.length-1][0]|=512),i;return m},Mb:function(a){if(!a)return l;this.t=this.ca=l;for(var b=[],c=[],e=b,d=0,f,g=1,j=1,p=0,n=a.length;p<n;p++,g++)switch(a[p]){case "\n":j++,g=0;case " ":continue;case "#":f=this.Pb(e,a,p);if(0===f)return this.R=this.B+Ka[h]+j+tb[h]+(g+this.C)+")",m;p+=f;g+=f;break;case "(":c.push(e);e.push([this.ca?511:255,[]]);e=e[e.length-1][1];d++;this.t=3;this.ca=m;break;case ")":if(0<d)e=c.pop(),d--;else return this.R=Sd[h]+Ka[h]+j+tb[h]+
g+")",m;this.t=4;break;case "|":case "&":case "!":if(this.Rb(e,"|"===a[p]?0:"&"===a[p]?1:2))break;default:return this.R=Rd[h]+a[p]+Ka[h]+j+tb[h]+g+")",m}return 2!==this.t&&4!==this.t?(this.R=Ba[h]+Ka[h]+j+")",m):0<d?(this.R=Td[h]+Ka[h]+j+")",m):0===b.length?l:b},Ea:function(a,b,c,e){var d=0!==(b&256);if(c===e-1){if(0===c)return d?[[12,"",l]]:l;b=a.length-1;if(d){for(;a[b]&&0===(a[b][0]&512);)delete a[b],b-=2;a[b]&&(a[b][0]&=511);return 0<=b?a:[[12,"",l]]}for(;a[b]&&0!==(a[b][0]&512);)delete a[b],
b-=2;return 0<=b?a:l}if(0!==(b&512)){if(!d)return l}else if(d)return[[12,"",l]];return m},hb:function(a){for(var b=0,c=a.length,e=[],d,f,g;b<c;b++)if(f=a[b],d=f[0]&255,255===d)if(g=this.hb(f[1]))1===g.length?(g=g[0],g[0]|=f[0]&768,e.push(g)):e.push([f[0],g]);else{if(g=this.Ea(e,f[0],b,c),g!==m)return g}else if((g=f[2])&&(g[0]!==C||(-1===g[1]?r:g[1]&&g[1]!==r))){if(g=this.Ea(e,f[0],b,c),g!==m)return g}else if(12===d){if(g=this.Ea(e,f[0]^256,b,c),g!==m)return g}else e.push(f);return 0===e.length?l:
e},ib:function(a){return!a?m:this.hb(a)},Ob:function(a){a&&a.forEach(function c(a){var d=a[1];if(d)switch(a[0]&255){case 1:case 2:case 3:case 5:case 13:a[1]=this(d,i);break;case 255:d.forEach(c,this)}},this.Na);return a},Da:function(a,b){0!==(a&256)&&(b=!b);if(0!==(a&512)){if(!b)return m}else if(b)return i;return l},Ha:function(a){var b=a[0]&255,c=a[1];if(255===b)return this.Ha(c[this.gb]);a=0!==(a[0]&256)?"!":"";switch(b){case 14:return a+("#wipe"+(M.D?": "+M.D:""));default:a+="#"+this.Ja[b]+(c?
": "+c:"")}return a},bb:function(a,b,c,e,d){var f,g;g=m;f=b.pop();for(var h=f[0],j=f[1],n=f[2];;){if(h<j){g=n[h][0];f=g&255;if(255===f){b.push([h,j,n]);n=n[h][1];j=n.length;h=0;continue}else if(13===f){b.push([h+1,j,n]);this.eb[f](a,n[h][1],g,b,c,e);break}else f=this.eb[f](a,n[h][1]);g=this.Da(g,f);if(g===l){h++;continue}this.gb=h}else this.gb=h-=1,g=m;if(f=b.pop())if(h=f[0],j=f[1],n=f[2],g=this.Da(n[h][0],g),g===l){h++;continue}g?c(a,this.Ha(n[h]),d):e&&e(a,d);break}},Qb:function(a,b,c){this.bb(a,
[[0,this.Ma.length,this.Ma]],function(a,c,d){b(a,c);d&&(clearTimeout(Nb),Nb=setTimeout(Na,500))},c&&function(a,b){c(a);b&&(clearTimeout(Nb),Nb=setTimeout(Na,500))},m)},Ga:function(a,b,c){c&&c(a)},Nb:function(a){var b=[],c=[],e="",a=a.replace(/([^\\]\)|^)?[\n\s]*(#rep(?:\[([a-z0-9]+)(?:(,)|,(\s*[0-9]+))?\])?\((\/.*?[^\\]\/[ig]*)(?:,\)|,(.*?[^\\])?\)))[\n\s]*/g,function(a,c,d,f,g,h,j,n){b.push([f,g?-1:h,j,(n||"").replace(/\\\)/g,")")]);e+=d+"\n";return c||""}).replace(/([^\\]\)|^)?[\n\s]*(#outrep(?:\[([a-z0-9]+)(?:(,)|,(\s*[0-9]+))?\])?\((\/.*?[^\\]\/[ig]*)(?:,\)|,(.*?[^\\])?\)))[\n\s]*/g,
function(a,b,d,f,g,h,j,n){c.push([f,g?-1:h,j,(n||"").replace(/\\\)/g,")")]);e+=d+"\n";return b||""});this.L.vc=b;this.L.kc=c;return[a,e]},pa:function(a){if(a){var b=[];a.forEach(function(a){(!a[0]||a[0]===C&&(-1===a[1]?!r:!a[1]||a[1]===r))&&b.push([a[2],a[3]])});return 0===b.length?m:b}return m},fb:function(a){if(a)for(var b=a.length-1;0<=b;b--)a[b][0]=this.Na(a[b][0],m);return a},Ia:function(a,b,c){this.Ma=this.Ob(a);this.La=this.fb(b);this.Ka=this.fb(c);this.W=this.Ma?this.Qb:this.Ga;this.wb=!!a;
this.Ta=!!b;this.vb=!!c},Fa:function(){this.hash=0;this.list="";this.W=this.Ga;this.wb=this.Ta=this.vb=m;P("hideBySpell",0)},cb:function(a){function b(a,b,c,e,d){d.push(a?"(#op"+b+" & "+c+e+")":c+b+e)}var c=[],e=[],g=[],h="";a.forEach(function(a){if(a){var d,f="",h=m;if("#"===a[0]&&(d=a.match(/^#([a-z]+)\/([0-9]+)? /)))f=d[1]?"["+d[1]+(d[2]?","+d[2]:"")+"]":"",a=a.substr(d[0].length);a.yc()&&(a=a.substr(4),h=i);if("#"===a[0]){if(d=a.match(/^#([a-z]+)(?: (.*))?/))switch(d[1]){case "sage":b(h,f,"#sage",
"",c);break;case "notxt":b(h,f,"!#tlen","",c);break;case "noimg":b(h,f,"!#img","",c);break;case "trip":b(h,f,"#trip","",c);break;case "tmax":b(h,f,"#tlen","("+d[2]+"-9000)",c);break;case "name":a=d[2].split("!!");2===a.length&&b(h,f,"#trip","(!!"+a[1]+")",c);a[0]&&(a=a[0].split("!"),2===a.length&&b(h,f,"#trip","(!"+a[1]+")",c),a[0]&&b(h,f,"#name","("+a[0].replace(/\)/g,"\\)")+")",c));break;case "skip":b(h,f,"!#num","("+d[2]+")",g);break;case "rep":case "outrep":a=d[2].match(/(\/.*?[^\\]\/[ig]*)(?: (.*))?/);
e.push("#"+d[1]+f+"("+a[1]+","+(a[2]||"").replace(/\)/g,"\\)")+")");break;case "theme":d[1]="subj";case "exp":case "exph":case "imgn":b(h,f,"#"+d[1],"("+d[2]+")",c);break;default:b(h,f,"#"+d[1],"("+d[2].replace(/\)/g,"\\)")+")",c)}}else b(h,f,"#words","("+a.replace(/\)/g,"\\)")+")",c)}});0!==f.hideByWipe&&(h=[],0!==f.wipeSameLin&&h.push("samelines"),0!==f.wipeSameWrd&&h.push("samewords"),0!==f.wipeLongWrd&&h.push("longwords"),1===f.wipeSpecial&&h.push("symbols"),1===f.wipeCAPS&&h.push("capslock"),
0!==f.wipeNumbers&&h.push("numbers"),h=0===h.length?"":"#wipe("+h.join(",")+")"+(0!==c.length?" |\n":""));delete f.hideByWipe;delete f.wipeSameLin;delete f.wipeSameWrd;delete f.wipeLongWrd;delete f.wipeSpecial;delete f.wipeCAPS;delete f.wipeNumbers;K("DESU_Config_"+d.c,JSON.stringify(f));return(0!==g.length?g.join(" &\n")+" &\n":"")+h+c.join(" |\n")+"\n\n"+e.join("\n")},Hb:m,ic:function(a){a=this.Ja.indexOf(a);return 5>a||14<a},ha:function(a){a=(""+a).replace(/[\s\n]+$/,"");this.L={};var a=this.Nb(a),
b=this.Mb(a[0]);if(b!==m)this.L.bc=b;else if(this.R){try{L(sb[h]+" "+this.R,"help-err-spell",m)}catch(c){GM_log(sb[h]+" "+this.R)}return m}this.L.list=a.join("\n\n").replace(/[\s\n]+$/,"");return a},Wa:function(a){this.hash=Za(a);this.list=a;K("DESU_Spells_"+d.c,JSON.stringify([1,this.hash,this.list]));a||this.Fa()},Xa:function(){var a=this.L.bc,b=this.ib(a),c=this.L.vc,e=this.L.kc;0===c.length&&(c=m);0===e.length&&(e=m);K("DESU_CSpells_"+d.c,JSON.stringify([this.hash,a,c,e]));c=this.pa(c);e=this.pa(e);
sessionStorage["de-spells"]=JSON.stringify([this.hash,b,c,e]);this.Ia(b,c,e);this.Wa(this.L.list)},Gb:function(){var a,b=Ea("DESU_Spells_"+d.c);this.Hb=i;if(b)try{return a=JSON.parse(b),3>a.length?(this.list=a[1]?this.cb(a[1]):"",this.hash=Za(this.list)):(this.hash=a[1],this.list=a[2]),this.hash}catch(c){}this.list="string"===typeof b?this.cb(b.split("\n")):"#wipe(samelines,samewords,longwords,numbers)";return this.hash=Za(this.list)},update:function(){if(this.Gb()){var a;try{if((a=JSON.parse(sessionStorage["de-spells"]))&&
a[0]===this.hash){this.Ia(a[1],a[2],a[3]);return}}catch(b){}try{if((a=JSON.parse(Ea("DESU_CSpells_"+d.c)))&&a[0]===this.hash){var c=this.ib(a[1]),e=this.pa(a[2]),f=this.pa(a[3]);this.Ia(c,e,f);sessionStorage["de-spells"]=JSON.stringify([this.hash,c,e,f]);return}}catch(g){}a=this.ha(this.list);this.Wa(a?a.join("\n\n").replace(/\n+$/,""):"");this.Xa()}else this.Fa()},disable:function(){this.W=this.Ga},replace:function(a){for(var b=0,c=this.La.length;b<c;b++)a=a.replace(this.La[b][0],this.La[b][1]);
return a},jc:function(a){for(var b=0,c=this.Ka.length;b<c;b++)a=a.replace(this.Ka[b][0],this.Ka[b][1]);return a}};window.opera?S(n,{DOMContentLoaded:cf}):cf()})(window.opera&&window.opera.scriptStorage);
