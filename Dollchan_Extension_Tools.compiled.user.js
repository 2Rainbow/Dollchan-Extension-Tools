// ==UserScript==
// @name			Dollchan Extension Tools
// @version			12.11.20.0
// @namespace		http://www.freedollchan.org/scripts/*
// @author			Sthephan Shinkufag @ FreeDollChan
// @copyright		(C)2084, Bender Bending Rodriguez
// @description		Doing some profit for imageboards
// @icon			https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/stable/Icon.png
// @updateURL		https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/stable/Dollchan_Extension_Tools.meta.js
// @include			*
// ==/UserScript==
var ta=void 0,i=!0,l=null,n=!1;
(function(Ca){var Ra,Sa,Ta,hb,la,Da,ib,ua,jb,Qb,va,Rb,ha,Kc,Lc,Mc,kb,Nc,Oc,Pc,Qc,Sb,Rc,Sc,Tc,Uc,Vc,Tb,Wc,Xc,Yc,lb,Zc,$c,ad,bd,cd,dd,ed,fd,gd,hd,Ub,Vb,id,jd,kd,Wb,Xb,ld,md,nd,Yb,od,wa,pd,qd,rd,sd,td,ud,vd,wd,xd,yd,zd,Ad,Bd,Cd,Zb,mb,Dd,Ed,Fd,xa,Gd,Hd,Id,Jd,Kd,$b,Ld,Md,Nd,Od,Pd,Qd,Rd,Sd,Td,Ud,Vd,Wd,Xd,ma,Yd,ac,Zd,$d,ae,be,ce,Ea,Ua;function W(a,b){return m.evaluate(a,b,l,8,l).singleNodeValue}function nb(a,b){return b.querySelector(a)}function T(a,b){return k.a?b.getElementsByClassName(a):b.querySelectorAll("."+
a)}function t(a,b){return b.getElementsByClassName(a)[0]}function p(a){return m.getElementById(a)}function N(a,b){return b.getElementsByTagName(a)[0]}function B(a,b){na.forEach.call(a,b)}function de(a,b){var c=a.cloneNode(n);c.innerHTML=b;a.parentNode.replaceChild(c,a);return c}function U(a,b){for(var c in b)"text"===c?a.textContent=b[c]:"value"===c?a.value=b[c]:a.setAttribute(c,b[c]);return a}function P(a,b){for(var c in b)a.addEventListener(c,b[c],n);return a}function bc(a,b){for(var c in b)a.removeEventListener(c,
b[c],n)}function ea(a,b){for(var c=0,d=b.length;c<d;c++)b[c]&&a.appendChild(b[c])}function X(a,b){a.parentNode.insertBefore(b,a)}function L(a,b){a.parentNode.insertBefore(b,a.nextSibling)}function D(a){cc.innerHTML=a;return cc.firstChild}function s(a,b,c){a=m.createElement(a);b&&U(a,b);c&&P(a,c);return a}function v(a,b,c){a=s(a,b,l);ea(a,c);return a}function S(a){return m.createTextNode(a)}function Y(a,b,c){return s("input",{type:"button",value:a,title:b},{click:c})}function ob(a){return m.head.appendChild(s("script",
{type:"text/javascript",text:a},l))}function dc(a){return m.head.appendChild(s("style",{type:"text/css",text:a},l))}function G(a,b){return a?b:l}function J(a){a.style.display="none"===a.style.display?"":"none"}function r(a){a&&a.parentNode.removeChild(a)}function oa(a){a=a.getBoundingClientRect();return{top:Math.round(a.top+window.pageYOffset),left:Math.round(a.left+window.pageXOffset)}}function pb(a){window.scrollTo(0,oa(a).top)}function A(a){a.preventDefault()}function Va(a,b){var c=a.scrollTop,
d=a.selectionStart;a.value=a.value.substr(0,d)+b+a.value.substr(a.selectionEnd);a.setSelectionRange(d+b.length,d+b.length);a.focus();a.scrollTop=c}function fc(){return(k.e?m.getSelection():window.getSelection()).toString()}function pa(a){for(var b in a)if(a.hasOwnProperty(b))return n;return i}function M(a){var b=Date.now();qb.push(a+": "+(b-gc)+"ms");gc=b}function ee(a){var b,c=new window.XMLHttpRequest;a.onreadystatechange&&(c.onreadystatechange=function(){a.onreadystatechange(c)});c.onload=function(){if(a.onload)a.onload(c);
c=a=l};c.open(a.method,a.url,i);a.responseType&&(c.responseType=a.responseType);for(b in a.headers)c.setRequestHeader(b,a.headers[b]);c.send(l)}function rb(a,b,c){this.yb=[];this.length=0;this.ab=b;this.Hb=c;this.Hc=a;this.na=0;this.Eb=n}function Wa(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function ca(a){return W("ancestor::*[@de-post]",a)}function Ia(a){return a.querySelectorAll('.thumb, img[src*="thumb"], img[src*="/spoiler"], img[src^="blob:"]')}function fe(a){return(a=a.querySelector(e.Uc))&&
(a=a.textContent)?+(a.match(/\d+/)||[0])[0]:0}function qa(a){return a.dc||(a.dc=a.i.innerHTML.replace(/<\/?(?:br|p|li)[^>]*?>/gi,"\n").replace(/<[^>]+?>/g,"").replace(/&gt;/g,">").replace(/&lt;/g,"<").trim())}function ge(a){var a=t(e.ba,a).textContent.match(/(\d+(?:\.\d+)?)\s*([mkк])?[bб]/i),b=parseFloat(a[1]);return"M"===a[2]?1E3*b|0:!a[2]?Math.round(b/1E3):b}function hc(a){a=t(e.ba,a);return e.F?(a=a.onclick.toString().split("', '"),[a[3],a[4]]):(a=a?a.textContent.match(/(\d+)[x\u00d7](\d+)/):
n)?a.slice(1):[l,l]}function sb(a){return"/"+a+(a?"/":"")}function ic(a,b){var c,d,j=a instanceof Array;if(j){if(0===a.length)return"[]";c="["}else{if(pa(a))return"{}";c="{"}d=0;k.forEach(a,function(a){var e=this[a],u=typeof e;"function"!==u&&("object"===u&&(u=e===l?"null":e instanceof Array?"array":e instanceof Date?"date":e instanceof RegExp?"regex":"object"),0<d&&(c+=","),c+="\n"+b+"    "+(j?"":'"'+a+'": ')+("array"===u||"object"===u?ic(e,b+"    "):"boolean"===u||"number"===u?e.toString():"string"===
u?'"'+e.replace(/(["\n\\])/g,"\\$1")+'"':u),d++)});return c+="\n"+b+(j?"]":"}")}function Xa(a){for(var b,c=0,d=0,j=a.length;d<j;++d){c=(c<<4)+a.charCodeAt(d);if(b=c&4026531840)c^=b>>>24;c&=~b}return c}function he(a){for(var b,c=m.cookie.split("; "),d=c.length;d--;)if(b=c[d].split("="),b[0]===escape(a))return unescape(b[1]);return n}function Fa(a){return k.Da?GM_getValue(a):Ca?Ca.getItem(a):localStorage.getItem(a)}function fa(a,b){k.Da?GM_setValue(a,b):Ca?Ca.setItem(a,b):localStorage.setItem(a,b)}
function tb(a){k.Da?GM_deleteValue(a):Ca?Ca.removeItem(a):localStorage.removeItem(a)}function ub(a){var b={};try{return JSON.parse(Fa(a))||b}catch(c){return b}}function ie(){try{var a=JSON.parse(Fa("DESU_Config_"+e.c));tb("DESU_Config_"+e.c);if(a.version)return delete a.version,delete a.lastScrUpd,a}catch(b){}return n}function ya(a,b){b?Z[a]=b:delete Z[a];fa("DESU_Config",JSON.stringify(Z))}function Q(a,b){f[a]!==b&&(f[a]=b,ya(e.c,f))}function vb(a){Q(a,!f[a]?1:0)}function je(){V=[];if(q){var a=(sessionStorage["de-hidden-"+
x+q]||"").split(",");if(2===a.length&&+a[0]===(f.hideBySpell?E.hash:0))if(V=a[1].split(""),a=sessionStorage["de-deleted"])a.split(",").forEach(function(a){V.splice(a,1)}),delete sessionStorage["de-deleted"]}V.length=y.length;O=ub("DESU_Posts_"+e.c+"_"+x);ke()}function Ja(){q&&(sessionStorage["de-hidden-"+x+q]=(f.hideBySpell?E.hash+",":"0,")+V.join(""));ra("hid",i)}function Ka(){var a,b=JSON.stringify(O);9E3<b.length&&(a=Date.now()-432E6,k.forEach(O,function(b){O[b][1]<a&&delete O[b]}),b=JSON.stringify(O));
fa("DESU_Posts_"+e.c+"_"+x,b);ra("hid",i)}function ke(){$=ub("DESU_Threads");La=($[e.c]||{})[x]||{}}function le(a){pa($[e.c][a])&&delete $[e.c][a];pa($[e.c])&&delete $[e.c]}function me(){($[e.c]||($[e.c]={}))[x]=La;le(x);fa("DESU_Threads",JSON.stringify($))}function ne(a,b){0===b?La[a.b]=a.ua:delete La[a.b];me()}function jc(){F=ub("DESU_Favorites")}function wb(a){fa("DESU_Favorites",a);ra("fav",i)}function kc(a,b,c){delete F[a][b][c];pa(F[a][b])&&delete F[a][b];pa(F[a])&&delete F[a];H[c]&&((t("de-btn-fav-sel",
H[c].G)||{}).className="de-btn-fav")}function oe(a,b){var c=e.host,d=x,j=a.b;b&&(jc(),F[c]&&F[c][d]&&F[c][d][j]?kc(c,d,j):(F[c]||(F[c]={}),F[c][d]||(F[c][d]={}),F[c][d][j]={cnt:a.M.R+1,txt:a.ua,url:e.J(x,j)},b.className="de-btn-fav-sel"),wb(JSON.stringify(F)))}function pe(){var a=sessionStorage["de-viewed"];a&&a.split(",").forEach(function(a){if(a=H[a])k.s(a,"de-viewed"),a.ob=i})}function aa(a,b,c,d,j){return v("li",l,[s("a",{id:"de-btn-"+a,"class":"de-abtn",title:Rb[a][h],href:c||"#",onmouseout:j},
{click:b,mouseover:d})])}function qe(){var a=Ia(w).length;X(w,v("div",{id:"de-main",lang:re()},[v("div",{id:"de-panel"},[s("span",{id:"de-btn-logo"},{click:function(){vb("expandPanel");ia()}}),v("ul",{id:"de-panel-btns"},[aa("settings",function(a){A(a);ra("cfg",n)},l,l,l),aa("hidden",function(a){A(a);ra("hid",n)},l,l,l),aa("favor",function(a){A(a);ra("fav",n)},l,l,l),aa("refresh",function(a){A(a);window.location.reload()},l,function(){q||zf()},"de_delSelection(event)"),aa("goback",l,e.ca(x,Ya-1),
l,l),G(!q,aa("gonext",l,e.ca(x,Ya+1),l,l)),aa("goup",function(a){A(a);window.scrollTo(0,0)},l,l,l),aa("godown",function(a){A(a);window.scrollTo(0,m.body.scrollHeight||m.body.offsetHeight)},l,l,l),G(!q&&(g.form||ba),aa("newthr",se,l,l,l)),G(0<a,aa("expimg",function(a){A(a);f.expandImgs=1;Za=!Za;y.forEach(function(a){lc(a,Za)})},l,l,l)),G(g.file||ba,aa("maskimg",function(a){A(a);vb("maskImgs");ia()},l,l,l)),G(q&&1===f.updThread,aa("upd-on",function(a){A(a);xb?te():(this.id="de-btn-upd-on",ue())},l,
l,l)),G(!k.xa&&q&&1===f.updThread,aa("audio-off",function(a){A(a);ve();Ra=n;this.id=Sa?"de-btn-audio-on":"de-btn-audio-off";r(p("de-menu"))},l,Af,"de_delSelection(event)")),G(e.W,aa("catalog",l,"//"+e.host+"/"+x+"/catalog.html",l,l))]),G(q,D('<div id="de-panel-info"><span title="'+Rb.counter[h]+'">'+y.length+"/"+a+"</span></div>"))]),s("div",{"class":"de-content"},l),s("div",{id:"de-alert"},l),s("hr",{style:"clear: both;"},l)]))}function ra(a,b){if(!$a){var c=t("de-content",m),d="de-content-"+a;b&&
c.id!==d||(c.childElementCount&&f.animation?(k.aa(c,function(c){we(c,d,a,b);d=a=b=l}),c.className="de-content de-cfg-close"):we(c,d,a,b))}}function we(a,b,c,d){a.innerHTML=a.style.backgroundColor="";if(!d&&a.id===b)a.removeAttribute("id");else{a.id=b;if("cfg"===c)Bf(a);else if(f.attachPanel&&(a.style.backgroundColor=getComputedStyle(m.body).getPropertyValue("background-color")),"hid"===c&&(ke(),Cf(a)),"fav"===c)jc(),Df(a);f.animation&&(a.className="de-content de-cfg-open")}}function sa(a,b){for(var c=
b.length;c--;)(m.querySelector(b[c])||{}).disabled=!a}function mc(){sa(1===f.updThread,['input[info="updThrDelay"]','input[info="favIcoBlink"]','input[info="desktNotif"]']);sa(f.preLoadImgs,['input[info="findImgFile"]']);sa(f.openImgs,['input[info="openGIFs"]']);sa(f.linksNavig,['input[info="linksOver"]','input[info="linksOut"]','input[info="markViewed"]','input[info="strikeHidd"]','input[info="noNavigHidd"]']);sa(f.addYouTube&&4!==f.addYouTube,['select[info="YTubeType"]','input[info="YTubeHD"]']);
sa(f.addYouTube,['input[info="YTubeWidth"]','input[info="YTubeHeigh"]','input[info="YTubeTitles"]']);sa(2===f.ajaxReply,['input[info="postSameImg"]','input[info="removeEXIF"]','input[info="removeFName"]']);sa(f.addTextBtns,['input[info="txtBtnsLoc"]']);sa(f.updScript,['select[info="scrUpdIntrv"]'])}function z(a,b,c){var d=s("input",{info:a,type:"checkbox"},{click:function(){vb(this.getAttribute("info"));mc();c&&c(this)}});d.checked=f[a];return v("label",b?{"class":"de-block"}:l,[d,S(" "+ha[a][h])])}
function ja(a,b,c){return s("input",{info:a,type:"text",size:b,value:f[a]},{keyup:c?c:function(){Q(this.getAttribute("info"),this.value)}})}function da(a,b,c){for(var d=0,j=ha[a],e=j.q[h].length,o="";d<e;d++)o+='<option value="'+d+'">'+j.q[h][d]+"</option>";(c=P(D('<select info="'+a+'">'+o+"</select>"),{change:c?c:function(){Q(this.getAttribute("info"),this.selectedIndex);mc()}})).selectedIndex=f[a];return v("label",b?{"class":"de-block"}:l,[c,S(" "+j.t[h])])}function Ma(a){return v("div",{"class":e.u+
" de-cfg-tab-back",selected:n},[s("div",{"class":"de-cfg-tab",text:Kc[a][h],info:a},{click:function(){var a,c;c=this.parentNode;if("true"!==c.getAttribute("selected")){if(a=t("de-cfg-body",m))a.className="de-cfg-unvis",m.querySelector('.de-cfg-tab-back[selected="true"]').setAttribute("selected",n);c.setAttribute("selected",i);if(!(a=p("de-cfg-"+(c=this.getAttribute("info")))))L(p("de-cfg-bar"),a="posts"===c?Ef():"links"===c?Ff():"form"===c?Gf():"common"===c?Hf():If());a.className="de-cfg-body";"filters"===
c&&(E.update(),p("de-spell-edit").value=E.list);mc()}}})])}function nc(){var a=this.scrollTop,b=p("de-spell-rowmeter"),c=b.Lc||1,d="",j=19;if(c-j<a/12|1){for(;j--;)d+=c++ +"<br>";b.insertAdjacentHTML("beforeend",d);b.Lc=c}b.scrollTop=a}function Jf(){return v("div",{"class":"de-cfg-unvis",id:"de-cfg-filters"},[z("hideBySpell",n,oc),v("div",{id:"de-spell-panel"},[s("a",{text:Lc[h],href:"#","class":"de-abtn",onmouseout:"de_delSelection(event)"},{click:A,mouseover:Kf}),s("a",{text:Mc[h],href:"#","class":"de-abtn"},
{click:function(a){A(a);Q("hideBySpell",1);m.querySelector('input[info="hideBySpell"]').checked=i;oc()}}),s("a",{text:kb[h],href:"#","class":"de-abtn"},{click:function(a){A(a);p("de-spell-edit").value="";oc()}}),D('<a href="https://github.com/SthephanShinkufag/Dollchan-Extension-Tools/wiki/Spells-'+(h?"en":"ru")+'" class="de-abtn" target="_blank">'+Nc[h]+"</a>")]),v("div",{id:"de-spell-div"},[D('<div><div id="de-spell-rowmeter"></div></div>'),v("div",l,[s("textarea",{id:"de-spell-edit",wrap:"off"},
{keydown:nc,scroll:nc})])]),z("menuHiddBtn",i,l),z("hideRefPsts",i,l),z("delHiddPost",i,function(){B(T("de-post-hid",w),function(a){J(e.Ba(a))});ia()})])}function Ef(){return v("div",{"class":"de-cfg-unvis",id:"de-cfg-posts"},[da("updThread",n,l),v("label",l,[ja("updThrDelay",4,l),S(ha.updThrDelay[h])]),v("div",{"class":"de-cfg-depend"},[G(!k.m,z("favIcoBlink",i,l)),G(k.m,z("desktNotif",i,function(){f.desktNotif&&window.webkitNotifications.requestPermission()}))]),da("expandPosts",i,l),da("expandImgs",
i,l),G(k.fa,z("preLoadImgs",i,l)),G(k.fa,v("div",{"class":"de-cfg-depend"},[z("findImgFile",i,l)])),v("div",l,[z("openImgs",n,l),S(" ("),z("openGIFs",n,l),S(")*")]),z("postBtnsTxt",i,l),z("imgSrcBtns",i,l),z("noSpoilers",i,ia),z("noPostNames",i,ia),z("noPostScrl",i,ia),v("div",l,[z("keybNavig",n,l),s("a",{text:"?",href:"#","class":"de-abtn"},{click:function(a){A(a);I(Oc[h],"help-keybnavig",n)}})]),z("correctTime",i,za.cd),v("div",{"class":"de-cfg-depend"},[v("div",l,[ja("timeOffset",3,l),S(ha.timeOffset[h])]),
v("div",l,[ja("timePattern",30,l),S(" "),s("a",{text:ha.timePattern[h],href:"#","class":"de-abtn"},{click:function(a){A(a);I('"s" - second (one digit),\n"i" - minute (one digit),\n"h" - hour (one digit),\n"d" - day (one digit),\n"w" - week (string)\n"n" - month (one digit),\n"m" - month (string),\n"y" - year (one digit),\n"-" - any symbol\n"+" - any symbol except digits\n"?" - previous char may not be\n\nExamples:\n0chan.ru: "w+yyyy+m+dd+hh+ii+ss"\niichan.ru, 2ch.so: "w+dd+m+yyyy+hh+ii+ss"\ndobrochan.ru: "dd+m+?+?+?+?+?+yyyy++w++hh+ii-?s?s?"\n410chan.org: "dd+nn+yyyy++w++hh+ii+ss"\n4chan.org: "nn+dd+yy+w+hh+ii-?s?s?"\n4chon.net: "nn+dd+yy++w++hh+ii+ss"\nkrautchan.net: "yyyy+nn+dd+hh+ii+ss+--?-?-?-?-?"',
"help-correcttime",n)}})])])])}function Ff(){return v("div",{"class":"de-cfg-unvis",id:"de-cfg-links"},[da("linksNavig",i,l),v("div",{"class":"de-cfg-depend"},[v("div",l,[ja("linksOver",6,function(){Q("linksOver",+this.value|0)}),S(ha.linksOver[h])]),v("div",l,[ja("linksOut",6,function(){Q("linksOut",+this.value|0)}),S(ha.linksOut[h])]),z("markViewed",i,l),z("strikeHidd",i,l),z("noNavigHidd",i,l)]),z("crossLinks",i,l),z("insertNum",i,l),z("addMP3",i,l),z("addImgs",i,l),da("addYouTube",i,l),v("div",
{"class":"de-cfg-depend"},[v("div",l,[da("YTubeType",n,l),ja("YTubeWidth",6,l),S("\u00d7"),ja("YTubeHeigh",6,l),S(" "),z("YTubeHD",n,l)]),G(!(k.e&&12>k.e),z("YTubeTitles",n,l))])])}function Gf(){return v("div",{"class":"de-cfg-unvis",id:"de-cfg-form"},[da("ajaxReply",i,l),G(k.fa&&!k.xa,v("div",{"class":"de-cfg-depend"},[z("postSameImg",i,l),z("removeEXIF",i,l),z("removeFName",i,l)])),G(g.form,da("addPostForm",i,l)),G(g.form,z("noThrdForm",i,function(){q||(p("de-parea").style.display=f.noThrdForm?
"none":"")})),z("favOnReply",i,l),G(g.Q,v("div",l,[z("addSageBtn",n,l),z("saveSage",n,l)])),G(g.nb,z("warnSubjTrip",n,l)),da("captchaLang",i,l),G(g.form,v("div",l,[da("addTextBtns",n,function(){Q("addTextBtns",this.selectedIndex);pc()}),z("txtBtnsLoc",n,pc)])),G(g.X,v("div",l,[ja("passwValue",20,xe),S(ha.userPassw[h])])),G(g.name,v("div",l,[ja("nameValue",20,qc),z("userName",n,qc)])),G(g.g,v("div",l,[ja("signatValue",20,l),z("userSignat",n,l)])),v("div",l,[G(g.form||ba,S(Pc[h])),z("noBoardRule",n,
ia),G(g.Ca,z("noGoto",n,function(){J(g.Ca)})),G(g.X,z("noPassword",n,function(){J(g.X.parentNode.parentNode)}))])])}function Hf(){return v("div",{"class":"de-cfg-unvis",id:"de-cfg-common"},[G(k.Ea,v("div",l,[S(ha.excludeList[h]),s("textarea",{value:Fa("DESU_Exclude")||"",rows:6,cols:50},{keyup:function(){fa("DESU_Exclude",this.value)}})])),da("scriptStyle",i,function(){Q("scriptStyle",this.selectedIndex);p("de-main").lang=re()}),z("attachPanel",i,function(){ra("cfg",n);ia()}),z("panelCounter",i,ia),
z("rePageTitle",i,l),G(k.La,z("animation",i,l)),z("closePopups",i,l),G(!k.e,v("div",l,[z("updScript",i,l),v("div",{"class":"de-cfg-depend"},[da("scrUpdIntrv",i,l),Y(Qc[h],"",function(){var a=p("de-cfg-updresult");a.innerHTML='<span class="de-wait">'+Sb[h]+"</div>";ye(i,function(b){a.innerHTML=b})})]),s("div",{id:"de-cfg-updresult"},l)]))])}function If(){return v("div",{"class":"de-cfg-unvis",id:"de-cfg-info"},[D('<span style="width: 179px;"><b>'+Rc[h]+yb+"</b><br><br>"+Sc[h]+f.stats.view+"<br>"+Tc[h]+
f.stats.op+"<br>"+Uc[h]+f.stats.reply+"</span>"),D('<span style="padding-left: 7px; border-left: 1px solid grey;">'+qb.join("<br>")+"</span>"),D('<span><a href="//www.freedollchan.org/scripts/" target="_blank">Freedollchan</a>&nbsp;<a href="//github.com/SthephanShinkufag/Dollchan-Extension-Tools/wiki/'+(h?"home-en/":"")+'" target="_blank">Github</a></span>'),U(Y(Vc[h],Tb[h],function(){var a,b={};for(a in f)f[a]!==zb[a]&&"nameValue"!==a&&"passwValue"!==a&&"signatValue"!==a&&(b[a]=f[a]);I(Tb[h]+':<textarea readonly class="de-editor">'+
ic({version:yb,location:""+window.location,nav:k,cfg:b,spells:E.list.split("\n"),cSpells:Fa("DESU_CSpells_"+e.c),oSpells:sessionStorage["de-spells-"+x+q],perf:qb},"")+"</textarea>","help-debug",n)}),{style:"float: right;"})])}function rc(a,b,c){return Y(Wc[h],Xc[h],function(){I("","edit-"+a,n);ea(t("de-alert-msg",p("de-alert-edit-"+a)),[S(Yc[a][h]),s("textarea",{"class":"de-editor",value:ic(b,"")},l),Y(lb[h],Zc[h],function(){try{c(),window.location.reload()}catch(a){I($c[h],"err-invaliddata",n)}})])})}
function Bf(a){a.appendChild(v("div",{"class":e.u},[s("div",{id:"de-cfg-head",text:"Dollchan Extension Tools"},l),v("div",{id:"de-cfg-bar"},[Ma("filters"),Ma("posts"),Ma("links"),Ma("form"),Ma("common"),Ma("info")]),Jf(),v("div",{id:"de-cfg-btns"},[da("language",n,function(){Q("language",h=this.selectedIndex);r(p("de-main"));r(p("de-css"));r(p("de-css-dynamic"));ze();qe();ra("cfg",n)}),v("div",{style:"float: right;"},[G(k.Ea,Y(ad[h],bd[h],function(){(Z.global&&!pa(Z.global)?Z.global:ie())?(ya(e.c,
l),window.location.reload()):I(cd[h],"err-noglobalcfg",n)})),G(k.Ea,Y(lb[h],dd[h],function(){var a,c={},d=Z[e.c];for(a in d)d[a]!==zb[a]&&"stats"!==a&&(c[a]=d[a]);ya("global",c);ra("cfg",i)})),rc("cfg",f,function(){ya(e.c,JSON.parse(N("textarea",p("de-alert-edit-cfg")).value.trim().replace(/[\n\r\t]/g,"")))}),Y(ed[h],fd[h],function(){confirm(gd[h])&&(tb("DESU_Config"),tb("DESU_Favorites"),tb("DESU_Threads"),fa("DESU_Spells_"+e.c,'[1,85765385,"#wipe(samelines,samewords,longwords,numbers)"]'),window.location.reload())})]),
s("div",{style:"clear: both;"},l)])]));t("de-cfg-tab",a).click();p("de-spell-edit").setSelectionRange(0,0);nc()}function Ae(a,b){return a.appendChild(v("div",{"class":"de-content-block"},[s("input",{type:"checkbox"},{click:function(){var a=this.checked;B(this.parentNode.querySelectorAll(".de-entry > div > input"),function(b){b.checked=a});a=l}}),s("b",{text:b},l)]))}function Cf(a){var b,c,d,j=$[e.c];B(T("de-post-hid",w),function(b){if(!b.p){var c=b.cloneNode(i);c.removeAttribute("id");c.style.display=
"";c.h=i;c.Rc=b;c.za=c.querySelector(".de-btn-hide, .de-btn-hide-user");c.za.parentNode.className="de-ppanel";c.za.onmouseover=c.za.onmouseout=l;c.za.onclick=function(){var a=ca(this);ab(a,a.h=!a.h)};(d||(d=a.appendChild(D('<div class="de-content-block"><b>'+hd[h]+":</b></div>")))).appendChild(v("div",{"class":"de-entry"},[c]))}});d?ea(a,[Y(Ub[h],"",function(){B(this.parentNode.querySelectorAll(".de-entry > [de-post]"),function(a){ab(a,a.h=!a.h)});this.value=this.value===Vb[h]?Ub[h]:Vb[h]}),Y(lb[h],
"",function(){B(this.parentNode.querySelectorAll(".de-entry > [de-post]"),function(a){a.h||Na(a.Rc,n)});Ka()})]):a.appendChild(s("b",{text:id[h]},l));ea(a,[m.createElement("hr"),s("b",{text:pa(j)?jd[h]:kd[h]+":"},l)]);if(!pa(j))for(b in j)for(c in d=Ae(a,"/"+b),j[b])d.appendChild(D('<div class="de-entry" info="'+b+";"+c+'"><div class="'+e.u+'"><input type="checkbox"/><a href="'+e.J(b,c)+'" target="_blank">№'+c+"</a> - "+j[b][c]+"</div></div>"));ea(a,[m.createElement("hr"),rc("hidden",$[e.c],
function(){$[e.c]=JSON.parse(N("textarea",p("de-alert-edit-hidden")).value.trim().replace(/[\n\r\t]/g,""));fa("DESU_Threads",JSON.stringify($))}),Y(Wb[h],Xb[h],function(){B(this.parentNode.querySelectorAll(".de-entry[info]"),function(a){var b=a.getAttribute("info").split(";");N("input",a).checked&&(H[b[1]]?Na(H[b[1]],n):(delete $[e.c][b[0]][b[1]],le(b[0])))});me();Ka()})])}function Df(a){var b,c,d,j;for(b in F)for(c in F[b])for(d in j=Ae(a,b+"/"+c),F[b][c])F[b][c][d].url||(F[b][c][d].url=sb(c)+(/(?:^|\.)krautchan\.net$/.test(b)?
"thread-":"res/")+d+(/(?:^|\.)(?:dobrochan\.(?:ru|org)|tenhou\.ru)$/.test(b)?".xhtml":/(?:^|\.)420chan\.org$/.test(b)?".php":/(?:^|\.)2chan\.net$/.test(b)?".htm":".html")),j.appendChild(v("div",{"class":"de-entry",info:b+";"+c+";"+d},[v("div",{"class":e.u},[D('<input type="checkbox"/>'),s("span",{"class":"de-btn-expthr"},{click:Lf}),D('<a href="//'+b+F[b][c][d].url+'">№'+d+"</a>"),D('<span class="de-fav-title"> - '+F[b][c][d].txt+"</span>"),D('<span class="de-fav-inf-page"></span>'),D('<span class="de-fav-inf-posts">[<span class="de-fav-inf-old">'+
F[b][c][d].cnt+"</span>]</span>")])]));j||a.appendChild(s("b",{text:ld[h]},l));ea(a,[m.createElement("hr"),rc("favor",F,function(){F=JSON.parse(N("textarea",p("de-alert-edit-favor")).value.trim().replace(/\\\n|[\n\r\t]/g,""));fa("DESU_Favorites",JSON.stringify(F))}),Y(md[h],nd[h],function(){B(T("de-entry",m),function(a){var b,c=a.getAttribute("info").split(";"),d=F[c[0]][c[1]][c[2]];c[0]===e.host&&(b=U(t("de-fav-inf-posts",a).firstElementChild,{"class":"de-wait",text:""}),Ba(l,c[1],c[2],i,function(a,
c,j){a=j?j:a.length+1;b.textContent=a;!j&&a>d.Db?(b.className="de-fav-inf-new",d.Db=a,fa("DESU_Favorites",JSON.stringify(F))):b.className="de-fav-inf-old";b=d=l}))})}),Y(Yb[h],od[h],function(){var a=6,b=0;for(I(wa[h],"load-pages",i);a--;)Be(m.createElement("div"),a,function(a,c){B(T("de-entry",m),function(d){var j=d.getAttribute("info").split(";");j[0]!==e.host||j[1]!==x||(d=t("de-fav-inf-page",d),RegExp("(?:№|No.|>)\\s*"+j[2]+"\\s*<").test(a.innerHTML)?d.innerHTML="@"+c:5===b&&!d.textContent.contains("@")&&
(d.innerHTML="@?"))});5===b&&ka(p("de-alert-load-pages"));b++;a=c=l})}),Y(kb[h],pd[h],function(){B(T("de-entry",m),function(a){var b=a.getAttribute("info").split(";");k.e&&b[0]!==e.host||Ba("//"+b[0]+F[b[0]][b[1]][b[2]].url,l,l,n,function(a,c,d){d&&(kc(b[0],b[1],b[2]),wb(JSON.stringify(F)));b=l})})}),Y(Wb[h],Xb[h],function(){B(T("de-entry",m),function(a){var b=a.getAttribute("info").split(";");N("input",a).checked&&kc(b[0],b[1],b[2])});wb(JSON.stringify(F))})])}function ka(a){a&&(a.Cb=l,f.animation?
(k.aa(a,r),k.s(a,"de-close")):r(a))}function I(a,b,c){var d=p("de-alert-"+b),j="de-alert-msg"+(c?" de-wait":""),C=c?"":"\u00d7 ";d?(U(N("div",d),{"class":j}).innerHTML=a.trim(),N("span",d).textContent=C,clearTimeout(d.Cb),f.animation&&(k.aa(d,function(a){k.Y(a,"de-blink")}),k.s(d,"de-blink"))):(d=p("de-alert").appendChild(v("div",{"class":e.u,id:"de-alert-"+b},[s("span",{"class":"de-alert-btn",text:C},{click:function(){ka(this.parentNode)}}),D('<div class="'+j+'">'+a.trim()+"</div>")])),f.animation&&
(k.aa(d,function(a){k.Y(a,"de-open")}),k.s(d,"de-open")));f.closePopups&&!c&&!b.contains("help")&&(d.Cb=setTimeout(ka,4E3,d))}function Oa(a,b,c){var d,j=ca(a);f.attachPanel&&b?(d="fixed",b="de-btn-refresh"===a.id||"de-btn-audio-off"===a.id?"bottom: 25":"top: "+(a.getBoundingClientRect().top+a.offsetHeight-(k.a?0.5:0))):(d="absolute",b="top: "+(oa(a).top+a.offsetHeight-(k.a?0.5:0)));a=m.body.appendChild(P(D('<div class="'+e.u+'" id="de-menu" style="position: '+d+"; "+("de-btn-src"===a.className?"left: "+
oa(a).left:"right: "+(m.documentElement.clientWidth-oa(a).left-a.offsetWidth))+"px; "+b+'px;" onmouseout="de_delSelection(event)">'+("string"===typeof c?c:"")+"</div>"),{mouseover:function(){j&&bb(j,n)}}));return"string"===typeof c?p("de-menu").querySelectorAll("span"):a}function Kf(a){B(Oa(a.target,i,'<div style="display: inline-block; border-right: 1px solid grey;"><span>'+"#words,#exp,#exph,#imgn,#ihash,#subj,#name,#trip,#img".split(",").join("</span><span>")+'</span></div><div style="display: inline-block;"><span>'+
"#sage,#op,#tlen,#all,#video,#num,#wipe,#rep,#outrep".split(",").join("</span><span>")+"</span></div>"),function(a){a.onclick=function(){var a=this.textContent;Va(p("de-spell-edit"),a+(q&&"#op"!==a&&"#rep"!==a&&"#outrep"!==a?"["+x+","+q+"]":"")+(E.Jc(a.substr(1))?"(":""))}})}function Mf(a){if(f.menuHiddBtn){var b,c=Oa(a.G.firstChild,n,this.kd),d=function(a,b){var d=D("<span>"+qd[a][h]+"</span>");d.onclick=b;c.appendChild(d)};!a.h&&(Pa=fc().trim())&&d("sel",function(){Ga("#words","("+Pa+")")});(b=
t("postertrip",a))&&d("trip",function(){Ga("#trip","("+b.textContent.replace(/\)/g,"\\)")+")")});a.P[0]?(d("img",function(){Ga("#img","(="+ge(a)+"@"+hc(a).join("x")+")")}),d("ihash",function(){Ga("#ihash","("+Ce(a)+")")})):d("noimg",function(){Ga("(#all"," & !#img)")});qa(a)?d("text",function(){Nf(a)}):d("notext",function(){Ga("(#all"," & !#tlen)")});c=l}}function Of(a){B(Oa(t("de-btn-expthr",a.G),n,"<span>"+rd[h].join("</span><span>")+"</span>"),function(b){b.onclick=function(){cb(a,parseInt(this.textContent,
10),l)}})}function zf(){B(Oa(p("de-btn-refresh"),i,"<span>"+sd[h].join("</span><span>")+"</span>"),function(a){a.onclick=function(){De(na.indexOf.call(this.parentNode.children,this)+1)}})}function Af(){"de-btn-audio-off"===this.id&&B(Oa(p("de-btn-audio-off"),i,"<span>"+td[h].join("</span><span>")+"</span>"),function(a){a.onclick=function(){var a=na.indexOf.call(this.parentNode.children,this);Ra=0===a?3E4:1===a?6E4:2===a?12E4:3E5;ve();p("de-btn-audio-off").id="de-btn-audio-on";r(this.parentNode)}})}
function Pf(a){var b=a.nextSibling.href+'" target="_blank">'+ud[h],c=m.body.getAttribute("de-image-search"),d="";c&&(c=c.split(";"),c.forEach(function(a){a=a.split(",");d+='<a class="de-src'+a[0]+(!a[1]?'" onclick="de_cImgSearch(event, \''+a[0]+'\')" de-url="':'" href="'+a[1])+b+a[0]+"</a>"}));Oa(a,n,'<a class="de-src-iqdb" href="//iqdb.org/?url='+b+'IQDB</a><a class="de-src-tineye" href="//tineye.com/search/?url='+b+'TinEye</a><a class="de-src-google" href="//google.ru/searchbyimage?image_url='+
b+'Google</a><a class="de-src-saucenao" href="//saucenao.com/search.php?url='+b+"SauceNAO</a>"+d);d=l}function Qf(){function a(){try{d=c(y,0>=d?0:d-1,-1,i,n),o=i}catch(a){}}function b(){if(d!==y.length-1)try{d=c(y,d+1,1,y[d+1].p||y[d+1].getBoundingClientRect().top>window.innerHeight/2-y[d+1].clientHeight/2,n),o=i}catch(a){}}function c(a,b,c,d,j){for(var e=b;a[e].h||a[e].M.h;)e+=c;a=a[e];if(e!==b||d)window.scrollTo(0,j?oa(a).top:oa(a).top-window.innerHeight/2+a.clientHeight/2);(b=t("de-selected",m))&&
k.Y(b,"de-selected");a.p&&(a=a.M);k.s(a,"de-selected");return e}var d,j=0,C=n,o=i,u=i;window.onscroll=function(){C?C=n:u=o=i};m.addEventListener("keydown",function(f){var h=f.target.tagName,g=f.keyCode;if("TEXTAREA"===h||"INPUT"===h&&"text"===f.target.type)27===g&&f.target.blur();else if(f.ctrlKey)q?37===g&&(window.location.pathname=e.ca(x,0)):37===g?window.location.pathname=e.ca(x,Ya-1):39===g&&(window.location.pathname=e.ca(x,Ya+1));else if(!f.altKey&&!(f.shiftKey||74!==g&&75!==g&&77!==g&&78!==
g&&86!==g&&116!==g))if(116===g)q||(A(f),De(1));else{A(f);f.stopPropagation();if(u){if(o)a:{for(var f=y,h=0,m=window.pageYOffset;h<f.length;h++)if(oa(f[h]).top>m){f=h-1;break a}f=ta}else f=y.indexOf(ga[j]);d=f}if(!q&&o)if((y[d]||{}).p)j=h=ga.indexOf(y[d]);else if(u){for(h=0>=d?0:d;0<h&&!y[h].p;h--);j=h=ga.indexOf(y[h])}else h=j;else h=j;o=u=n;if(86===g)q?sc(y[d]):k.a?GM_openInTab("//"+e.host+e.J(x,ga[h].b),n,i):window.open("//"+e.host+e.J(x,ga[h].b),"_blank");else if(C=i,75===g)if(q)a();else try{j=
c(ga,0>=j?0:j-1,-1,i,i),u=i}catch(p){}else if(74===g)if(q)b();else{if(j!==ga.length-1)try{j=c(ga,j+1,1,i,i),u=i}catch(s){}}else!q&&77===g?a():!q&&78===g&&b()}},i)}function Ee(a,b){if(e.H||e.Ja)return a.replace(/\?[^?]+$|$/,(e.ja?"?board="+x+"&":"?")+Math.random());0<b&&(a=a.replace(/mainpage|res\d+/ig,"res"+b));return a.replace(/dummy=[\d\.]*/,"dummy="+Math.random())}function db(a){var b=g.T?p("recaptcha_image")||g.T:N("img",g.V(g.k));e.j||g.T?(a=m.createEvent("MouseEvents"),a.initEvent("click",i,
i),b.dispatchEvent(a)):(a=Ee(b.getAttribute("src"),a),b.src="",b.src=a)}function Fe(){var a=f.sageReply;p("de-sagebtn").innerHTML="&nbsp;"+(a?'<span class="de-btn-sage"></span><b style="color: red;">SAGE</b>':"<i>(no&nbsp;sage)</i>");"text"===g.Q.type?g.Q.value=a?"sage":e.d?"noko":"":g.Q.checked=a}function qc(){var a=m.querySelector('input[info="nameValue"]');a&&Q("nameValue",a.value);g.name.value=f.userName?f.nameValue:""}function xe(){var a=m.querySelector('input[info="passwValue"]');a&&Q("passwValue",
a.value);(g.Ac||{}).value=g.X.value=f.passwValue}function Rf(){function a(){bc(m.body,{mousemove:b,mouseup:a});Q("textaWidth",parseInt(g.g.style.width,10));Q("textaHeight",parseInt(g.g.style.height,10))}function b(a){var b=oa(g.g);g.g.style.width=a.pageX-b.left+"px";g.g.style.height=a.pageY-b.top+"px"}L(g.g,s("div",{id:"de-txt-resizer"},{mousedown:function(c){A(c);P(m.body,{mousemove:b,mouseup:a})}}))}function tc(a){B(a.querySelectorAll('input[type="file"]'),function(a){P(a,{change:Ge})})}function He(a){B(a.querySelectorAll(".de-file-util"),
r);B(a.querySelectorAll('input[type="file"]'),function(a){a.da=l})}function Ge(){this.Dc?this.da&&(this.da=l,r(this.nextSibling)):(this.Dc=i,L(this,s("button",{"class":"de-file-util de-file-del",text:kb[h],type:"button"},{click:function(a){A(a);a=this.parentNode;He(a);P(g.file=nb('input[type="file"]',de(a,a.innerHTML)),{change:Ge})}})));r(t("de-file-rar",this.parentNode));tc(g.V(this));k.fa&&/^image\/(?:png|jpeg)$/.test(this.files[0].type)&&L(this,s("button",{"class":"de-file-util de-file-rar",text:xd[h],
title:yd[h],type:"button"},{click:function(a){A(a);var a=p("de-file-rar")||m.body.appendChild(s("input",{id:"de-file-rar",type:"file",style:"display: none;"},l)),b=this.parentNode.querySelector('input[type="file"]'),c=this;a.onchange=function(){r(c);var a=this.files[0],j=new FileReader,e=D('<span class="de-file-util" style="margin: 0 5px;"><span class="de-wait"></span>'+zd[h]+"</span>");L(b,e);j.onload=function(){if(b.nextSibling===e){U(e,{style:"font-weight: bold; margin: 0 5px; cursor: default;",
title:b.files[0].name+" + "+a.name,text:b.files[0].name.replace(/^.+\./,"")+" + "+a.name.replace(/^.+\./,"")});b.da=this.result}e=b=a=l};j.readAsArrayBuffer(a);c=l};a.click()}}))}function Ie(){var a,b;g.T?(U(g.ta,{onclick:"Recaptcha.focus_response_field = function() {}"}),(a=p("recaptcha_image"))&&U(a,{onclick:"Recaptcha.reload()",style:"width: 300px; cursor: pointer;"})):e.O&&Je();if(g.k&&(e.O&&setTimeout(function(){db(0);g.k.onclick=l},50),g.k.autocomplete="off",g.k.onfocus=l,g.k.onkeypress=function(){return function(a){if(f.captchaLang&&
a.which!==0){var b,j=a.charCode||a.keyCode,e=String.fromCharCode(j).toLowerCase();if(f.captchaLang===1){if(j<1040||j>1279||(b="йцукенгшщзхъфывапролджэячсмитьбюё".indexOf(e))===-1)return;e="qwertyuiop[]asdfghjkl;'zxcvbnm,.`"[b]}else{if(j<33||j>122||(b="qwertyuiop[]asdfghjkl;'zxcvbnm,.`".indexOf(e))===-1)return;e="йцукенгшщзхъфывапролджэячсмитьбюё"[b]}A(a);
Va(a.target,e)}}}(),!e.j&&!g.T)){a=nb("a, img",g.V(g.k));b=s("img",{alt:wa[h],title:Ad[h],style:"display: block; border: none; cursor: pointer;"},{click:function(){db(q||0)}});if(a)a.parentNode.replaceChild(b,a);else{for(;g.k.nextSibling;)r(g.k.nextSibling);L(g.k,b)}setTimeout(function(b){b.src=Ee(e.ja?"/faptcha.php?board="+x:e.Ob?"/securimage/securimage_show.php?"+Math.random():e.H?"/"+x.substr(0,x.indexOf("/")+1)+"captcha.php?"+Math.random():a?a.src:"/"+x+"/captcha.pl?key=mainpage&amp;dummy="+Math.random(),
q||0)},50,b)}}function Je(){var a=p("captcha_div");(k.a?unsafeWindow:window).cc||m.head.appendChild(s("script",{type:"text/javascript",src:"http://www.google.com/recaptcha/api/js/recaptcha_ajax.js"},l));a.innerHTML="";a.appendChild(s("a",{href:"#",text:Bd[h]},{click:function(a){A(a);this.parentNode.innerHTML="";(k.a?unsafeWindow:window).cc.create("6LdOEMMSAAAAAIGhmYodlkflEb2C-xgPjyATLnxx","captcha_div",{theme:"red"});var c=setInterval(function(){var a=p("recaptcha_response_field");a&&(g.k=g.T=a,Ie(),
clearInterval(c),c=l)},500)}}))}function Ke(a,b,c){g.form.style.display="inline-block";g.form.style.textAlign="left";k.a?P(g.g,{mouseup:function(){Q("textaWidth",parseInt(this.style.width,10));Q("textaHeight",parseInt(this.style.height,10))}}):Rf();pc();g.g.style.cssText="padding: 0; width: "+f.textaWidth+"px; height: "+f.textaHeight+"px;";P(g.g,{keypress:function(a){var b=a.charCode||a.keyCode;if((33===b||34===b)&&0===a.which)a.target.blur(),window.focus()}});P(g.ta,{click:function(a){var b=g.g.value,
c=f.signatValue;if(f.warnSubjTrip&&g.nb&&/#.|##./.test(g.nb.value))A(a),I(Cd[h],"upload",n);else{E.Mb&&(b=E.Oc(b));f.userSignat&&c&&(b+="\n"+c);if(g.A&&"Dollchan Extension Tools"===(t("filetitle",H[g.A])||{}).textContent&&!/`\-{50}`$/.test(b))b+="\n\n`--------------------------------------------------`\n`"+window.navigator.userAgent+"`\n`v"+yb+"`\n`--------------------------------------------------`";g.g.value=b;f.ajaxReply&&I(Sb[h],"upload",i);f.favOnReply&&g.A&&oe(H[g.A],t("de-btn-fav",H[g.A].G));
if(g.wa&&(b=g.wa.value)&&(b=b.match(Ab())))g.wa.value=e.W?b[1]:"http://www.youtube.com/watch?v="+b[1];g.K&&(J(p("de-qarea")),L(p("de-togglereply"),p("de-pform")))}}});B(g.form.querySelectorAll('input[type="text"], input[type="file"]'),function(a){a.size=30});f.noGoto&&g.Ca&&J(g.Ca);f.noPassword&&g.X&&J(g.V(g.X));P(window,{load:function(){f.userName&&g.name&&setTimeout(qc,1E3);g.X&&setTimeout(xe,1E3)}});Ie();f.addSageBtn&&g.Q&&(a=s("span",{id:"de-sagebtn"},{click:function(a){a.stopPropagation();A(a);
vb("sageReply");Fe()}}),c=W("ancestor::label",g.Q)||g.Q,c.nextElementSibling||c.previousElementSibling?(J(c),L(c,a)):(J(g.V(g.Q)),L(g.name||g.ta,a)),setTimeout(Fe,0));if(2===f.ajaxReply){if(g.form.onsubmit=function(a){A(a);Le(g.form,g.ta,Me)},w.onsubmit=A,a=w.querySelector(e.Tc))a.onclick=function(a){A(a);Ha();I(Zb[h],"deleting",i);Le(w,this,Ne)}}else 1===f.ajaxReply&&(ea(p("de-main"),[D('<iframe id="de-iframe-pform" name="de-iframe-pform" src="about:blank"/>'),D('<iframe id="de-iframe-dform" name="de-iframe-dform" src="about:blank"/>')]),
U(g.form,{target:"de-iframe-pform"}).onsubmit=l,U(w,{target:"de-iframe-dform"}).onsubmit=function(){Ha();I(Zb[h],"deleting",i)});g.file&&tc(g.V(g.file))}function Oe(a,b){var c="",d=a.querySelector(e.Ga);if(a.body.firstChild&&!d){B(a.querySelectorAll(e.j?".post-error, h2":e.H?'h1, h2, div[style*="1.25em"]':e.d?"#errmsg":e.f?".message_text":e.n?"pre":'h1, h2, font[size="5"]'),function(a){c+=a.innerHTML+"\n"});if(!(c=c.replace(/<a [^>]+>Назад.+|<br.+/,"")))c=mb[h]+"\n"+a.body.innerHTML;
c=/successful|uploaded|updating|обновл|удален[о\.]/i.test(c)?"":c.replace(/"/g,"'")}return[b?window.location:d?e.J(x,e.Aa(d)):"",c]}function Pe(){ka(p("de-alert-upload"));q&&pb(y[y.length-1])}function Me(a){var b;(b=a[1])?(g.K&&(J(a=p("de-qarea")),a.appendChild(p("de-pform"))),g.k&&/captch|капч|подтвер/i.test(b)&&(g.k.value="",g.k.focus(),db(g.A)),I(b,"upload",n)):(g.g.value="",
g.file&&(He(b=g.V(g.file)),g.file=nb('input[type="file"]',b=de(b,b.innerHTML)),tc(b)),g.wa&&(g.wa.value=""),f.stats[g.A?"reply":"op"]++,ya(e.c,f),g.A)?(Ha(),q?Bb(Pe):cb(H[g.A],5,Pe),g.k&&(g.k.value="",db(g.A),e.O&&GM_xmlhttpRequest({method:"GET",url:"/makaba/captcha?code="+(he("usercode")||""),onload:function(a){a=a.responseText;if(a.contains("OK")||a.contains("VIP")){g.k=g.T=l;Je()}}}))):window.location=a[0]}function Qe(){var a=p("de-alert-deleting");a&&(ka(a),I(Dd[h],"deleted",n))}function Ne(a){var b=
[];a[1]?I(Ed[h]+a[1],"deleting",n):(B(w.querySelectorAll("[de-post] input:checked"),!q?function(a){a=ca(a).M.b;-1===b.indexOf(a)&&b.push(a)}:function(a){a.checked=n}),q?Bb(Qe):b.forEach(function(a){cb(H[a],5,Qe)}));b=l}function Le(a,b,c){R={Ya:"---------------------------"+Math.round(1E11*Math.random()),data:[],Za:0,error:n,url:a.action,ab:c};B(a.querySelectorAll('input:not([type="submit"]):not([type="button"]), textarea, select'),Re);Re(b);Se()}function Re(a){var b,c,d,j;j="--"+R.Ya+'\r\nContent-Disposition: form-data; name="'+
a.name+'"';"file"===a.type&&0<a.files.length?(b=a.files[0],c=b.name,R.data.push(j+'; filename="'+(!f.removeFName?c:" "+c.substring(c.lastIndexOf(".")))+'"\r\nContent-type: '+b.type+"\r\n\r\n",l,"\r\n"),d=R.data.length-2,/^image\/(?:png|jpeg)$/.test(b.type)?(j=new FileReader,j.onload=function(b){(b=Sf(new Uint8Array(b.target.result),!!a.da))?(a.da&&b.push(a.da),f.postSameImg&&b.push(""+Math.round(1E6*Math.random())),R.data[d]=new Blob(b),R.Za--,Se()):(R.error=i,I(Fd[h]+c,"upload",n))},j.readAsArrayBuffer(b),
R.Za++):R.data[d]=b):("checkbox"!==a.type||a.checked)&&R.data.push(j+"\r\n\r\n"+a.value+"\r\n")}function Se(){if(!R.error&&!R.Za){var a={"Content-type":"multipart/form-data; boundary="+R.Ya};k.a&&(a.Referer=""+m.location);R.data.push("--"+R.Ya+"--\r\n");GM_xmlhttpRequest({method:"POST",headers:a,data:new Blob(R.data),url:k.$a(R.url),onreadystatechange:function(a){4===a.readyState&&(200===a.status?R.ab(Oe(k.ac(a.responseText),n)):I(0===a.status?xa[h]:"HTTP ["+a.status+"] "+a.statusText,"upload",n),
R=l)}})}}function Sf(a,b){var c,d,j,e,o,u,Aa,k=!!f.removeEXIF;if(!f.postSameImg&&!k&&!b)return[a];if(255===a[0]&&216===a[1]){d=2;j=0;o=1;e=a.length-1;Aa=[2];for(u=l;d<e;){if(255===a[d]){if(k){if(!u&&1===o)if(225===a[d+1]&&69===a[d+4])a:{var h=d+10;c=(a[d+2]<<8)+a[d+3];var g=u=ta,m=ta,p=ta,q=ta,s=0,t=0,v=0,r="MM"!==String.fromCharCode(a[h],a[h+1]),h=new DataView(a.buffer,h);if(42!==h.getUint16(2,r))u=l;else if(u=h.getUint32(4,r),u>c)u=l;else{q=h.getUint16(u,r);for(g=0;g<q;g++)if(p=h.getUint16(m=u+
2+12*g,r),!(282!==p&&283!==p&&296!==p))if(296===p)v=h.getUint16(m+8,r)-1;else{m=h.getUint32(m+8,r);if(m>c){u=l;break a}282===p?s=Math.round(h.getUint32(m,r)/h.getUint32(m+4,r)):t=Math.round(h.getUint32(m,r)/h.getUint32(m+4,r))}s=s||t;t=t||s;u=[v,s>>8,s&255,t>>8,t&255]}}else 224===a[d+1]&&70===a[d+7]&&(u=[a[d+11],a[d+12],a[d+13],a[d+14]]);if(14===a[d+1]>>4||254===a[d+1]){c=2+(a[d+2]<<8)+a[d+3];j+=c;Aa.push(d,d+=c);continue}}if(216===a[d+1])o++;else if(217===a[d+1]&&0===--o)break}d++}d+=2;!b&&75<e-
d&&(d=e);if(0===j)return d===e?[a]:[new Uint8Array(a,d)];Aa.push(d);o=new Uint8Array(d-j+18);o.set([255,216,255,224,0,16,74,70,73,70,0,1,1].concat(u||[0,0,1,0,1]),0);d=0;j=20;for(e=Aa.length;d<e;d+=2)o.set(a.subarray(Aa[d],Aa[d+1]),j),j+=Aa[d+1]-Aa[d];return[o]}if(137===a[0]&&80===a[1]){d=0;for(e=a.length-7;d<e&&(73!==a[d]||69!==a[d+1]||78!==a[d+2]||68!==a[d+3]);d++);d+=8;return d===e||!b&&75<e-d?[a]:[new Uint8Array(a,d)]}return l}function sc(a){var b=a.M.b,c=p("de-qarea");g.A=b;if(g.K){if(e.Ba(a).nextElementSibling===
c){J(c);Ha();return}}else g.K=i,c.appendChild(p("de-pform")),J(p("de-togglereply")),!q&&!e.H&&!e.j&&(r(g.form.querySelector('#thr_id, input[name="parent"]')),X(g.form.firstChild,D('<input type="hidden" id="thr_id" value="'+b+'" name="'+(e.d||e.l?"resto":e.r?"thread":"parent")+'"/>')),ba&&(r(ba.querySelector('input[name="oek_parent"]')),X(ba.firstChild,D('<input type="hidden" value="'+b+'" name="oek_parent"/>'))));L(e.Ba(a),c);c.style.display="";q||(Te(b),f.noThrdForm&&(p("de-parea").style.display=
"none"));g.k&&!g.T&&!e.H&&db(b);e.n&&"Comment"===g.g.value&&(g.g.value="");Va(g.g,">>"+a.b+(Pa||"").replace(/(?:^|\n)(.)/gm,"\n> $1")+"\n");3===f.addPostForm&&U(N("a",p("de-qarea-target")),{href:e.J(x,b),text:"#"+b})}function Ha(){if(g.K){var a=p("de-togglereply"),b=p("de-qarea");g.K=n;q||(Te(0),r(p("thr_id")));J(a);b.style.display="none";L(p("de-parea"),b);L(a,p("de-pform"))}}function Te(a){g.form.querySelector('#thr_id, input[name*="thread"]').value=a;ba&&(ba.querySelector('input[name="oek_parent"], input[name="replyto"]').value=
a);e.Sb&&(g.form.querySelector('input[name="quickreply"]').value=a||"")}function se(a){var b=p("de-parea");A(a);g.K?(b.style.display="",Ha()):J(b);pb(b)}function Tf(a){/Reply|Ответ/.test(a.target.textContent)||((a.stopPropagation(),A(a),!q&&f.noThrdForm&&!g.K&&(p("de-parea").style.display=""),a=ca(a.target).b,q&&1<f.addPostForm&&!g.K)?sc(H[a]):(e.n&&"Comment"===g.g.value&&(g.g.value=""),Va(g.g,">>"+a)))}function pc(){if(g.g){var a=e.H||e.f||e.n||e.L||e.O,b={bold:[e.n?"**":
a?"b":"**","B"],italic:[e.n?"*":a?"i":"*","i"],under:[a?"u":"__","U"],strike:[e.L?"-":a?"s":e.ja?"^^":"","S"],spoil:[e.L?"s":e.n?"%":a||e.d?"spoiler":"%%","%"],code:[e.L?"c":e.f?"aa":e.n?"pre":a?"code":"`","C"],quote:[,"&gt;"]},c=function(d){var j=g.g,C=p("de-btn-"+d),o=b[d][1];C||(C=s("span",{id:"de-btn-"+d,title:Gd[d][h]},l),"&gt;"!==o?C.onclick=function(c){var d,C,o=j.selectionStart,f=j.selectionEnd,h=j.scrollTop,k=j.value.substring(o,f).split("\n"),g=k.length;d=b[this.id.substring(7)][0];A(c);
a||e.d&&"spoiler"===d?(c="["+d+"]",d="[/"+d+"]"):c=d;for(;g--;){if(!c)for(C=k[g].trim().length;C--;)d+="^H";C=f+c.length+d.length;k[g].match(/^\s+/)&&(c=k[g].match(/^\s+/)[0]+c);k[g].match(/\s+$/)&&(d+=k[g].match(/\s+$/)[0]);k[g]=c+k[g].trim()+d}j.value=j.value.substr(0,o)+k.join("\n")+j.value.substr(f);j.setSelectionRange(C,C);j.focus();j.scrollTop=h}:(C.onmouseover=function(){Pa=fc()},C.onclick=function(a){var b=j.selectionStart,c=j.selectionEnd;A(a);Va(j,"> "+(b===c?Pa:j.value.substring(b,c)).replace(/\n/gm,
"\n> "))}),p("de-txt-panel").appendChild(C));C.innerHTML=2===f.addTextBtns?("B"===o?"[ ":"")+'<a href="#">'+o+"</a>"+("&gt;"!==o?" / ":" ]"):3===f.addTextBtns?'<input type="button" value="'+o+'" style="font-weight: bold;"/>':"";return c};L(f.txtBtnsLoc?p("de-txt-resizer")||g.g:e.n?t("popup",g.form):g.ta,U(p("de-txt-panel")||s("span",{id:"de-txt-panel"},l),{lang:!f.addTextBtns?"en":!f.txtBtnsLoc?"ru":""}));c("bold")("italic");e.n||c("under")("strike");c("spoil")("code")("quote")}}function uc(a){var b,
c=a.querySelector(e.ib),d='<span class="de-ppanel '+(a.p?"":"de-ppanel-cnt")+'" info="'+a.b+'"><span class="de-btn-hide" onclick="de_hideClick(this)" onmouseover="de_hideOver(this)" onmouseout="de_btnOut(event)"></span>'+(g.Sc||ba?'<span class="de-btn-rep" onclick="de_qReplyClick(this)" onmouseover="de_qReplyOver(this)"></span>':"");a.p&&(q||(d+='<span class="de-btn-expthr" onclick="de_expandClick(this)" onmouseover="de_expandOver(this)" onmouseout="de_btnOut(event)"></span>'),b=e.host,F[b]&&F[b][x]&&
F[b][x][a.b]?(d+='<span class="de-btn-fav-sel" onclick="de_favorClick(this)"></span>',F[b][x][a.b].Db=a.M.R+1):d+='<span class="de-btn-fav" onclick="de_favorClick(this)"></span>');k.ea(c,d+(a.Yb?'<span class="de-btn-sage" title="SAGE" onclick="de_sageClick(this)"></span>':"")+"</span>");a.G=c.nextSibling;g.form&&f.insertNum&&((e.W||q&&(e.H||e.Ja))&&B(c.getElementsByTagName("a"),function(a){a.onclick=l}),e.F||(c.onclick=Tf))}function Uf(){ob('function de_removeSel() {\t\t\tvar el = document.getElementById("de-menu");\t\t\tif(el) {\t\t\t\tel.parentNode.removeChild(el);\t\t\t}\t\t}\t\tfunction de_delSelection(e) {\t\t\tif(e.relatedTarget && !document.evaluate("ancestor-or-self::div[@id=\'de-menu\']", e.relatedTarget, null, 3, null).booleanValue) {\t\t\t\tde_removeSel();\t\t\t}\t\t}\t\tfunction de_btnOut(e) {\t\t\tclearTimeout(e.target.de_overDelay);\t\t\tde_delSelection(e);\t\t}\t\tfunction de_btnOver(el, data) {\t\t\tel.de_overDelay = setTimeout(function(msg) {\t\t\t\twindow.postMessage(msg, "*");\t\t\t}, '+
f.linksOver+', data);\t\t}\t\tfunction de_hideOver(el) {\t\t\tde_btnOver(el, "A" + el.parentNode.getAttribute("info"));\t\t}\t\tfunction de_imgSOver(el) {\t\t\tde_btnOver(el, "L" + el.getAttribute("de-id"));\t\t}\t\tfunction de_expandOver(el) {\t\t\tde_btnOver(el, "B" + el.parentNode.getAttribute("info"));\t\t}\t\tfunction de_hideClick(el) {\t\t\twindow.postMessage("D" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_qReplyClick(el) {\t\t\twindow.postMessage("F" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_qReplyOver(el) {\t\t\twindow.postMessage("C" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_expandClick(el) {\t\t\twindow.postMessage("E" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_favorClick(el) {\t\t\twindow.postMessage("G" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_sageClick(el) {\t\t\twindow.postMessage("H" + el.parentNode.getAttribute("info"), "*");\t\t}\t\tfunction de_cImgSearch(e, name) {\t\t\te.preventDefault();\t\t\twindow.postMessage("_" + name + ";" + e.target.getAttribute("de-url"), "*");\t\t\tde_removeSel();\t\t}');
P(window,{message:function(a){var b=a.data.substring(1);switch(a.data[0]){case "A":Mf(H[+b]);break;case "B":Of(H[+b]);break;case "C":Pa=fc();break;case "D":a=H[+b];Na(a,!a.h);Ka();break;case "E":cb(H[+b],1,l);break;case "F":sc(H[+b]);break;case "G":a=H[+b];oe(a,t("de-btn-fav",a)||t("de-btn-fav-sel",a));break;case "H":Ga("#sage","");break;case "I":r(p("de-fav-wait"));p("de-iframe-fav").style.height=b+"px";break;case "J":a=b.split("$#$");"de-iframe-pform"===a[0]?Me([a[1],a[2]]):Ne([a[1],a[2]]);p(a[0]).src=
"about:blank";break;case "L":Pf(w.querySelector('.de-btn-src[de-id="'+b+'"]'))}}})}function Vf(a){var b,c,d=a.length;if(255===a[0]&&216===a[1])for(c=b=0;b<d-1;b++){if(255===a[b])if(216===a[b+1])c++;else if(217===a[b+1]&&0===--c){b+=2;break}}else if(137===a[0]&&80===a[1])for(b=0;b<d-7;b++){if(73===a[b]&&69===a[b+1]&&78===a[b+2]&&68===a[b+3]){b+=8;break}}else return n;if(b!==d&&60<d-b)for(d=b+50;b<d;b++){if(55===a[b]&&122===a[b+1]&&188===a[b+2])return[b,0];if(80===a[b]&&75===a[b+1]&&3===a[b+2])return[b,
1];if(82===a[b]&&97===a[b+1]&&114===a[b+2])return[b,2];if(79===a[b]&&103===a[b+1]&&103===a[b+2])return[b,3];if(73===a[b]&&68===a[b+1]&&51===a[b+2])return[b,4]}return n}function Ue(a,b,c){if(k.Gc){this.url=window.URL.createObjectURL(new Blob(["self.onmessage = function(e) {\t\t\tself.postMessage(("+b+')(e["data"]), null);\t\t}']));this.S=new rb(a,this.gc.bind(this),l);this.find=this.jc;this.pb=[];for(this.Mc=this.mc.bind(this,c);0<a;)this.pb.push(new Worker(this.url)),a--}else this.find=this.ic.bind(b)}
function Wf(a,b){if(b){var c,d,j=b[1],C=this.getAttribute("download");2===j?(c="application/x-rar-compressed",d="rar"):1===j?(c="application/zip",d="zip"):0===j?(c="application/x-7z-compressed",d="7z"):3===j?(c="audio/ogg",d="ogg"):(c="audio/mpeg",d="mp3");k.ea(nb(e.Tb,e.Kb(this)),'<a href="'+window.URL.createObjectURL(new Blob([a.subarray(b[0])],{type:c}))+'" class="'+(2<j?"de-img-audio":"de-img-arch")+'" title="'+Hd[h]+'" download="'+C.substring(0,C.lastIndexOf("."))+"."+d+'">.'+d+"</a>")}}function Xf(a,
b){var c={method:"GET",url:a,onreadystatechange:function(a){4===a.readyState&&(200===a.status?k.a&&e.d?b(new Uint8Array(a.responseText.split("").map(function(a){return a.charCodeAt()}))):b(new Uint8Array(a.response)):b(l))}};k.a&&e.d?(c.overrideMimeType="text/plain; charset=x-user-defined",GM_xmlhttpRequest(c)):(c.responseType="arraybuffer",ee(c))}function vc(a){var b,c,d,j,e,o;j=a?1:4;var u=f.findImgFile&&new Ue(j,Vf,function(a){console.error("FILE DETECTOR ERROR, line: "+a.jd+" - "+a.message)}),
h=f.preLoadImgs&&new rb(j,function(a,b){var c=b[0],d=b[2],j=b[3];Xf(b[1],function(a){a&&(c.href=window.URL.createObjectURL(new Blob([a],{type:d})),j&&(N("img",c).src=c.href),u&&u.find(a,Wf.bind(c,a)));c=j=d=l;k.a?h.end():setTimeout(function(){h.end()},100)})},function(){u&&u.clear();u=h=l});j=0;o=Ia(a||w);for(e=o.length;j<e;j++){a=W("ancestor::a[1]",o[j]);b=a.href;d=!!f.openImgs;if(/\.gif$/i.test(b))c="image/gif";else{if(/\.jpe?g$/i.test(b))c="image/jpeg";else if(/\.png$/i.test(b))c="image/png";else continue;
d&=!f.openGIFs}a.setAttribute("download",b.substring(b.lastIndexOf("/")+1));h?h.Ia([a,b,c,d]):d&&(o[j].src=b)}h&&h.complete()}function za(a,b,c,d,j){za.Bb(a)?this.disabled=i:(this.Xb=a.replace(/(?:[sihdny]\?){2,}/g,function(a){return"(?:"+a.replace(/\?/g,"")+")?"}).replace(/\-/g,"[^<]").replace(/\+/g,"[^0-9]").replace(/([sihdny]+)/g,"($1)").replace(/[sihdny]/g,"\\d").replace(/m|w/g,"([a-zA-Zа-яА-Я]+)"),this.pattern=a.replace(/[\?\-\+]+/g,"").replace(/([a-z])\1+/g,"$1"),this.zc=
parseInt(b,10),this.uc=Id[c],this.tc=Jd[c],this.sc=Kd[c],d&&j&&Xa(d)===+j&&(this.Pb=i,this.ra=d.substring(1),this.bb=!!+d[0]))}function wc(){if(f.YTubeTitles){try{this.Ka=JSON.parse(sessionStorage["de-yt-titles"])||{}}catch(a){this.Ka={}}this.S=new rb(8,this.lc.bind(this),this.ad.bind(this))}else this.gb=this.Kc}function Yf(a,b){GM_xmlhttpRequest({method:"GET",url:"https://www.youtube.com/watch?v="+a,onload:function(a){var d,j,e,o,f,h,k=[];d=a.responseText.match(/\"url_encoded_fmt_stream_map\":\s*\"([^\"]+)\"/);
j="%2C";var g="%26",m="%3D";if(d){d=d[1];d.contains(",")&&(j=",",g=d.contains("&")?"&":"\\u0026",m="=");a=0;d=d.split(j);for(j=d.length;a<j;a++){e=d[a].split(g);o=[];for(f=0;f<e.length;f++)h=e[f].split(m),2===h.length&&(o[h[0]]=h[1]);if(e=o.url)if(e=unescape(unescape(e)).replace(/\\\//g,"/").replace(/\\u0026/g,"&"),f=o.itag)(o=o.sig)&&(e+="&signature="+o),0===e.toLowerCase().indexOf("http")&&(k[f]=e)}b(k)}else b(l);b=l}})}function Ve(a,b,c){var d=' width="'+f.YTubeWidth+'" height="'+f.YTubeHeigh+
'"/>';a.innerHTML=1===f.YTubeType?'<iframe type="text/html" src="https://www.youtube.com/embed/'+b+(f.YTubeHD?"?hd=1&":"?")+"start="+c+'&html5=1" frameborder="0"'+d:'<embed type="application/x-shockwave-flash" src="https://www.youtube.com/v/'+b+(f.YTubeHD?"?hd=1&":"?")+"start="+c+'" wmode="transparent"'+d}function xc(a,b){var c=b[1],d=(b[2]?3600*b[2]:0)+(b[3]?60*b[3]:0)+(b[4]?+b[4]:0);2!==f.YTubeType?Ve(a,c,d):Yf(c,function(b){(b=b?f.YTubeHD?b[45]||b[44]||b[43]:b[43]:n)?(a.innerHTML='<video poster="https://i.ytimg.com/vi/'+
c+'/0.jpg" controls="controls" preload="none" src="'+b+(k.a&&14>k.a?"&"+Math.random():"")+'" width="'+f.YTubeWidth+'" height="'+f.YTubeHeigh+'"></video>',0!==d&&(a.firstChild.ld=function(){this.currentTime=d;d=l})):Ve(a,c,d)})}function We(a,b){if(b){var c=t("de-ytube-obj",a);c.B=b.B;b.bc&&Xe(c)}}function Ye(a,b){var c,d=T("de-ytube-link",a);d.length>b.length&&(c=new wc);na.forEach.call(d,function(b,c){var d,e=this[c];e?(b.onclick=Ze,b.B=e.B,b.va=e.va):(d=b.href.match(Ab()),$e(b,d,a),ta.gb([e,d[1]]))},
b);c&&c.Zb();c=l}function Xe(a){a.bc=i;a.firstChild.onclick=function(a){A(a);a=this.parentNode;a.bc=n;xc(a,a.B)}}function af(a,b){a.innerHTML='<a href="https://www.youtube.com/watch?v='+b[1]+'" target="_blank"><img src="https://i.ytimg.com/vi/'+b[1]+'/0.jpg" width="360" height="270"/></a>';3===f.addYouTube&&Xe(a)}function Ab(){return/^https?:\/\/(?:www\.)?youtu(?:be\.com\/(?:watch\?.*?v=|v\/|embed\/)|\.be\/)([^&#?]+).*?(?:t(?:ime)?=(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s?)?)?$/}function Ze(a){var b=this.B,
c=t("de-ytube-obj",ca(this));A(a);c.B===b?(c.innerHTML="",c.B=l):(2<f.addYouTube?af(c,b):xc(c,b),c.B=b)}function $e(a,b,c){var d,j;c.qb||((c.qb=j=s("div",{"class":"de-ytube-obj"},l),2<f.addYouTube?(j.B=b,af(j,b)):2===f.addYouTube&&(j.B=b,xc(j,b)),c=c.i||c.querySelector(e.v),e.f)?(c=c.parentNode,d=c.previousElementSibling,X(d.hasAttribute("style")?d:c,j)):X(c,j));a.href=a.href.replace(/^http:/,"https:");a.B=b;a.className="de-ytube-link";a.onclick=Ze}function Cb(a){if(f.addYouTube){var b=new wc;B((a||
w).querySelectorAll("embed, object, iframe"),function(b){var d,j;if(j=(b.src||b.data).match(Ab())){d="https://www.youtube.com/watch?v="+j[1];if(j[4]||j[3]||j[2])d+="#t="+(j[2]?j[2]+"h":"")+(j[3]?j[3]+"m":"")+(j[4]?j[4]+"s":"");j=a||ca(b);(j.i||j.querySelector(e.v)).appendChild(D('<p class="de-ytube-ext"><a href="'+d+'">'+d+"</a></p>"));r(b)}});B((a||w).querySelectorAll('a[href*="youtu"]'),function(c){var d=c.href.match(Ab());d&&($e(c,d,a||ca(c)),b.gb([c,d[1]]))});b.Zb();b=l}}function Zf(a){var b=
this[0];b&&(a&&this[1].test(a)?(K.ha.apply(l,this.concat(i,i)),this[0]=n):0===--b.Z&&(b.Z=l,K.ha.apply(l,this.concat(n,i))))}function Db(a){f.addMP3&&B((a||w).querySelectorAll('a[href*=".mp3"]'),function(b){if("_blank"===b.target||"nofollow"===b.rel){var c=a||ca(b),d=t("de-mp3",c);d||(d=s("div",{"class":"de-mp3"},l),X(c.i||c.querySelector(e.v),d));d.querySelector('object[FlashVars*="'+b.href+'"]')||(d.innerHTML+='<object data="//junglebook2007.narod.ru/audio/player.swf" type="application/x-shockwave-flash" wmode="transparent" width="220" height="16" FlashVars="playerID=1&amp;bg=0x808080&amp;leftbg=0xB3B3B3&amp;lefticon=0x000000&amp;rightbg=0x808080&amp;rightbghover=0x999999&amp;rightcon=0x000000&amp;righticonhover=0xffffff&amp;text=0xffffff&amp;slider=0x222222&amp;track=0xf5f5dc&amp;border=0x666666&amp;loader=0x7fc7ff&amp;loop=yes&amp;autostart=no&amp;soundFile='+
b.href+'"/><br>')}})}function $f(a){function b(){bc(m.body,{mousemove:c,mouseup:b})}function c(b){a.style.left=b.clientX-a.wc+"px";a.style.top=b.clientY-a.xc+"px";a.Qb=i}a.onmousedown=function(d){A(d);a.wc=d.clientX-parseInt(a.style.left,10);a.xc=d.clientY-parseInt(a.style.top,10);P(m.body,{mousemove:c,mouseup:b})}}function ag(a){var b=a.clientX,c=a.clientY,d=parseInt(this.style.left,10),j=parseInt(this.style.top,10),e=parseFloat(this.style.width||this.width),o=parseFloat(this.style.height||this.height),
f=k.a?-a.detail:a.wheelDelta,h=e*(0<f?1.25:0.8),f=o*(0<f?1.25:0.8);A(a);this.style.width=h+"px";this.style.height=f+"px";this.style.left=parseInt(b-h/e*(b-d),10)+"px";this.style.top=parseInt(c-f/o*(c-j),10)+"px"}function bf(a,b,c){var d="",j="",e=+b[0],b=+b[1],o=m.documentElement.clientWidth,u=window.innerHeight,h=t("de-img-full",a);if(!(h&&c||!h&&c===n))if(1===f.expandImgs&&!a.querySelector('img[style*="fixed"]')&&J(N("img",a)),h)h.Qb?h.Qb=n:(J(h),setTimeout(r,0,h));else if(1===f.expandImgs?o-=oa(a).left+
25:r(t("de-img-center",m)),e&&b&&(d=e<o?e:o,j=d*b/e,2===f.expandImgs&&j>u&&(j=u,d=j*e/b)),h=a.appendChild(D('<img class="de-img-full" src="'+a.href+'" alt="'+a.href+'" width="'+d+'" height="'+j+'"/>')),2===f.expandImgs)k.s(h,"de-img-center"),h.style.cssText="left: "+(o-d)/2+"px; top: "+(u-j)/2+"px;",h.addEventListener(k.a?"DOMMouseScroll":"mousewheel",ag,n),$f(h)}function cf(a){a.onclick=function(a){f.expandImgs&&1!==a.button&&(A(a),bf(this,this.firstChild.title.split("x"),l))}}function Eb(a){if(f.addImgs)for(var b,
c=0,d=a.querySelectorAll(e.v+' a[href*=".jpg"], '+e.v+' a[href*=".png"], '+e.v+' a[href*=".gif"]'),j=d.length;c<j;c++){b=d[c];if("SMALL"===b.parentNode.tagName)break;a=b.cloneNode(n);a.target="_blank";J(a);a.appendChild(s("img",{"class":"de-img-pre",src:a.href,alt:a.href},{load:function(){var a,b;J(this.parentNode);a=this.width;b=this.height;this.title=a+"x"+b;200>=a&&200>=b||(a/=b,this.width=1>a?200*a:200,this.height=1>a?200:200/a)}}));cf(a);X(b,a)}}function Fb(a){if(f.imgSrcBtns)for(var b=a.b||
"",a=a.querySelectorAll(e.Tb),c=a.length-1,d;0<=c;c--)d=a[c],/google\.|tineye\.com|iqdb\.org/.test(d.href)?r(d):d.firstElementChild||k.fb(d,'<span de-id="'+b+c+'" class="de-btn-src" onmouseover="de_imgSOver(this)" onmouseout="de_btnOut(event)"></span>')}function df(a,b){/\.jpe?g|\.png|.\gif|^blob:/i.test(a.href)&&bf(a,hc(e.Kb(a)),b)}function lc(a,b){B(a.P,function(a){df(W("ancestor::a[1]",a),b)})}function Gb(a){B(a.P,function(a){var c=W("ancestor::a[1]",a);c&&(a.onclick=l,e.Gb&&(a.parentNode.onclick=
l),c.onclick=function(a){if(a.button!==1){A(a);df(this,l)}})})}function ef(a){var b='<div class="de-refmap">'+a.w.join(", ").replace(/(\d+)/g,'<a href="#$1">&gt;&gt;$1</a>')+"</div>";try{k.ea(a.i,b)}catch(c){a.appendChild(D(b))}}function yc(a){var b=[];k.forEach(a,function(c){for(var d,j,e=this[c].i.getElementsByTagName("a"),o=e.length-1;0<=o;o--)if((d=e[o].textContent.match(/^>>(\d+)$/))&&(j=a[d[1]]))j.w?-1===j.w.indexOf(c)&&j.w.push(c):(j.w=[c],b.push(j))});b.forEach(ef);b=a=l}function Hb(a){if(a){a.parent?
a.parent.ga=l:ua=l;do{clearTimeout(a.Yc);var b=a;f.animation?(k.aa(b,r),k.s(b,"de-pview-anim"),b.style[k.ma]="de-post-close-"+(b.xb?"t":"b")+(b.wb?"l":"r")):r(b)}while(a=a.ga)}}function bb(a,b){a&&(clearTimeout(jb),jb=setTimeout(Hb,f.linksOut,b?a:a.ga))}function zc(){this.style[k.ma]&&(k.Y(this,"de-pview-anim"),this.style.cssText=this.Fa,this.Fa=n,B(T("de-css-move",m.head),r),this.removeEventListener(k.la,zc,n))}function ff(a,b,c){if(b.link!==a){b.link=a;var d,e;d=a.getBoundingClientRect();e=d.left+
window.pageXOffset+a.offsetWidth/2;var C=d.top+window.pageYOffset,o=m.documentElement.clientWidth,u=e<o/2,o=(u?o-e:e)-10,h="max-width:"+o+"px; left:"+(u?e:e-Math.min(parseInt(b.offsetWidth,10),o))+"px;";c?(o=b.style.cssText,b.style.cssText="opacity: 0; "+h):b.style.cssText=h;e=b.offsetHeight;d=e+d.top+a.offsetHeight<window.innerHeight||5>d.top-e;e=(d?C+a.offsetHeight:C-e)+"px";b.wb=u;b.xb=d;!f.animation||!c?b.style.top=e:(a="de-movecss-"+Math.round(1E3*Math.random()),U(dc("@"+k.Fb+"keyframes "+a+
" {to { "+h+" top:"+e+"; }}"),{"class":"de-css-move"}),b.Fa?(b.style.cssText=b.Fa,b.removeEventListener(k.la,zc,n)):b.style.cssText=o,b.Fa=h+" top:"+e+";",b.addEventListener(k.la,zc,n),k.s(b,"de-pview-anim"),b.style[k.ma]=a)}}function gf(a,b){(t("de-pview-link",a)||{}).className="";(W('.//a[starts-with(text(),">>") and contains(text(),"'+b+'")]',a)||{}).className="de-pview-link"}function Ib(a,b,c,d,j){clearTimeout(jb);var C;if(a){if(j=(C=a.ownerDocument===m)?a.cloneNode(i):Jb(a),j.setAttribute("de-post",
l),j.className=e.u+" de-pview"+(a.ob?" de-viewed":""),j.style.display="",e.$&&(j.firstElementChild.style.cssText="max-width: 100%; margin: 0;",r(t("doubledash",j))),j.b=b,B(j.querySelectorAll(".de-img-full, .de-ppanel, .de-sound"),r),C?(f.addYouTube&&(Ye(j,T("de-ytube-link",a)),We(j,t("de-ytube-obj",a))),f.addImgs&&B(T("de-img-pre",j),function(a){cf(a.parentNode)}),f.imgSrcBtns&&B(T("de-btn-src",j),function(a){a.setAttribute("de-id","pv"+a.getAttribute("de-id"))})):(Db(j),Cb(j),Eb(j),Fb(j)),B(j.P=
Ia(j),function(a){a.style.display=""}),f.expandImgs&&Gb(j),2===f.linksNavig&&gf(j,c.b),eb(j),e.Lb(a)&&L(j.querySelector(e.ib),s("span",{"class":"de-btn-sage",title:"SAGE"},l)),f.markViewed)j.Yc=setTimeout(function(a,b){if(!a.ob){k.s(a,"de-viewed");a.ob=i}var c=(sessionStorage["de-viewed"]||"").split(",");c.push(b);sessionStorage["de-viewed"]=c},2E3,a,b)}else j||(Qb[b]=i),j=D('<div class="'+e.u+' de-pview-info de-pview">'+(j||$b[h])+"</div>");w.appendChild(j);ff(d,j,n);j.onmouseover=function(){bb(this,
n)};j.onmouseout=function(){bb(ua,i)};j.Rb=i;ua&&c.Rb?(Hb(c.ga),j.parent=c,c.ga=j):(Hb(ua),ua=j);f.animation&&(k.aa(j,function(a){k.Y(a,"de-pview-anim");a.style[k.ma]=""}),k.s(j,"de-pview-anim"),j.style[k.ma]="de-post-open-"+(j.xb?"t":"b")+(j.wb?"l":"r"));return j}function hf(a,b,c){if(!va[a])return l;var d=va[a][b];if(a===x||!d||d.rc)return d;b=sb(a)+e.sa+c+(e.ia?".html":Kb);a=d.getElementsByTagName("a");for(c=a.length-1;0<=c;c--)/^>>\d+$/.test(a[c].textContent)&&(a[c].href=b);d.rc=i;return d}function bg(a){var b=
a.pathname.match(e.Xc)[1],c=(a.pathname.match(/[^\/]+\/[^\d]*(\d+)/)||[,0])[1],d=(a.textContent.match(/\d+$/)||[c])[0],j=H[d]||hf(b,d,c),C=ca(a),o=C.Rb?C.ga:ua;if(!f.noNavigHidd||!j||!j.h)Qb[d]?Ib(l,d,C,a,$b[h]):o&&o.b===d?(bb(o,n),Hb(o.ga),ff(a,o,i),gf(o,C.b)):j?Ib(j,d,C,a,l):(o=Ib(l,d,C,a,'<span class="de-wait">'+wa[h]+"</span>"),va[b]=[],Ba(l,b,c,i,function(j,f,h){if(!h){var k=0,g=j.length;f.p=i;f.i=f.querySelector(e.v);for(va[b][c]=f;k<g;k++)f=j[k],f.i=f.querySelector(e.v),va[b][e.pa(f)]=f;yc(va[b]);
o&&o.parentNode&&Ib(hf(b,d,c),d,C,a,h)}b=d=c=C=o=l}))}function cg(){2<this.textContent.length&&(this.Qc=setTimeout(bg,f.linksOver,this))}function dg(){clearTimeout(this.Qc);bb(ua,i)}function eb(a){if(f.linksNavig)for(var b=m.evaluate('.//a[starts-with(text(),">>")]',a,l,4,l);a=b.iterateNext();)a.onmouseover=cg,a.onmouseout=dg}function Ba(a,b,c,d,j){GM_xmlhttpRequest({method:"GET",url:k.$a(a||e.J(b,c)),onreadystatechange:function(a){if(4===a.readyState){if(200===a.status){var b=k.ac(a.responseText);
!g.form&&ba&&(g=jf(m.importNode(b.querySelector(e.Ub),i)),X(ba,g.form));d?kf(b.querySelector(e.Ga),b,function(a){j(e.cb(a),e.Jb(a,b),l)}):j(l,b,l)}else j(l,l,0===a.status?xa[h]:"HTTP ["+a.status+"] "+a.statusText);j=d=b=l}}})}function eg(a,b){GM_xmlhttpRequest({method:"GET",url:k.$a(a),onreadystatechange:function(a){if(4===a.readyState)if(304===a.status)ka(p("de-alert-newposts"));else{try{b(a.status,a.statusText,JSON.parse(a.responseText))}catch(d){b(1,d.toString(),l)}b=l}}})}function Jb(a){return Ac(m.importNode(a,
i))}function lf(a){f.expandImgs&&Gb(a);a.h||(V[a.count]=1,E.U(a,Lb,n));var b,c,d=[];c=a.i.getElementsByTagName("a");for(var e=c.length-1;0<=e;e--)(b=c[e].textContent.match(/^>>(\d+)$/))&&-1===d.indexOf(b=b[1])&&d.push(b);b=a.b;for(e=d.length-1;0<=e;e--)if(c=H[d[e]])c.w?-1===c.w.indexOf(b)&&c.w.push(b):c.w=[b],r(t("de-refmap",c)),ef(c),eb(t("de-refmap",c)),f.hideRefPsts&&c.h&&Lb(a,"reference to >>"+d[e]);eb(a);Db(a);Eb(a);Za&&lc(a,l)}function Mb(a,b,c,d){Bc(b,c,a,d);uc(b);f.expandPosts&&!q&&Cc(b);
Cb(b);lf(b);Fb(b);fb&&0!==d?(c=fb.cloneNode(i),(d=e.cb(c)[0])?d.parentNode.replaceChild(b,d):c=b):c=b;a.appendChild(c);(f.preLoadImgs||f.openImgs)&&vc(b);e.r&&!e.L&&a.appendChild(m.createElement("br"));return+!b.h}function Dc(a,b){var c=a.i.querySelector(".de-ytube-ext"),d=t("de-ytube-obj",a),j=T("de-ytube-link",a);b();e.jb&&(a.innerHTML=Ec(a.innerHTML),a.P=Ia(a));a.i=a.querySelector(e.v);c&&a.i.appendChild(c);d&&We(a,d);Ye(a,j);lf(a)}function mf(a,b){var c=ca(a),d=c.b;e.j?(r(a.nextSibling),r(a.previousSibling),
r(a),b?Dc(c,function(){c.i.replaceChild(c.querySelector(".alternate > div"),c.i.firstElementChild)}):c.i.replaceChild(c.querySelector(".alternate > div"),c.i.firstElementChild),c=l):Ba(l,x,c.M.b,i,function(b,f,o){o||(d===e.Aa(f)?(Dc(c,function(){c.i.parentNode.replaceChild(m.importNode(f.querySelector(e.v),i),c.i)}),r(a)):(o=na.some.call(b,function(a){return e.pa(a)===d?(Dc(c,function(){c.i.parentNode.replaceChild(m.importNode(a.querySelector(e.v),i),c.i)}),a=l,i):n}))||r(a));d=c=l})}function Cc(a){if(!a.h&&
(a=a.querySelector(e.f?'p[id^="post_truncated"]':e.j?".abbrev > span":".abbrev, .abbr, .omittedposts, .shortened"))&&/long|full comment|gek\u00fcrzt|слишком|длинн|мног|полная версия/i.test(a.textContent))1===f.expandPosts?mf(a,n):N("a",a).onclick=function(a){A(a);mf(this,i)}}function cb(a,b,c){c||I(wa[h],"load-thr",i);Ba(l,x,a.b,i,function(d,j,f){var o,u,g=a.M,
m=d.length;if(f)I(f,"load-thr",n);else{Ha();r(p("de-menu"));u=g.dd||g.R-fe(g)+1;g.innerHTML="";(f=Jb(j)).p=i;Mb(g,f,e.Aa(j),0);f.ua=(t(e.zb,f)||{}).textContent||qa(f).substring(0,70).replace(/\s+/g," ");ga[ga.indexOf(a)]=f;k.ea(f.G,'<span>&nbsp;[<a href="'+e.J(x,f.b)+'">'+Ld[h]+"</a>]</span>");1===b||b>=m?j=0:(j=m-b,g.dd=b+1,g.appendChild(s("div",{"class":"de-omitted",text:Md[h]+j},l)));for(o=[f];j<m;j++)Mb(g,f=Jb(d[j]),e.pa(d[j]),j+1),o.push(f);if(5<b||1===b)g.appendChild(D('<span>[<a href="#">'+
Nd[h]+"</a>]</span>")).onclick=function(b){A(b);cb(a,5,l);a=l};na.splice.apply(y,[y.indexOf(a),u].concat(o));g.R=m+1;ka(p("de-alert-load-thr"))}pb(a);c&&c();b=c=l})}function Lf(){var a=this.parentNode.parentNode,b=N("iframe",a),c=a.getAttribute("info").split(";")[2],d=t("de-content",m);r(p("de-fav-wait"));b?(r(b),d.style.overflowY="auto"):(c=H[c])&&!c.h?pb(c):(r(p("de-iframe-fav")),t("de-content",m).style.overflowY="scroll",ea(a,[D('<iframe name="de-iframe-fav" id="de-iframe-fav" src="'+N("a",a).href+
'" scrolling="no" style="border: none; width: '+(m.documentElement.clientWidth-55)+'px; height: 1px;"/>'),D('<div id="de-fav-wait" class="de-wait" style="font-size: 1.1em; text-align: center">'+wa[h]+"</div>")]))}function Be(a,b,c){Ba(e.ca(x,b),l,l,n,function(d,j){for(var f,d=m.importNode(j.querySelector(e.Ga),i);f=d.firstChild;)a.appendChild(f);c(Ac(a),b);c=a=b=l})}function De(a){I(wa[h],"load-pages",i);f.preLoadImgs&&B(w.querySelectorAll('a[href^="blob:"]'),function(a){window.URL.revokeObjectURL(a.href)});
var b=-1,c=w,d=Array(a),e=1;w.innerHTML="";y=[];for(va={};++b<a;)1<a&&(c=s("div",{id:"de-page"+b},l),ea(w,[s("center",{text:b+" "+Yb[h],style:"font-size: 2em;"},l),m.createElement("hr"),c])),Be(c,b,function(b,c){d[c]=b;if(e===a){d.forEach(function(a){nf(a);of(a)});y.forEach(uc);y.forEach(Gb);y.forEach(Cc);Db(l);Cb(l);Eb(w);Fb(w);yc(H);eb(w);je();f.markViewed&&pe();pf();Za&&y.forEach(function(a){lc(a,l)});ka(p("de-alert-load-pages"));(f.preLoadImgs||f.openImgs)&&vc(l);e=d=l}else e++})}function Fc(a){q&&
1===f.updThread&&(m.querySelector('a[id^="de-btn-upd"]').id="de-btn-upd-"+a)}function te(){Fc("off");clearInterval(xb);xb=ta}function ve(){Ta||(Ta=s("audio",{preload:"auto",src:"https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/master/signal.ogg"},l));Sa=!Sa}function qf(){la?hb=n:(Ta.play(),setTimeout(qf,Ra),hb=i)}function Nb(a,b){if(a)a!==xa[h]?(I(Od[h]+q+"): \n"+a,"newposts",n),m.title="{"+a.match(/(?:\[)(\d+)(?:\])/)[1]+"} "+m.title,te()):(I(xa[h],"newposts",n),Fc("warn"));else if(ka(p("de-alert-newposts")),
1===f.updThread&&(Fc("on"),!la)){b+=+(m.title.match(/^\[(\d+)\]/)||[,0])[1];f.favIcoBlink&&Da&&(clearInterval(ib),0<b&&(ib=setInterval(function(){var a=m.head.querySelector('link[href="'+Da+'"]')?"data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII=":Da;B(m.head.querySelectorAll('link[rel="shortcut icon"]'),r);m.head.appendChild(s("link",{href:a,rel:"shortcut icon"},
l))},800)));m.title=(0<b?" ["+b+"] ":"")+Qa;if(k.m&&f.desktNotif&&0<b&&0!==window.webkitNotifications.checkPermission()){var c=window.webkitNotifications.createNotification("/favicon.ico",Qa,Pd[h].replace(/%m/g,b));c.ondisplay=function(){setTimeout(function(){c.cancel();c=l},8E3)};c.onclick=function(){window.focus&&window.focus();this.cancel()};c.show()}Sa&&!hb&&0<b&&(Ra?qf():Ta.play())}}function fg(a,b){var c,d=a.src,e=a.thumb,f=a.thumb_width,o=a.thumb_height,h=a.size,g=a.rating,k=he("de-rating")||
"r-15";"b"===x||"rf"===x?c=e.substring(e.lastIndexOf("/")+1):(c=d.substring(d.lastIndexOf("/")+1),17<c.length&&(c=c.substring(0,17)+"..."));e="r-18g"===g&&"r-18g"!==k?"images/r-18g.png":"r-18"===g&&("r-18g"!==k||"r-18"!==k)?"images/r-18.png":"r-15"===g&&"sfw"===k?"images/r-15.png":"illegal"===g?"images/illegal.png":a.thumb;e!==a.thumb&&(o=f=200);return D('<div class="file"><div class="fileinfo">Файл: <a href="/'+d+'" target="_blank">'+c+"</a><br><em>"+a.thumb.substring(a.thumb.lastIndexOf(".")+
1)+", "+(1024>h?h+" B":1048576>h?(h/1024).toFixed(2)+" KB":1073741824>h?(h/1048576).toFixed(2)+" MB":(h/1073741824).toFixed(2)+" GB")+", "+a.metadata.width+"x"+a.metadata.height+'</em><br><a class="edit_ icon" href="/utils/image/edit/'+a.file_id+"/"+b+'"><img title="edit" alt="edit" src="/images/blank.png"/></a></div><a href="/'+d+'" target="_blank"><img class="thumb" src="/'+e+'" width="'+f+'" height="'+o+'"/></a></div>')}function rf(a,b){if(e.hb&&!a.Fc){var c=b.querySelector(e.hb);c&&(a.querySelector(e.hb)||
a.i.appendChild(m.importNode(c,i)),a.Fc=i)}}function sf(a){if(!a.yc){var b=sessionStorage["de-deleted"];sessionStorage["de-deleted"]=(b?b+",":"")+a.count;a.yc=i;k.Y(a.G,"de-ppanel-cnt");k.s(a.G,"de-ppanel-del")}}function Bb(a){e.j?eg("//dobrochan.ru/api/thread/"+x+"/"+q+"/new.json?message_html&new_format&last_post="+y[y.length-1].b,function(b,c,d){if(200!==b||d.error)Nb(0===b?xa[h]:c||d.message,0);else{var j,b=0,f=(d.result||{}).posts,o=t("de-thread",w);if(f&&0<f.length){d=0;for(c=f.length;d<c;d++){j=
f[d];var u=ta,u=j.display_id,g=j.files,k=g.length,m=s("td",{id:"reply"+u,"class":"reply","de-post":u},l);m.innerHTML='<a name="i'+u+'"></a><label><a class="delete icon"><input type="checkbox" id="delbox_'+u+'" class="delete_checkbox" value="'+j.post_id+'" id="'+u+'"/></a><span class="postername">'+j.name+"</span> "+e.Cc.Ib(j.date)+' </label><span class="reflink"><a onclick="Highlight(0, '+u+')" href="/'+x+"/res/"+q+".xhtml#i"+u+'">No.'+u+"</a></span><br>";for(u=0;u<k;u++)m.appendChild(fg(g[u],j.post_id));
ea(m,[G(1<k,s("div",{style:"clear: both;"},l)),D('<div class="postbody">'+j.message_html+"</div>"),s("div",{"class":"abbrev"},l)]);j=Ac(m);b+=Mb(o,j,f[d].display_id,o.R+d);y.push(j)}o.R+=f.length}Nb(l,b)}a&&a();a=l}):Ba(l,x,q,i,function(b,c,d){if(d)Nb(d,0);else{var j,f,o,h,g=0,k=y.length,m=b.length,q=t("de-thread",w);rf(y[0],c);c=1;for(j=0;c<k||j<m;c++,j++)f=y[c],(o=b[j])?(h=e.pa(o),f?f.b!==h?(sf(f),j--):rf(f,o):(g+=Mb(q,f=Jb(o),h,c),y.push(f))):sf(f);Nb(d,g);q.R=k;Ja();p("de-panel-info").firstChild.textContent=
c+"/"+Ia(w).length}a&&a();a=l})}function ue(){xb=setInterval(function(){Bb(l)},1E3*f.updThrDelay)}function tf(a){f.hideRefPsts&&a.w&&(a.w.forEach(function(b){var c=H[b];c&&!O[b]&&Gc(c,"reference to >>"+a.b)}),a=l)}function Hc(a){f.hideRefPsts&&a.w&&a.w.forEach(function(a){var c=H[a];c&&!O[a]&&(0!==V[c.count]&&gb(c,n,l),Hc(c))})}function pf(){for(var a,b,c,d=y.length-1;0<=d;d--)if(c=V[d],a=y[d],O[b=a.b]){if(a.p&&(O[b][0]="undefined"===typeof La[b]?1:0),0===O[b][0]?Na(a,i):(O[b][1]=Date.now(),a.G.firstChild.className=
"de-btn-hide-user"),"undefined"===typeof c)V[d]=1,E.U(a,function(a){V[a.count]=0},n)}else a.p&&("undefined"!==typeof La[b]?V[d]=c="0":"0"===c&&(c=l)),"0"===c?Gc(a,l):"1"!==c&&(V[a.count]=1,E.U(a,Lb,n))}function ab(a,b){b?k.s(a,"de-post-hid"):k.Y(a,"de-post-hid")}function Ic(a,b){b&&a.G.appendChild(s("a",{"class":"de-post-note de-abtn",text:" autohide: "+b+" ",href:"#"},{click:function(a){A(a);r(this)}}))}function gb(a,b,c){var d,j,g=a.M;a.h=b;if(a.p){if(g.style.display=b?"none":"",g.h=b,d=p("de-thr-hid-"+
(j=a.b)),!b&&d&&(r(d),ne(a,1)),b&&!d)d=D('<div class="'+e.u+' de-thr-hid" id="de-thr-hid-'+j+'">'+Qd[h]+' <a href="#">№'+j+"</a><i> ("+(c?"autohide: "+c:a.ua.replace(/</g,"&lt;").replace(/>/g,"&gt;"))+")</i></div>"),X(g,d),b=N("a",d),b.onclick=function(b){A(b);Na(a,!a.h);Ka()},b.onmouseover=function(){g.style.display=""},d.onmouseout=function(){g.style.display="none"},ne(a,0)}else ab(a,b),f.delHiddPost?e.Ba(a).style.display=b?"none":"":((d=t("de-post-note",a))?b?c&&(d.innerText=" autohide: "+
c+" "):r(d):b&&Ic(a,c),d=a.querySelector(e.ib),d.onmouseover=b&&function(){ab(ca(this),n)},d.onmouseout=b&&function(){ab(ca(this),i)}),f.strikeHidd&&setTimeout(B,0,w.querySelectorAll('a[href*="#'+a.b+'"]'),b?function(a){a.className="de-ref-hid"}:function(a){a.className=l})}function Gc(a,b){gb(a,i,b);tf(a)}function Lb(a,b){O[a.b]||(a.h?(r(t("de-post-note",a)),Ic(a,b)):(V[a.count]=0,Gc(a,b)))}function uf(a){O[a.b]||(V[a.count]=1,gb(a,n,l),Hc(a),r(t("de-post-note",a)))}function Na(a,b){var c=a.b;gb(a,
b,l);a.G.firstChild.className="de-btn-hide-user";b?tf(a):Hc(a);O[c]||(O[c]=Array(2));O[c][0]=+!b;O[c][1]=Date.now()}function vf(a){return a.replace(/\s+/g," ").replace(/[^a-zа-яё ]/ig,"").substring(0,800).split(" ")}function Nf(a){var b=qa(a),c=vf(b),d=a.h,e=a.b;y.forEach(function(a){var b=e,f=d,h=c,g,k=vf(qa(a)),m=k.length,p=h.length,q=p,s=p,v=0;if(!(m<0.4*q||m>3*q)){for(;p--;)if(6<q&&3>h[p].length)s--;else for(g=m;g--;)(k[g]===h[p]||h[p].match(/>>\d+/)&&k[g].match(/>>\d+/))&&v++;
v<0.4*s||m>3*s||(r(t("de-post-note",a)),f?(0!==V[a.count]&&gb(a,n,l),O[p=a.b]&&delete O[p]):(Na(a,i),Ic(a,"similar to >>"+b)))}});Ka();d=e=c=l}function Ce(a){var b,c,d=a.P[0];if(d.hash)return d.hash;c=p("de-canvas")||m.body.appendChild(s("canvas",{id:"de-canvas",style:"display: none;"},l));a=c.width=d.width;b=c.height=d.height;c=c.getContext("2d");c.drawImage(d,0,0);c=c.getImageData(0,0,a||1,b||1).data;var e,f,o,h,g,k;g=a*b;var q=256/3,r=0;for(f=e=0;e<g;e++,f+=4)c[e]=0.3*c[f]+0.59*c[f+1]+0.11*c[f+
2];for(e=0;8>e;e++)for(f=0;8>f;f++){g=e/7*(b-1);o=Math.min(g|0,b-2);k=g-o;g=f/7*(a-1);h=Math.min(g|0,a-2);g-=h;r=(r<<4)+Math.min(128*((c[o*a+h]*(1-g)*(1-k)+c[o*a+h+1]*g*(1-k)+c[(o+1)*a+h+1]*g*k+c[(o+1)*a+h]*(1-g)*k)/q|0),255);if(o=r&4026531840)r^=o>>>24;r&=~o}return d.hash=r}function K(a){a?this.update():this.Oa()}function wf(a){E.U(a,Lb,a.h&&uf)}function Jc(){ka(p("de-alert-help-err-spell"));E.Nb&&y.forEach(function(a){E.U(a,uf,l)})}function oc(){var a=p("de-spell-edit"),b=a.value;if(b){if(E.qa(b)){Jc();
E.lb();a.value=E.list;f.hideBySpell?y.forEach(wf):E.disable();Ja();return}}else Jc(),Ja();E.kb("");m.querySelector('input[info="hideBySpell"]').checked=n}function Ga(a,b){var c,d=p("de-spell-edit"),e=d&&d.value,f=m.querySelector('input[info="hideBySpell"]');e||(E.Wb||E.Vb(),e=E.list);if(c=E.qa(e))if(a=a+(q?"["+x+","+q+"]":"")+b,e=c[0].split(RegExp("(?:^|\\|?[\\s\\n]*)"+Wa(a)+"(?: \\|\\n|$)","g")),c=1===e.length?E.qa(a+(e[0]?" |\n"+e[0]:"")+"\n\n"+c[1]):E.qa(e.join("")+"\n\n"+c[1])){Jc();E.lb();d&&
(f.checked=!!(d.value=E.list));E.list&&(Q("hideBySpell",1),y.forEach(wf));return}E.disable();d&&(f.checked=n);Q("hideBySpell",0)}function re(){return!f.scriptStyle?"fr":1===f.scriptStyle?"en":"de"}function ze(){function a(a,b){d+=a+':before { content: ""; padding: 0 16px 0 0; margin: 0 4px; background: url('+b+") no-repeat center; }"}function b(a,b){d+=a+" { background: url(data:image/gif;base64,"+b+") no-repeat center !important; }"}J(w);var c,d="",d=d+('.de-block { display: block; }\t\t#de-content-cfg > div { float: left; border-radius: 10px 10px 0 0; width: auto; min-width: 0; padding: 0; margin: 5px 20px; overflow: hidden; }\t\t#de-cfg-info > span { display: inline-block; vertical-align: top; }\t\t#de-cfg-head { padding: 4px; border-radius: 10px 10px 0 0; color: #fff; text-align: center; font: bold 14px arial; cursor: default; }\t\t#de-cfg-head:lang(en), #de-panel:lang(en) { background: linear-gradient(to bottom, #4b90df, #3d77be 5px, #376cb0 7px, #295591 13px, rgba(0,0,0,0) 13px), linear-gradient(to bottom, rgba(0,0,0,0) 12px, #183d77 13px, #1f4485 18px, #264c90 20px, #325f9e 25px); }\t\t#de-cfg-head:lang(fr), #de-panel:lang(fr) { background: linear-gradient(to bottom, #7b849b, #616b86 2px, #3a414f 13px, rgba(0,0,0,0) 13px), linear-gradient(to bottom, rgba(0,0,0,0) 12px, #121212 13px, #1f2740 25px); }\t\t#de-cfg-head:lang(de), #de-panel:lang(de) { background: #777; }\t\t.de-cfg-body { width: 372px; min-height: 348px; padding: 11px 7px 7px; margin-top: -1px; font: 13px sans-serif; }\t\t.de-cfg-body input[type="text"] { width: auto; padding: 0px; }\t\t.de-cfg-body input[value=">"] { width: 20px; }\t\t.de-cfg-body, #de-cfg-btns { border: 1px solid #183d77; border-top: none; }\t\t.de-cfg-body:lang(de), #de-cfg-btns:lang(de) { border-color: #444; }\t\t#de-cfg-btns { padding: 7px 2px 2px; }\t\t#de-cfg-bar { height: 25px; width: 100%; display: table; background-color: #1f2740; margin: 0; padding: 0; }\t\t#de-cfg-bar:lang(en) { background-color: #325f9e; }\t\t#de-cfg-bar:lang(de) { background-color: #777; }\t\t.de-cfg-depend { padding-left: 25px; }\t\t.de-cfg-tab { padding: 4px 6px; border-radius: 4px 4px 0 0; font: bold 14px arial; text-align: center; cursor: default; }\t\t.de-cfg-tab-back { display: table-cell !important; float: none !important; min-width: 0; padding: 0 !important; box-shadow: none !important; border: 1px solid #183d77 !important; border-radius: 4px 4px 0 0; opacity: 1; }\t\t.de-cfg-tab-back:lang(de) { border-color: #444 !important; }\t\t.de-cfg-tab-back:lang(fr) { border-color: #121421 !important; }\t\t.de-cfg-tab-back[selected="true"] { border-bottom: none !important; }\t\t.de-cfg-tab-back[selected="false"] > .de-cfg-tab { background-color: rgba(0,0,0,.2); }\t\t.de-cfg-tab-back[selected="false"] > .de-cfg-tab:lang(en), .de-cfg-tab-back[selected="false"] > .de-cfg-tab:lang(fr) { background: linear-gradient(to bottom, rgba(132,132,132,.35) 0%, rgba(79,79,79,.35) 50%, rgba(40,40,40,.35) 50%, rgba(80,80,80,.35) 100%) !important; }\t\t.de-cfg-tab-back[selected="false"] > .de-cfg-tab:hover { background-color: rgba(99,99,99,.2); }\t\t.de-cfg-tab-back[selected="false"] > .de-cfg-tab:hover:lang(en), .de-cfg-tab-back[selected="false"] > .de-cfg-tab:hover:lang(fr)  { background: linear-gradient(to top, rgba(132,132,132,.35) 0%, rgba(79,79,79,.35) 50%, rgba(40,40,40,.35) 50%, rgba(80,80,80,.35) 100%) !important; }\t\t.de-cfg-tab::'+
(k.a?"-moz-":"")+"selection { background: transparent; }\t\t.de-cfg-unvis { display: none; }\t\t#de-cfg-updresult { padding: 3px 0; font-size: 1.1em; text-align: center; }\t\t#de-spell-panel { float: right; }\t\t#de-spell-panel > a { padding: 0 4px; }\t\t#de-spell-div { display: table; }\t\t#de-spell-div > div { display: table-cell; vertical-align: top; }\t\t#de-spell-edit { padding: 2px; width: 340px; height: 255px; border: none !important; outline: none !important; }\t\t#de-spell-rowmeter { padding: 2px 3px 0 0; margin: 2px 0; overflow: hidden; width: 2em; height: 257px; text-align: right; color: #fff; font: 12px courier new; }\t\t#de-spell-rowmeter:lang(en), #de-spell-rowmeter:lang(fr) { background-color: #616b86; }\t\t#de-spell-rowmeter:lang(de) { background-color: #777; }"),
d=d+"#de-btn-logo { margin-right: 3px; cursor: pointer; }\t\t#de-panel { height: 25px; z-index: 9999; border-radius: 15px 0 0 0; cursor: default;}\t\t#de-panel-btns { display: inline-block; padding: 0 2px; margin: 0; height: 25px; border-left: 1px solid #8fbbed; }\t\t#de-panel-btns:lang(de), #de-panel-info:lang(de) { border-color: #ccc; }\t\t#de-panel-btns:lang(fr), #de-panel-info:lang(fr) { border-color: #616b86; }\t\t#de-panel-btns > li { margin: 0 1px; padding: 0; }\t\t#de-panel-btns > li, #de-panel-btns > li > a, #de-btn-logo { display: inline-block; width: 25px; height: 25px; }\t\t#de-panel-btns:lang(en) > li, #de-panel-btns:lang(fr) > li  { transition: all 0.3s ease; }\t\t#de-panel-btns:lang(en) > li:hover, #de-panel-btns:lang(fr) > li:hover { background-color: rgba(255,255,255,.15); box-shadow: 0 0 3px rgba(143,187,237,.5); }\t\t#de-panel-btns:lang(de) > li > a { border-radius: 5px; }\t\t#de-panel-btns:lang(de) > li > a:hover { width: 21px; height: 21px; border: 2px solid #444; }\t\t#de-panel-info { display: inline-block; vertical-align: top; padding: 0 6px; height: 25px; border-left: 1px solid #8fbbed; color: #fff; font: 18px serif; }";
c="R0lGODlhGQAZAIAAAPDw8P///yH5BAEAAAEALAAAAAAZABkAQA";b("#de-btn-logo",c+"I5jI+pywEPWoIIRomz3tN6K30ixZXM+HCgtjpk1rbmTNc0erHvLOt4vvj1KqnD8FQ0HIPCpbIJtB0KADs=");b("#de-btn-settings",c+"JAjI+pa+API0Mv1Ymz3hYuiQHHFYjcOZmlM3Jkw4aeAn7R/aL6zuu5VpH8aMJaKtZR2ZBEZnMJLM5kIqnP2csUAAA7");b("#de-btn-hidden",c+"I5jI+pa+CeHmRHgmCp3rxvO3WhMnomUqIXl2UmuLJSNJ/2jed4Tad96JLBbsEXLPbhFRc8lU8HTRQAADs=");b("#de-btn-favor",c+"IzjI+py+AMjZs02ovzobzb1wDaeIkkwp3dpLEoeMbynJmzG6fYysNh3+IFWbqPb3OkKRUFADs=");b("#de-btn-refresh",
c+"JAjI+pe+AfHmRGLkuz3rzN+1HS2JWbhWlpVIXJ+roxSpr2jedOBIu0rKjxhEFgawcCqJBFZlPJIA6d0ZH01MtRCgA7");b("#de-btn-goback",c+"IrjI+pmwAMm4u02gud3lzjD4biJgbd6VVPybbua61lGqIoY98ZPcvwD4QUAAA7");b("#de-btn-gonext",c+"IrjI+pywjQonuy2iuf3lzjD4Zis0Xd6YnQyLbua61tSqJnbXcqHVLwD0QUAAA7");b("#de-btn-goup",c+"IsjI+pm+DvmDRw2ouzrbq9DmKcBpVfN4ZpyLYuCbgmaK7iydpw1OqZf+O9LgUAOw==");b("#de-btn-godown",c+"ItjI+pu+DA4ps02osznrq9DnZceIxkYILUd7bue6WhrLInLdokHq96tnI5YJoCADs=");b("#de-btn-newthr",c+"IyjI+pG+APQYMsWsuy3rzeLy2g05XcGJqqgmJiS63yTHtgLaPTY8Np4uO9gj0YbqM7bgoAOw==");
b("#de-btn-expimg",c+"I9jI+pGwDn4GPL2Wep3rxXFEFel42mBE6kcYXqFqYnVc72jTPtS/KNr5OJOJMdq4diAXWvS065NNVwseehAAA7");b("#de-btn-maskimg",c+"JQjI+pGwD3TGxtJgezrKz7DzLYRlKj4qTqmoYuysbtgk02ZCG1Rkk53gvafq+i8QiSxTozIY7IcZJOl9PNBx1de1Sdldeslq7dJ9gsUq6QnwIAOw==");e.W&&b("#de-btn-catalog",c+"I2jI+pa+DhAHyRNYpltbz7j1Rixo0aCaaJOZ2SxbIwKTMxqub6zuu32wP9WsHPcFMs0XDJ5qEAADs=");b("#de-btn-audio-off",c+"I7jI+pq+DO1psvQHOj3rxTik1dCIzmSZqfmGXIWlkiB6L2jedhPqOfCitVYolgKcUwyoQuSe3WwzV1kQIAOw==");b("#de-btn-audio-on",c+"JHjI+pq+AewJHs2WdoZLz7X11WRkEgNoHqimadOG7uAqOm+Y6atvb+D0TgfjHS6RIp8YQ1pbHRfA4n0eSTI7JqP8Wtahr0FAAAOw==");
c="Dw8P///wAAACH5BAEAAAIALAAAAAAZABkAQAJElI+pe2EBoxOTNYmr3bz7OwHiCDzQh6bq06QSCUhcZMCmNrfrzvf+XsF1MpjhCSainBg0AbKkFCJko6g0MSGyftwuowAAOw==";b("#de-btn-upd-on","R0lGODlhGQAZAJEAADL/Mv"+c);b("#de-btn-upd-off","R0lGODlhGQAZAJEAAP8yMv"+c);b("#de-btn-upd-warn","R0lGODlhGQAZAJEAAP/0Qf"+c);d+=".de-ppanel { margin-left: 4px; }\t\t.de-post-note { color: inherit; font: italic bold 12px serif; }\t\t.de-ppanel > span, .de-btn-src, .de-btn-expthr, .de-btn-sage { display: inline-block; margin: 0 4px -2px 0 !important; cursor: pointer; ";
f.postBtnsTxt?d+="color: "+getComputedStyle(N("a",m)).getPropertyValue("color")+'; font-size:14px; }\t\t\t.de-btn-hide:after { content: "\u00d7"; }\t\t\t.de-post-hid .de-btn-hide:after { content: "+"; }\t\t\t.de-btn-hide-user:after { content: "[\u00d7]"; }\t\t\t.de-post-hid .de-btn-hide-user:after { content: "[+]"; }\t\t\t.de-btn-rep:after { content: "R"; }\t\t\t.de-btn-expthr:after { content: "E"; }\t\t\t.de-btn-fav:after { content: "F"; }\t\t\t.de-btn-fav-sel:after { content: "[F]"; }\t\t\t.de-btn-sage:after { content: "Sage!"; }\t\t\t.de-btn-src:after { content: "[Sauce]"; }':
(d+="padding: 0 14px 14px 0; }",b(".de-btn-hide-user","R0lGODlhDgAOAKIAAL//v6CgoICAgEtLS////wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAA4AQAM8SLLcS2MNQGsUMYi6uB5BKI5hFgojel5YBbDDNcmvpJLkcgLq1jcuSgPmgkUmlJgFAyqNmoEBJEatxggJADs="),b(".de-post-hid .de-btn-hide-user","R0lGODlhDgAOAKIAAP+/v6CgoICAgEtLS////wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAA4AQAM5SLLcS2ONCcCMIoYdRBVcN4Qkp4ULmWVV20ZTM1SYBJbqvXmA3jk8IMzlgtVYFtkoNCENIJdolJAAADs="),c="R0lGODlhDgAOAKIAAPDw8KCgoICAgEtLS////wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAA4AQAM",b(".de-btn-hide",
c+"8SLLcS2MNQGsUMYi6uB5BKI5hFgojel5YBbDDNcmvpJLkcgLq1jcuSgPmgkUmlJgFAyqNmoEBJEatxggJADs="),b(".de-post-hid .de-btn-hide",c+"5SLLcS2ONCcCMIoYdRBVcN4Qkp4ULmWVV20ZTM1SYBJbqvXmA3jk8IMzlgtVYFtkoNCENIJdolJAAADs="),b(".de-btn-rep",c+"4SLLcS2MNQGsUMQRRwdLbAI5kpn1kKHUWdk3AcDFmOqKcJ5AOq0srX0QWpBAlIo3MNoDInlAZIQEAOw=="),b(".de-btn-expthr",c+"7SLLcS6MNACKLIQjKgcjCkI2DOAbYuHlnKFHWUl5dnKpfm2vd7iyUXywEk1gmnYrMlEEyUZCSdFoiJAAAOw=="),b(".de-btn-fav",c+"5SLLcS2MNQGsUl1XgRvhg+EWhQAllNG0WplLXqqIlDS7lWZvsJkm92Au2Aqg8gQFyhBxAlNCokpAAADs="),
b(".de-btn-fav-sel","R0lGODlhDgAOAKIAAP/hAKCgoICAgEtLS////wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAA4AQAM5SLLcS2MNQGsUl1XgRvhg+EWhQAllNG0WplLXqqIlDS7lWZvsJkm92Au2Aqg8gQFyhBxAlNCokpAAADs="),b(".de-btn-sage","R0lGODlhDgAOAJEAAPDw8EtLS////wAAACH5BAEAAAIALAAAAAAOAA4AQAIZVI55duDvFIKy2vluoJfrD4Yi5lWRwmhCAQA7"),b(".de-btn-src",c+"9SLLcS0MMQMesUoQg6PKbtFnDaI0a53VAml2ARcVSFC0WY6ecyy+hFajnWDVssyQtB5NhTs1mYAAhWa2EBAA7"));a(".de-src-google","//google.ru/favicon.ico");a(".de-src-tineye","//tineye.com/favicon.ico");a(".de-src-iqdb",
"//iqdb.org/favicon.ico");a(".de-src-saucenao","//saucenao.com/favicon.ico");q&&(d+='.de-thread { counter-reset: i 1; }\t\t.de-ppanel-cnt:after { counter-increment: i 1; content: counter(i, decimal); vertical-align: 1px; color: #4f7942; font: italic bold 13px serif; cursor: default; }\t\t.de-ppanel-del:after { content: "'+Rd[h]+'"; color: #727579; font: italic bold 13px serif; cursor: default; }');d+="#de-txt-panel { display: block; height: 23px; font-weight: bold; cursor: pointer; }\t\t#de-txt-panel > span:empty { display: inline-block; width: 27px; height: 23px; }\t\t#de-txt-panel:lang(en) { display: none; }\t\t#de-txt-panel:lang(ru) { float: right; }";
c="R0lGODlhFwAWAJEAAPDw8GRkZAAAAP///yH5BAEAAAMALAAAAAAXABYAQAJ";b("#de-btn-bold:empty",c+"T3IKpq4YAoZgR0KqqnfzipIUikFWc6ZHBwbQtG4zyonW2Vkb2iYOo8Ps8ZLOV69gYEkU5yQ7YUzqhzmgsOLXWnlRIc9PleX06rnbJ/KITDqTLUAAAOw==");b("#de-btn-italic:empty",c+"K3IKpq4YAYxRCSmUhzTfx3z3c9iEHg6JnAJYYSFpvRlXcLNUg3srBmgr+RL0MzxILsYpGzyepfEIjR43t5kResUQmtdpKOIQpQwEAOw==");b("#de-btn-under:empty",c+"V3IKpq4YAoRARzAoV3hzoDnoJNlGSWSEHw7JrEHILiVp1NlZXtKe5XiptPrFh4NVKHh9FI5NX60WIJ6ATZoVeaVnf8xSU4r7NMRYcFk6pzYRD2TIUAAA7");b("#de-btn-strike:empty",
c+"S3IKpq4YAoRBR0qqqnVeD7IUaKHIecjCqmgbiu3jcfCbAjOfTZ0fmVnu8YIHW6lgUDkOkCo7Z8+2AmCiVqHTSgi6pZlrN3nJQ8TISO4cdyJWhAAA7");b("#de-btn-spoil:empty","R0lGODlhFwAWAJEAAPDw8GRkZP///wAAACH5BAEAAAIALAAAAAAXABYAQAJBlIKpq4YAmHwxwYtzVrprXk0LhBziGZiBx44hur4kTIGsZ99fSk+mjrMAd7XerEg7xnpLIVM5JMaiFxc14WBiBQUAOw==");b("#de-btn-code:empty",c+"O3IKpq4YAoZgR0KpqnFxokH2iFm7eGCEHw7JrgI6L2F1YotloKek6iIvJAq+WkfgQinjKVLBS45CePSXzt6RaTjHmNjpNNm9aq6p4XBgKADs=");b("#de-btn-quote:empty",c+"L3IKpq4YAYxRUSKguvRzkDkZfWFlicDCqmgYhuGjVO74zlnQlnL98uwqiHr5ODbDxHSE7Y490wxF90eUkepoysRxrMVaUJBzClaEAADs=");
k.La&&(d+="@keyframes de-open {\t\t\t\t0% { transform: translateY(-1500px); }\t\t\t\t40% { transform: translateY(30px); }\t\t\t\t70% { transform: translateY(-10px); }\t\t\t\t100% { transform: translateY(0); }\t\t\t}\t\t\t@keyframes de-close {\t\t\t\t0% { transform: translateY(0); }\t\t\t\t20% { transform: translateY(20px); }\t\t\t\t100% { transform: translateY(-4000px); }\t\t\t}\t\t\t@keyframes de-blink {\t\t\t\t0%, 100% { transform: translateX(0); }\t\t\t\t10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }\t\t\t\t20%, 40%, 60%, 80% { transform: translateX(10px); }\t\t\t}\t\t\t@keyframes de-cfg-open { from { transform: translate(0,50%) scaleY(0); opacity: 0; } }\t\t\t@keyframes de-cfg-close { to { transform: translate(0,50%) scaleY(0); opacity: 0; } }\t\t\t@keyframes de-post-open-tl { from { transform: translate(-50%,-50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-open-bl { from { transform: translate(-50%,50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-open-tr { from { transform: translate(50%,-50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-open-br { from { transform: translate(50%,50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-close-tl { to { transform: translate(-50%,-50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-close-bl { to { transform: translate(-50%,50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-close-tr { to { transform: translate(50%,-50%) scale(0); opacity: 0; } }\t\t\t@keyframes de-post-close-br { to { transform: translate(50%,50%) scale(0); opacity: 0; } }\t\t\t.de-pview-anim { animation-duration: .2s; animation-timing-function: ease-in-out; animation-fill-mode: both; }\t\t\t.de-open { animation: de-open .7s ease-out both; }\t\t\t.de-close { animation: de-close .7s ease-in both; }\t\t\t.de-blink { animation: de-blink .7s ease-in-out both; }\t\t\t.de-cfg-open { animation: de-cfg-open .2s ease-out backwards; }\t\t\t.de-cfg-close { animation: de-cfg-close .2s ease-in both; }");
a(".de-ytube-link","//youtube.com/favicon.ico");a(".de-img-arch","data:image/gif;base64,R0lGODlhEAAQALMAAF82SsxdwQMEP6+zzRA872NmZQesBylPHYBBHP///wAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAAkALAAAAAAQABAAQARTMMlJaxqjiL2L51sGjCOCkGiBGWyLtC0KmPIoqUOg78i+ZwOCUOgpDIW3g3KJWC4t0ElBRqtdMr6AKRsA1qYy3JGgMR4xGpAAoRYkVDDWKx6NRgAAOw==");a(".de-img-audio","data:image/gif;base64,R0lGODlhEAAQAKIAAGya4wFLukKG4oq3802i7Bqy9P///wAAACH5BAEAAAYALAAAAAAQABAAQANBaLrcHsMN4QQYhE01OoCcQIyOYQGooKpV1GwNuAwAa9RkqTPpWqGj0YTSELg0RIYM+TjOkgba0sOaAEbGBW7HTQAAOw==");
d+=".de-img-arch, .de-img-audio { color: inherit; text-decoration: none; font-weight: bold; }\t\t.de-img-pre, .de-img-full { display: block; margin: "+(e.f?0:"2px 10px")+"; border: none; outline: none; cursor: pointer; }\t\t.de-img-full { float: left; }\t\t.de-img-center { position: fixed; z-index: 9999; background-color: #ccc; border: 1px solid black; }\t\t.de-mp3, .de-ytube-obj { margin: 5px 20px; }\t\ttd > a + .de-ytube-obj { display: inline-block; }";a(".de-wait","data:image/gif;base64,R0lGODlhEAAQALMMAKqooJGOhp2bk7e1rZ2bkre1rJCPhqqon8PBudDOxXd1bISCef///wAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAAMACwAAAAAEAAQAAAET5DJyYyhmAZ7sxQEs1nMsmACGJKmSaVEOLXnK1PuBADepCiMg/DQ+/2GRI8RKOxJfpTCIJNIYArS6aRajWYZCASDa41Ow+Fx2YMWOyfpTAQAIfkEBQAADAAsAAAAABAAEAAABE6QyckEoZgKe7MEQMUxhoEd6FFdQWlOqTq15SlT9VQM3rQsjMKO5/n9hANixgjc9SQ/CgKRUSgw0ynFapVmGYkEg3v1gsPibg8tfk7CnggAIfkEBQAADAAsAAAAABAAEAAABE2QycnOoZjaA/IsRWV1goCBoMiUJTW8A0XMBPZmM4Ug3hQEjN2uZygahDyP0RBMEpmTRCKzWGCkUkq1SsFOFQrG1tr9gsPc3jnco4A9EQAh+QQFAAAMACwAAAAAEAAQAAAETpDJyUqhmFqbJ0LMIA7McWDfF5LmAVApOLUvLFMmlSTdJAiM3a73+wl5HYKSEET2lBSFIhMIYKRSimFriGIZiwWD2/WCw+Jt7xxeU9qZCAAh+QQFAAAMACwAAAAAEAAQAAAETZDJyRCimFqbZ0rVxgwF9n3hSJbeSQ2rCWIkpSjddBzMfee7nQ/XCfJ+OQYAQFksMgQBxumkEKLSCfVpMDCugqyW2w18xZmuwZycdDsRACH5BAUAAAwALAAAAAAQABAAAARNkMnJUqKYWpunUtXGIAj2feFIlt5JrWybkdSydNNQMLaND7pC79YBFnY+HENHMRgyhwPGaQhQotGm00oQMLBSLYPQ9QIASrLAq5x0OxEAIfkEBQAADAAsAAAAABAAEAAABE2QycmUopham+da1cYkCfZ94UiW3kmtbJuRlGF0E4Iwto3rut6tA9wFAjiJjkIgZAYDTLNJgUIpgqyAcTgwCuACJssAdL3gpLmbpLAzEQA7");
d+=".de-abtn { text-decoration: none !important; outline: none; }\t\t#de-alert { position: fixed; right: 0; top: 0; z-index: 9999; font: 14px arial; cursor: default; }\t\t#de-alert > div { float: right; clear: both; width: auto; min-width: 0pt; padding: 10px; margin: 1px; border: 1px solid grey; white-space: pre-wrap; }\t\t.de-alert-btn { display: inline-block; vertical-align: top; font-size: 150%; color: green; cursor: pointer; }\t\t.de-alert-msg { display: inline-block; margin-top: .25em; }\t\t.de-content { text-align: left; }\t\t.de-content textarea { display: block; margin: 2px 0; font: 12px courier new; "+
(k.e?"":"resize: none !important; ")+'}\t\t.de-content-block > a { color: inherit; font-weight: bold; }\t\t#de-content-fav, #de-content-hid { font-size: 16px; padding: 10px; border: 1px solid gray; }\t\t.de-editor { display: block; font: 12px courier new; width: 619px; height: 337px; }\t\t.de-entry { margin: 2px 0; }\t\t.de-entry > :first-child { float: none !important; }\t\t.de-entry > div > a { text-decoration: none; }\t\t.de-fav-inf-posts, .de-fav-inf-page { float: right; margin-right: 5px; font: bold 16px serif; }\t\t.de-fav-inf-old { color: #4f7942; }\t\t.de-fav-inf-new { color: blue; }\t\t.de-fav-title { margin-right: 15px; }\t\t#de-menu { padding: 0 !important; margin: 0 !important; width: auto; min-width: 0; z-index: 9999; border: 1px solid grey;}\t\t#de-menu span, #de-menu a { display: block; padding: 3px 10px; color: inherit; text-decoration: none; font: 13px arial; white-space: nowrap; cursor: pointer; }\t\t#de-menu span:hover, #de-menu a:hover { background-color: #222; color: #fff; }\t\t.de-omitted { color: grey; font-style: italic; }\t\t#de-parea { text-align: center;}\t\t.de-ref-hid { text-decoration: line-through !important; }\t\t.de-refmap { margin: 10px 4px 4px 4px; font-size: 70%; font-style: italic; }\t\t.de-refmap:before { content: "'+
Sd[h]+' "; }\t\t.de-refmap > a { text-decoration: none; }\t\t#de-sagebtn { margin-right: 7px; cursor: pointer; }\t\t.de-selected { '+(k.e?"border-left: 4px solid red; border-right: 4px solid red; }":"box-shadow: 6px 0 2px -2px red, -6px 0 2px -2px red; }")+'\t\t#de-txt-resizer { display: inline-block !important; float: none !important; padding: 6px; margin: -2px -12px; vertical-align: bottom; border-bottom: 2px solid #555; border-right: 2px solid #444; cursor: se-resize; }\t\t.de-viewed { color: #888 !important; }\t\t.de-pview { position: absolute; width: auto; min-width: 0; z-index: 9999; border: 1px solid grey; margin: 0 !important; display: block !important; }\t\t.de-pview-info { padding: 3px 6px !important; }\t\t.de-pview-link { font-weight: bold; }\t\t#de-iframe-pform, #de-iframe-dform, small[id^="rfmap"], div[id^="preview"], div[id^="pstprev"], body > hr, .theader, .postarea { display: none !important; }';
e.H?d+="#newposts_get, .extrabtns, .ui-resizable-handle, .replymode, blockquote + a { display: none !important; }\t\t\t.ui-wrapper { display: inline-block; width: auto !important; height: auto !important; padding: 0 !important; }":e.L&&(d+='#de-pform > div, .mentioned, form > div[style="text-align: center;"], form > div[style="text-align: center;"] + hr { display: none !important; }');e.f?d+='.de-post-hid > div:not(.postheader), img[id^="translate_button"], img[src$="button-expand.gif"], img[src$="button-close.gif"], body > center > hr, h2, form > div:first-of-type > hr { display: none !important; }\t\t\tdiv[id^="Wz"] { z-index: 10000 !important; }\t\t\t.de-thr-hid { margin-bottom: '+
(!q?"7":"2")+"px; }\t\t\t.file_reply + .de-ytube-obj, .file_thread + .de-ytube-obj { margin: 5px 20px 5px 5px; float: left; }\t\t\t.de-ytube-obj + div { clear: left; }":e.d?d+=".de-spoiler { color: #000; background-color: #000; }\t\t\t.de-post-hid > .file, .de-post-hid > blockquote, #mpostform, .navLinks, .postingMode { display: none !important; }":e.r?d+="form, form table { margin: 0; }\t\t\t.de-post-hid > .intro ~ *, .post-hover, div.banner { display: none !important; }":e.n?d+=".de-post-hid > .replyheader ~ *, .opqrbtn, .qrbtn, .ignorebtn, .hidethread, noscript, #content > hr { display: none !important; }\t\t\t.de-thr-hid { margin: 1em 0; }":
(d+=".de-post-hid > .de-ppanel ~ * { display: none !important; }",e.O?d+=".ABU_refmap, .postpanel, #CommentToolbar, #usrFlds + tbody > tr:first-child, #postform > div:nth-child(2), #BottomNormalReply, body > center { display: none !important; }\t\t\t\t#de-txt-panel { font-size: 16px !important; }\t\t\t\t.de-abtn { transition: none; }":e.W?d+='#postform nobr, .replieslist, #captcha_status, .postnode + a, .postblock + td > small, .content-background > hr, span[style="float: right;"] { display: none !important; }\t\t\t\t.ui-wrapper { position: static !important; margin: 0 !important; overflow: visible !important; }\t\t\t\t.ui-resizable { display: inline !important; }\t\t\t\tform textarea { resize: both !important; }':
e.j?d+="#hideinfotd, .reply_, .delete > img, .popup { display: none; }\t\t\t\t.delete { background: none; }\t\t\t\t.delete_checkbox { position: static !important; }\t\t\t\t.file + .de-ytube-obj { float: left; margin: 5px 20px 5px 5px; }\t\t\t\t.de-ytube-obj + div { clear: left; }":e.$?d+=".reply { background-color: "+getComputedStyle(m.body).getPropertyValue("background-color")+"; }":e.l?d+="span { font-size: inherit; }\t\t\t\t.de-content, .de-cfg-body { font-family: arial; }\t\t\t\t.ftbl { width: auto; margin: 0; }\t\t\t\t.reply { background: #f0e0d6; }":
e.F?d+=".de-ppanel { float: left; margin-top: 0.45em; }\t\t\t\ta + .threadlinktext { position: relative; top: 17px; }\t\t\t\t.postthreadlinks, .pagethreadlinks, .pwpostblock { display: none; }\t\t\t\t.de-btn-src { padding: 0px 10px 10px 0px !important; background-size: cover !important; }":e.Ja?d+="br.clear { display: none !important; }":e.Sb?d+="#bodywrap3 > hr, .blotter { display: none !important; }":e.ia&&(d+='span[id$="_display"] { display: none; }'));16>k.a&&(d=d.replace(/(transition|keyframes|transform|animation|linear-gradient)/g,
k.Fb+"$1"),k.e||(d=d.replace(/\(to bottom/g,"(top").replace(/\(to top/g,"(bottom")));U(dc(d),{id:"de-css"});U(dc(""),{id:"de-css-dynamic"});d=b=a=l;ia();J(w)}function ia(){var a;a=f.attachPanel?".de-content { position: fixed; right: 0; bottom: 25px; z-index: 9999; max-height: 95%; overflow-x: visible; overflow-y: auto; }\t\t#de-panel { position: fixed; right: 0; bottom: 0; }":".de-content { clear: both; float: left; }\t\t#de-panel { float: right; clear: both; }";a=3===f.addPostForm?a+"#de-qarea { position: fixed; right: 0; bottom: 25px; z-index: 9990; padding: 3px; border: 1px solid gray; }\t\t\t#de-qarea-target { font-weight: bold; }\t\t\t#de-qarea-close { float: right; color: green; font: bold 20px arial; cursor: pointer; }":
a+"#de-qarea { float: none; clear: left; width: 100%; padding: 3px 0 3px 3px; margin: 2px 0; }";f.panelCounter||(a+="#de-panel-info { display: none; }");f.expandPanel||(a+="#de-panel-btns, #de-panel-info { display: none; }");f.maskImgs&&(a+='.de-img-pre, .de-ytube-obj, img[src*="spoiler"], img[src*="thumb"], img[src^="blob"] { opacity: 0.07 !important; }\t\t\t.de-img-pre:hover, .de-ytube-obj:hover, img[src*="spoiler"]:hover, img[src*="thumb"]:hover, img[src^="blob"]:hover { opacity: 1 !important; }');
f.delHiddPost&&(a+=".de-thr-hid, .de-thr-hid + div + br, .de-thr-hid + div + br + hr { display: none; }");f.noPostNames&&(a+=".commentpostername, .postername, .postertrip { display: none; }");f.noSpoilers&&(a+=".spoiler, .de-spoiler { background: #888 !important; color: #ccc !important; }");f.noPostScrl&&(a+="blockquote, blockquote > p, .code_part { max-height: 100% !important; overflow: visible !important; }");f.noBoardRule&&(a+=(e.l?".chui":".rules, #rules, #rules_row")+" { display: none; }");e.O&&
(f.openImgs&&(a+=".reply .img { max-width: 200px; max-height: 200px; }\t\t\t\t.oppost .img { max-width: 250px; max-height: 250px }"),f.addYouTube&&(a+='div[id^="post_video"] { display: none !important; }'));p("de-css-dynamic").textContent=a}function ye(a,b){var c=f.scrUpdIntrv;if(!a){switch(c){case 0:c=1728E5;break;case 1:c=3456E5;break;case 2:c=12096E5;break;case 3:c=24192E5;break;default:c=5184E6}if(Date.now()-+Z.lastUpd<c)return}GM_xmlhttpRequest({method:"GET",url:"https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/master/Dollchan_Extension_Tools.meta.js",
headers:{"Content-Type":"text/plain"},onreadystatechange:function(c){if(4===c.readyState)if(200===c.status){var c=c.responseText.match(/@version\s+([0-9.]+)/)[1].split("."),e=yb.split("."),f=e.length>c.length?e.length:c.length,o=0,g=n;if(c){for(ya("lastUpd",Date.now());o<f;){if((+c[o]||0)>(+e[o]||0)){g=i;break}else if((+c[o]||0)<(+e[o]||0))break;o++}g?b('<a style="color: blue; font-weight: bold;" href="https://raw.github.com/SthephanShinkufag/Dollchan-Extension-Tools/master/Dollchan_Extension_Tools.user.js">'+
Td[h]+"</a>"):a&&b(Ud[h])}else a&&b('<div style="color: red; font-weigth: bold;">'+xa[h]+"</div>")}else a&&b('<div style="color: red; font-weigth: bold;">'+xa[h]+"</div>")}})}function gg(){if(/^(?:about|chrome|opera|res)/i.test(window.location))return n;if(!window.localStorage||!("object"===typeof localStorage&&window.sessionStorage))return GM_log("WEBSTORAGE ERROR: please, enable webstorage!"),n;hg();switch(window.name){case "de-iframe-pform":case "de-iframe-dform":return ob(('window.top.postMessage("J'+
window.name+"$#$"+Oe(m,i).join("$#$")+'", "*");').replace(/\n|\r/g,"\\n")),n;case "de-iframe-fav":var a=setInterval(function(){r(p("de-fav-script"));U(ob('window.top.postMessage("I'+(m.body.offsetHeight+5)+'", "*");'),{id:"de-fav-script"})},1500);P(window,{load:function(){setTimeout(function(){clearInterval(a);a=l},3E4)}});$a=i;g={}}if(e.j&&"/settings"===window.location.pathname)return P(m.querySelector('input[type="button"]'),{click:function(){m.cookie=escape("de-rating")+"="+escape(p("rating").value)+
";expires="+(new Date(Date.now()+1E12)).toGMTString()+";path=/"}}),n;if(!w||p("de-panel"))return n;ig();jg();return-1!==(Fa("DESU_Exclude")||"").indexOf(e.c)?n:i}function ig(){var a=window.navigator.userAgent;k={a:+(a.match(/mozilla.*? rv:(\d+)/i)||[,0])[1],e:window.opera?+window.opera.version():0,m:+(a.match(/WebKit\/([\d.]+)/i)||[,0])[1]};k.xa=k.m&&!/chrome/i.test(a);k.Da=!!k.a&&"function"===typeof GM_setValue;k.Ea=k.Da||!!Ca;k.Fb=k.m?"-webkit-":k.e?12.1>k.e?"-o-":"":k.a&&16>k.a?"-moz-":"";if(!k.e||
12<=k.e)k.La=i,k.ma=k.m?"webkitAnimationName":k.e&&12.1>k.e?"OAnimationName":k.a&&16>k.a?"MozAnimationName":"animationName",k.la=k.m?"webkitAnimationEnd":k.e&&12.1>k.e?"oAnimationEnd":"animationend",k.aa=function(a,c){a.addEventListener(k.la,function j(){this.removeEventListener(k.la,j,n);c(this);c=l},n)};k.fa=14<k.a||536<k.m;k.Gc=17<k.a||536<k.m;17<k.a&&ob('window["de-worker"] = function(url) {\t\t\t\tthis.wrk = new Worker(url);\t\t\t};\t\t\twindow["de-worker-proto"] = window["de-worker"].prototype = {\t\t\t\tset onmessage(Fn) {\t\t\t\t\tthis.wrk.onmessage = Fn;\t\t\t\t},\t\t\t\tset onerror(Fn) {\t\t\t\t\tthis.wrk.onerror = Fn;\t\t\t\t},\t\t\t\t_postMessage: function() {\t\t\t\t\tthis.wrk.postMessage.apply(this.wrk, arguments);\t\t\t\t}\t\t\t};');
k.ea=k.a&&8>k.a?function(a,c){L(a,D(c))}:function(a,c){a.insertAdjacentHTML("afterend",c)};k.fb=k.a&&8>k.a?function(a,c){X(a,D(c))}:function(a,c){a.insertAdjacentHTML("beforebegin",c)};k.forEach=k.m||k.a?function(a,c){Object.keys(a).forEach(c,a)}:function(a,c){for(var d in a)a.hasOwnProperty(d)&&c.call(a,d)};k.$a=k.xa?function(a){return"/"===a[1]?"http:"+a:"/"===a[0]?"http://"+e.host+a:a}:function(a){return a};k.s=k.e&&11.5>k.e?function(a,c){a.className+=" "+c}:function(a,c){a.classList.add(c)};k.Y=
k.e&&11.5>k.e?function(a,c){a.className=a.className.replace(RegExp("(?:^| )"+Wa(c)+"(?= |$)","g"),"")}:function(a,c){a.classList.remove(c)};k.ac=12<=k.a?function(a){return(new DOMParser).parseFromString(a,"text/html")}:function(a){var c=m.implementation.createHTMLDocument("");c.documentElement.innerHTML=a;return c}}function jg(){e.Ob&&(window.setTimeout=function(a,b){"function"===typeof a&&a.apply(l,na.slice.call(arguments,2));return 1});String.prototype.contains||(String.prototype.contains=function(a){return this.indexOf(a)!==
-1},String.prototype.bd=function(){return this.indexOf("#op ")===0});window.GM_log||(window.GM_log=function(a){console.error(a)});window.GM_xmlhttpRequest||(window.GM_xmlhttpRequest=ee);k.m&&(window.URL=window.webkitURL);17<k.a&&(window.ec=new Proxy(unsafeWindow["de-worker"],{}),window.ec.prototype.postMessage=function(){unsafeWindow["de-worker-proto"].fd.apply(this,arguments)})}function jf(a){if(!a||e.O&&t("locked",a))return{};var b=e.$?"li":"tr",c=".//"+b+'[not(contains(@style,"none"))]//input[not(@type="hidden") and ',
d=a.querySelector("#recaptcha_response_field");return{K:n,Sc:!e.r||!!q,A:q,form:a,T:d,k:a.querySelector('input[name*="aptcha"]:not([name="recaptcha_challenge_field"])')||d,g:a.querySelector(b+':not([style*="none"]) textarea:not([style*="display:none"])'),ta:a.querySelector(b+' input[type="submit"]'),file:a.querySelector(b+' input[type="file"]'),X:a.querySelector(b+' input[type="password"]'),Ac:w.querySelector('input[type="password"]'),Ca:W('.//tr[@id="trgetback"]|.//input[@type="radio" or @name="gotothread"]/ancestor::tr[1]',
a),name:W(c+'(@name="field1" or @name="name" or @name="internal_n" or @name="nya1" or @name="akane")]',a),Q:W(c+(e.ja?'@name="sage"]':'(@name="field2" or @name="em" or @name="sage" or @name="email" or @name="nabiki" or @name="dont_bump")]'),a),nb:W(c+'(@name="field3" or @name="sub" or @name="subject" or @name="internal_s" or @name="nya3" or @name="kasumi")]',a),wa:a.querySelector(b+' input[name="video"], '+b+' input[name="embed"]'),V:e.$?function(a){return W("ancestor::li[1]",a)}:function(a){return W("ancestor::tr[1]",
a)}}}function hg(){var a=window.location.hostname.match(/(?:(?:[^.]+\.)(?=org\.|net\.|com\.))?[^.]+\.[^.]+$|^\d+\.\d+\.\d+\.\d+$|localhost/)[0];switch(a){case "4chan.org":e.d=i;break;case "krautchan.net":e.f=i;break;case "britfa.gs":e.F=i;break;case "420chan.org":e.n=i;break;default:e.j=!!m.querySelector('script[src*="hanabira"]'),e.l=!!m.querySelector('form[action*="futaba.php"]'),e.r=!!m.querySelector('form[name*="postcontrols"]')}e.Ga=e.F?".threadz":e.j||e.f?'form[action*="delete"]':e.r?'form[name="postcontrols"]':
e.l?"form:not([enctype])":'#delform, form[name="delform"]';e.Aa=e.d||e.f||e.l||e.r?function(a){return a.querySelector('input[type="checkbox"]').name.match(/\d+/)[0]}:e.j||e.F?function(a){return a.querySelector("a[name]").name.match(/\d+/)[0]}:e.n?function(a){return a.querySelector("a[id]").id.match(/\d+/)[0]}:function(a){return a.querySelector('input[type="checkbox"]').value};if(w=m.querySelector(e.Ga)){e.H=!!m.querySelector('script[src*="kusaba"]');e.host=window.location.hostname;switch(e.c=a){case "0-chan.ru":case "0chan.hk":case "0chan.ru":e.W=
e.H=i;break;case "2--ch.ru":e.ia=i;break;case "410chan.ru":e.ja=i;break;case "hiddenchan.i2p":e.Ob=i;break;case "dfwk.ru":e.Gb=i;break;case "7chan.org":e.$=i;break;case "ponychan.net":e.Sb=i;break;case "mlpg.co":e.L=i;break;case "ernstchan.com":case "ernstchan.net":e.oa=i;break;default:e.O=!!p("ABU_css"),e.Ja=!!m.querySelector('form[action*="imgboard.php?delete"]')}e.$c=e.j||e.W||e.Ja||e.ia||"02ch.net"===a;e.u=e.f?"postreply":e.r||e.d?"post reply":"reply";e.vc=e.H?"postnode":e.d||e.L?"op":"oppost";
e.Vc=e.f?".thread_body":e.n?'[id*="thread"]':!e.oa&&m.querySelector(".thread")?".thread":m.querySelector('div[id*="_info"][style*="float"]')?'div[id^="t"]:not([style])':'[id^="thread"]'+(e.$?":not(#thread_controls)":"");e.ib=e.d?".postInfo > .postNum":e.r?".intro > .post_no + a":e.f?".postnumber":e.l?'.del, font[color="#117743"]':".reflink";e.v=e.j?".postbody":e.r?".body":e.$?".message":"blockquote";e.ba=e.d?"fileText":e.f||e.r||e.j||e.F?"fileinfo":"filesize";e.Tb=e.F?".fileinfo":e.f?".filename > a":
(e.l?"":"."+e.ba)+' a[href$=".jpg"]:nth-of-type(1), '+(e.l?"":"."+e.ba)+' a[href$=".png"]:nth-of-type(1), '+(e.l?"":"."+e.ba)+' a[href$=".gif"]:nth-of-type(1)';e.Ub=e.l?"form:nth-of-type(1)":e.d||e.r?'form[name="post"]':"#postform";e.zb=e.f?"postsubject":e.r||e.d?"subject":e.j?"replytitle":"filetitle";e.Uc=e.l?'font[color="#707070"]':e.f?".omittedinfo":e.j?".abbrev":e.d?".summary.desktop":".omittedposts";e.hb=e.f?".ban_mark":e.d?'strong[style="color: red;"]':n;e.Tc=(e.d?".deleteform.desktop > ":"")+
'input[type="submit"]';e.sa=e.f?"thread-":e.oa?"faden/":"res/";e.Xc=RegExp("^\\/?(.*?)\\/?(?:"+Wa(e.sa)+"|index|$)");e.Wc=RegExp(">https?:\\/\\/[^\\/]*"+e.c+"\\/([a-z0-9]+)\\/"+Wa(e.sa)+"(\\d+)(?:[^#<]+)?(?:#i?(\\d+))?<","g");e.J=function(a,c){return sb(a)+(e.l?"futaba.php?res="+c:e.sa+c+(e.ia?".html":Kb))};e.ca=function(a,c){return sb(a)+(0<c?e.oa?"wakaba.pl?task=show&page="+c:c+Kb:e.l?"futaba.htm":e.j?"index.xhtml":"")};e.Kb=e.j?function(a){a.previousElementSibling||(a=a.parentNode);return a.parentNode}:
e.f?function(a){return a.parentNode}:ca;e.cb=e.l?function(a){return a.querySelectorAll("td:nth-child(2)")}:e.r||e.d?function(a){return T("reply",a)}:function(a){return T(e.u,a)};e.Jb=e.F?function(a,c){var d,e=U(c.createElement("div"),{style:"clear: left;"}),f=t("originalpost",a);for(L(t("postmenu",f),e);"TABLE"!==(d=a.firstChild).tagName;)L(e,d),e=d;e=c.createElement("div");for(X(a.firstChild,e);d=f.firstChild;)e.appendChild(d);r(N("table",a));return e}:function(a,c){var d,j,f;if(j=t(e.vc,a))return j;
j=c.createElement("div");for(f=a.querySelector(e.Ha+', div[id^="repl"]');(d=a.firstChild)!==f;)j.appendChild(d);a.childElementCount?X(a.firstChild,j):a.appendChild(j);return j};e.pa=e.l?function(a){return N("input",a).name}:function(a){return a.id.match(/\d+/)[0]};e.Lb=e.d?function(a){return!!t("id_Heaven",a)}:e.f?function(a){return!!t("sage",a)}:e.ja?function(a){return!!W('.//span[@class="filetitle" and contains(text(),"'+unescape("%u21E9")+'")]',a)}:e.W?function(a){return!!a.querySelector('a[href="mailto:sage"], a[href^="http://cloudflare.com"]')}:
function(a){return(a=a.querySelector('a[href^="mailto:"], a[href="sage"]'))&&/sage/i.test(a.href)}}}function Bc(a,b,c,d){a.M=c;a.count=d;a.i=a.querySelector(e.v);a.P=Ia(a);a.Yb=e.Lb(a);a.setAttribute("de-post",b);H[a.b=b]=a}function kf(a,b,c){var d,j,f=n,h=a.querySelectorAll(e.Vc);if(2>y.length&&(e.Ha=e.d||e.L?".replyContainer":e.F?'div[id^="replies"] > table':e.ia?"table:not(.postfiles)":e.l||a.querySelector("td."+e.u)?"form > table, div > table":n,e.Ba=e.d||e.L?function(a){return a.parentNode}:
e.Ha?function(a){return a.p?a:W("ancestor::table[1]",a)}:function(a){return a},e.Ha&&(fb=a.querySelector(e.Ha))&&b!==m))fb=m.importNode(fb,i);if(0===h.length)for(d=N("hr",a).parentNode.firstChild;;){for(h=b.createElement("div");d&&(j=d.nextSibling)&&"HR"!==j.tagName;)h.appendChild(d),d=j;f?L(f,h):X(a.firstChild,h);if(!d||!j)return;h.childElementCount&&c(h);f=j;d=j.nextSibling}B(h,c)}function nf(a){try{B(a.getElementsByTagName("script"),r),kf(a,m,function(a){if(e.n||e.r)L(a,a.lastChild),r(t("clear",
a));var b,j=e.Jb(a,m),f=na.slice.call(e.cb(a)),h=f.length;Bc(j,a.b=e.Aa(j),a,0);j.p=i;j.ua=(t(e.zb,j)||{}).textContent||qa(j).substring(0,70).replace(/\s+/g," ");for(b=0;b<h;b++)Bc(f[b],e.pa(f[b]),a,b+1);y.push(j);ga.push(j);y=y.concat(f);k.s(a,"de-thread");a.R=h+fe(a)})}catch(b){return GM_log("DELFORM ERROR:\n"+(k.m?b.stack:b.name+": "+b.message+"\n"+(k.a?b.stack.replace(/^([^@]*).*\/(.+)$/gm,function(a,b,e){return"    at "+(b?b+" ("+e+")":e)}):b.stack))),n}a.removeAttribute("id");return i}function Ec(a){Ob&&
(a=Ob.Ec(a).Ib(a,l));if(e.d||e.f)a=a.replace(/(^|>|\s|&gt;)(https*:\/\/.*?)(?=$|<|\s)/ig,'$1<a href="$2">$2</a>');e.d&&f.noSpoilers&&(a=a.replace(/"spoiler">/g,'"de-spoiler">'));E.eb&&(a=E.replace(a));f.crossLinks&&(a=a.replace(e.Wc,function(a,c,d,e){return">&gt;&gt;/"+c+"/"+(e||d)+"<"}));return a}function Ac(a){e.jb&&(a.innerHTML=Ec(a.innerHTML));return a}function kg(){J(m.body);var a=w.outerHTML||(new XMLSerializer).serializeToString(w);$a?(k.fb(m.body.firstElementChild,a),w=m.body.firstElementChild,
P(window,{load:function(){for(;w.nextSibling;)r(w.nextSibling);J(m.body)}})):(k.fb(w,Ec(a)),w.style.display="none",w.id="de-dform-old",w=w.previousSibling,J(m.body),P(window,{load:function(){r(p("de-dform-old"))}}))}function of(a){if(e.O){var b;if(q&&(a=t("de-thread",a).nextSibling)){for(;b=a.nextSibling;)r(a),a=b;k.ea(a,"<hr/>")}}else if(e.F)for(var a=T("reflink",a),c=a.length-1;0<=c;c--)b=a[c].firstChild,b.onclick=l,b.href=e.J(x,b.textContent),b.target="_blank"}function xf(){la=i;f.favIcoBlink&&
Da&&(clearInterval(ib),B(m.head.querySelectorAll('link[rel="shortcut icon"]'),r),m.head.appendChild(s("link",{href:Da,rel:"shortcut icon"},l)));1===f.updThread&&setTimeout(function(){m.title=Qa},200)}function lg(){g=jf(m.querySelector(e.Ub));ba=m.querySelector('form[name="oeform"], form[action*="paint"]');q?(f.rePageTitle?(Qa="/"+x+" - "+H[q].ua,m.title=Qa):Qa=m.title,1===f.updThread&&(10<k.a||k.m?(m.addEventListener((k.m?"webkit":"moz")+"visibilitychange",function(){m.Ic||m.ed?la=n:xf()},n),la=!(m.Ic||
m.ed)):(window.onblur=function(){la=n},window.onfocus=xf,la=n,P(window,{mousemove:function b(){la=i;bc(window,{mousemove:b})}})),ue()),2===f.updThread&&L(t("de-thread",m),P(D('<span>[<a href="#">'+Vd[h]+"</a>]</span>"),{click:function(b){A(b);I(wa[h],"newposts",i);Bb(l)}}))):setTimeout(window.scrollTo,20,0,0);f.updScript&&ye(n,function(b){I(b,"updavail",n)})}function yf(){var a=gc=Date.now();if(gg()){cc=m.createElement("div");var b=(window.location.pathname||"").match(RegExp("^(?:\\/?([^\\.]*?)\\/?)?("+
Wa(e.sa)+")?(\\d+|index|wakaba|futaba)?(\\.(?:[a-z]+))?$"));x=b[1]||(e.Gb?"df":"");q=b[2]?b[3]:e.l?(window.location.search.match(/\d+/)||[n])[0]:n;Ya=b[3]&&!q?+(e.oa?(window.location.search.match(/\d+/)||[0])[0]:b[3])||0:0;Kb=e.d||e.oa?"":e.l?".htm":e.n?".php":b[4]||".html";Da=(m.querySelector('head link[rel="shortcut icon"]')||{}).href;M("initBoard");Z=ub("DESU_Config");f=Z[e.c]&&!pa(Z[e.c])?Z[e.c]:ie();if(!f&&(f={},k.Ea)){for(var c in Z.global)f[c]=Z.global[c];f.captchaLang=e.$c?2:1;f.timePattern=
f.timeOffset="";f.correctTime=0}f.__proto__=zb;k.fa||(f.preLoadImgs=0);if((!k.fa||k.xa)&&2===f.ajaxReply)f.ajaxReply=1;k.La||(f.animations=0);k.a||(zb.favIcoBlink=0);k.m?f.favIcoBlink=0:f.desktNotif=0;k.e&&(11.6>k.e&&2>f.scriptStyle&&(f.scriptStyle=2),12>k.e&&(f.YTubeTitles=0),2===f.YTubeType&&(f.YTubeType=1),f.updScript=0);15>f.updThrDelay&&(f.updThrDelay=15);f.saveSage||(f.sageReply=0);f.passwValue||(f.passwValue=Math.round(1E15*Math.random()).toString(32));f.stats||(f.stats={view:0,op:0,reply:0});
q&&f.stats.view++;ya(e.c,f);h=f.language;f.correctTime&&(Ob=new za(f.timePattern,f.timeOffset,h,sessionStorage.timeRPattern,sessionStorage.timeRPHash));e.j&&(e.Cc=new za("yyyy-nn-dd-hh-ii-ss",f.timeOffset||0,f.correctTime?h:1,"1_d _m _y (_w) _h:_i ",152203056));E=new K(!!f.hideBySpell);e.jb=e.d||e.f||Ob||E.eb||f.crossLinks;M("readCfg");if(e.jb||$a)kg(),M("replaceDelform");if(nf(w)){M("parseDelform");jc();M("readFavorites");f.keybNavig&&(Qf(),M("initKeyNavig"));of(w);$a||(lg(),M("initPage"),qe(),M("addPanel"),
b=v("div",{id:"de-parea"},[v("div",{id:"de-togglereply",style:"display: none;"},[S("["),s("a",{text:vd[h],href:"#","class":"de-abtn"},{click:se}),S("]")]),v("div",{id:"de-pform"},[g.form,ba]),m.createElement("hr")]),q&&1===f.addPostForm?L(e.d?N("hr",w):w,b):X(w,b),(q&&1<f.addPostForm||!q&&f.noThrdForm)&&J(b),k.ea(b,'<div id="de-qarea" class="'+e.u+'" style="display: none;"></div>'),3===f.addPostForm&&ea(p("de-qarea"),[D('<span id="de-qarea-target">'+wd[h]+' <a class="de-abtn"></a></span>'),s("span",
{id:"de-qarea-close",text:"\u00d7"},{click:Ha})]),e.ia&&(B(w.querySelectorAll('input[type="hidden"]'),r),w.appendChild(t("userdelete",m.body))),g.form?Ke(0,0,l):ba&&Ba(l,x,y[0].b,n,Ke),M("initPostform"));if(f.preLoadImgs||f.openImgs)vc(l),M("preloadImages");Uf();y.forEach(uc);wb(JSON.stringify(F));M("addPostButtons");f.expandImgs&&(y.forEach(Gb),M("eventPostImg"));f.expandPosts&&!q&&(y.forEach(Cc),M("expandPost"));f.addMP3&&(Db(l),M("addLinkMP3"));f.addYouTube&&(Cb(l),M("addLinksTube"));f.addImgs&&
(Eb(w),M("addLinkImg"));f.imgSrcBtns&&(Fb(w),M("addImgSearch"));2===f.linksNavig&&(yc(H),M("genRefMap"));f.linksNavig&&(eb(w),M("eventRefLink"));je();f.markViewed&&pe();pf();Ja();Ka();M("readPosts");ze();M("scriptCSS");qb.push(Wd[h]+(Date.now()-a)+"ms")}}}var yb="12.11.3.0",zb={language:0,hideBySpell:1,menuHiddBtn:1,hideRefPsts:0,delHiddPost:0,updThread:1,updThrDelay:60,favIcoBlink:1,desktNotif:0,expandPosts:2,expandImgs:2,maskImgs:0,preLoadImgs:0,findImgFile:0,openImgs:0,openGIFs:0,postBtnsTxt:0,
imgSrcBtns:1,noSpoilers:1,noPostNames:0,noPostScrl:1,keybNavig:0,correctTime:0,timeOffset:"",timePattern:"",linksNavig:2,linksOver:100,linksOut:1500,markViewed:0,strikeHidd:0,noNavigHidd:0,crossLinks:0,insertNum:1,addMP3:1,addImgs:1,addYouTube:3,YTubeType:0,YTubeWidth:360,YTubeHeigh:270,YTubeHD:0,YTubeTitles:0,ajaxReply:2,postSameImg:1,removeEXIF:1,removeFName:0,addPostForm:2,noThrdForm:1,favOnReply:1,addSageBtn:1,warnSubjTrip:0,saveSage:1,sageReply:0,captchaLang:1,addTextBtns:1,txtBtnsLoc:0,passwValue:"",
userName:0,nameValue:"",userSignat:0,signatValue:"",noBoardRule:1,noGoto:1,noPassword:1,scriptStyle:0,expandPanel:0,attachPanel:1,panelCounter:1,rePageTitle:1,animation:1,closePopups:0,updScript:1,scrUpdIntrv:1,textaWidth:500,textaHeight:160};ha={hideBySpell:["Заклинания: ","Magic spells: "],menuHiddBtn:["Дополнительное меню кнопок скрытия ",
"Additional menu of hide buttons"],hideRefPsts:["Скрывать ответы на скрытые посты*","Hide replies to hidden posts*"],delHiddPost:["Удалять скрытые посты","Delete hidden posts"],updThread:{q:[["Откл.","Авто","По клику"],
["Disable","Auto","On click"]],t:["AJAX обновление треда* ","AJAX thread update* "]},updThrDelay:[" (сек)"," (sec)"],favIcoBlink:["мигать фавиконом при новых постах*","Favicon blinking on new posts*"],desktNotif:["Уведомления на рабочем столе",
"Desktop notifications"],expandPosts:{q:[["Откл.","Авто","По клику"],["Disable","Auto","On click"]],t:["AJAX загрузка сокращенных постов*","AJAX upload of shorted posts*"]},expandImgs:{q:[["Откл.","В посте","По центру"],
["Disable","In post","By center"]],t:["раскрывать изображения ","expand images "]},preLoadImgs:["Предварительно загружать изображения*","Pre-load images*"],findImgFile:["Распознавать встроенные файлы в изображениях*",
"Detect built-in files in images*"],openImgs:["Раскрывать изображения","Open images"],openGIFs:["только GIFы","GIFs only"],postBtnsTxt:["Кнопки постов в виде текста*","Show post buttons as text*"],imgSrcBtns:["Добавлять кнопки для поиска изображений*",
"Add image search buttons*"],noSpoilers:["Открывать текстовые спойлеры","Open text spoilers"],noPostNames:["Скрывать имена в постах","Hide names in posts"],noPostScrl:["Без скролла в постах",
"No scroll in posts"],keybNavig:["Навигация с помощью клавиатуры* ","Navigation with keyboard* "],correctTime:["Корректировать время в постах* ","Correct time in posts* "],timeOffset:[" Разница во времени",
" Time difference"],timePattern:["Шаблон замены","Replace pattern"],linksNavig:{q:[["Откл.","Без карты","С картой"],["Disable","No map","With map"]],t:["навигация по >>ссылкам* ","navigation by >>links* "]},linksOver:[" задержка появления (мс)",
" delay appearance (ms)"],linksOut:[" задержка пропадания (мс)"," delay disappearance (ms)"],markViewed:["Отмечать просмотренные посты*","Mark viewed posts*"],strikeHidd:["Зачеркивать >>ссылки на скрытые посты",
"Strike >>links to hidden posts"],noNavigHidd:["Не отображать превью для скрытых постов","Don't show previews for hidden posts"],crossLinks:["Преобразовывать http:// в >>/b/ссылки*","Replace http:// with >>/b/links*"],insertNum:["Вставлять >>ссылку по клику на №поста*",
"Insert >>link on №postnumber click*"],addMP3:["Добавлять плейер к mp3-ссылкам* ","Add player to mp3-links* "],addImgs:["Загружать изображения к .jpg-, .png-, .gif-ссылкам*","Load images to .jpg-, .png-, .gif-links*"],addYouTube:{q:[["Ничего",
"Плейер по клику","Авто плейер","Превью+плейер","Только превью"],["Nothing","On click player","Auto player","Preview+player","Only preview"]],t:["к YouTube-ссылкам* ","to YouTube-links* "]},YTubeType:{q:[["Flash","HTML5 iframe",
"HTML5 video"],["Flash","HTML5 iframe","HTML5 video"]],t:["",""]},YTubeHD:["HD ","HD "],YTubeTitles:["Загружать названия к YouTube-ссылкам*","Load titles into YouTube-links*"],ajaxReply:{q:[["Откл.","Iframe","HTML5"],["Disable","Iframe","HTML5"]],t:["AJAX отправка постов*","posting with AJAX*"]},
postSameImg:["Возможность отправки одинаковых изображений","Ability to post same images"],removeEXIF:["Удалять EXIF из отправляемых JPEG-изображений",
"Remove EXIF from uploaded JPEG-images"],removeFName:["Удалять имя из отправляемых файлов","Remove names from uploaded files"],addPostForm:{q:[["Сверху","Внизу","В постах","Отдельная"],["At top","At bottom","Inline",
"Hanging"]],t:["форма ответа в треде* ","reply form in thread* "]},noThrdForm:["Прятать форму создания треда","Hide thread creating form"],favOnReply:["Добавлять тред в избранное при ответе",
"Add thread to favorites on reply"],addSageBtn:["Sage вместо поля E-mail* ","Sage button instead of E-mail field* "],warnSubjTrip:["Предупреждать при наличии трип-кода в поле тема","Warn if field subject contains trip-code"],saveSage:["запоминать сажу",
"remember sage"],captchaLang:{q:[["Откл.","Eng","Rus"],["Disable","Eng","Rus"]],t:["язык ввода капчи","language input in captcha"]},addTextBtns:{q:[["Откл.","Графич.","Упрощ.","Стандарт."],["Disable","As images","As text","Standard"]],t:["кнопки форматирования текста ",
"text format buttons "]},txtBtnsLoc:["внизу","at bottom"],userPassw:[" Постоянный пароль"," Fixed password"],userName:["Постоянное имя","Fixed name"],userSignat:["Постоянная подпись","Fixed signature"],noBoardRule:["правила ",
"rules "],noGoto:["поле goto ","goto field "],noPassword:["пароль","password"],excludeList:["Список адресов, запрещающих запуск скрипта:","Address list, that excludes script launch:"],scriptStyle:{q:[["Glass black","Glass blue","Solid grey"],["Glass black","Glass blue",
"Solid grey"]],t:["стиль скрипта","script style"]},attachPanel:["Прикрепить главную панель","Attach main panel"],panelCounter:["Счетчик постов/изображений на главной панели",
"Counter of posts/images on main panel"],rePageTitle:["Название треда в заголовке вкладки*","Thread title in page tab*"],animation:["CSS3 анимация в скрипте","CSS3 animation in script"],closePopups:["Автоматически закрывать уведомления",
"Close popups automatically"],updScript:["Автоматически проверять обновления скрипта","Check for script update automatically"],scrUpdIntrv:{q:[["Каждый день","Каждые 2 дня","Каждую неделю",
"Каждые 2 недели","Каждый месяц"],["Every day","Every 2 days","Every week","Every 2 week","Every month"]],t:["интервал проверки","check interval"]},language:{q:[["Ru","En"],["Ru","En"]],t:["",""]}};Gd={bold:["Жирный","Bold"],italic:["Наклонный",
"Italic"],under:["Подчеркнутый","Underlined"],strike:["Зачеркнутый","Strike"],spoil:["Спойлер","Spoiler"],code:["Код","Code"],quote:["Цитировать выделенное","Quote selected"]};Kc={filters:["Фильтры","Filters"],
posts:["Посты","Posts"],links:["Ссылки","Links"],form:["Форма","Form"],common:["Общее","Common"],info:["Инфо","Info"]};Rb={settings:["Настройки","Settings"],hidden:["Скрытое","Hidden"],favor:["Избранное","Favorites"],refresh:["Обновить",
"Refresh"],goback:["Назад","Go back"],gonext:["Следующая","Next"],goup:["Наверх","To the top"],godown:["В конец","To the bottom"],newthr:["Создать тред","New thread"],expimg:["Раскрыть картинки","Expand images"],maskimg:["Маскировать картинки",
"Mask images"],"upd-on":["Автообновление треда","Thread autoupdate"],"audio-off":["Звуковое оповещение о новых постах","Sound notification about new posts"],catalog:["Каталог","Catalog"],counter:["Постов/Изображений в треде",
"Posts/Images in thread"]};qd={sel:["Скрывать выделенное","Hide selected text"],trip:["Скрывать трип-код","Hide with trip-code"],img:["Скрывать изображение","Hide with image"],ihash:["Скрывать схожие изобр.",
"Hide similar images"],text:["Скрывать схожий текст","Hide similar text"],noimg:["Скрывать без изображений","Hide without images"],notext:["Скрывать без текста","Hide without text"]};rd=[["5 постов",
"15 постов","30 постов","50 постов","100 постов"],["5 posts","15 posts","30 posts","50 posts","100 posts"]];sd=[["1 страница","2 страницы","3 страницы","4 страницы","5 страниц"],["1 page",
"2 pages","3 pages","4 pages","5 pages"]];td=[["Каждые 30 сек.","Каждую минуту","Каждые 2 мин.","Каждые 5 мин."],["Every 30 sec.","Every minute","Every 2 min.","Every 5 min."]];Oc=['"Ctrl+Влево" - предыдущая страница,\n"Ctrl+Вправо" - следующая страница.\n\nНа доске:\n"J" - тред ниже,\n"K" - тред выше,\n"N" - пост ниже,\n"M" - пост выше,\n"V" - вход в тред.\n\nВ треде:\n"J" - пост ниже,\n"K" - пост выше,\n"V" - быстрый ответ',
'"Ctrl+Left" - previous page\n"Ctrl+Right" - next page.\n\nOn board:\n"J" - thread below,\n"K" - thread above,\n"N" - post below,\n"M" - post above,\n"V" - enter a thread.\n\nIn thread:\n"J" - post below,\n"K" - post above,\n"V" - quick reply.'];Jd=["янв,фев,мар,апр,мая,июн,июл,авг,сен,окт,ноя,дек".split(","),"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",")];
Kd=["января,февраля,марта,апреля,мая,июня,июля,августа,сентября,октября,ноября,декабря".split(","),"January,February,March,April,May,June,July,August,September,October,November,December".split(",")];
Id=["Вск,Пнд,Втр,Срд,Чтв,Птн,Сбт".split(","),"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",")];Yc={gd:["Редактирование настроек:","Edit settings:"],hidden:["Редактирование скрытых тредов:",
"Edit hidden threads:"],hd:["Редактирование избранного:","Edit favorites:"]};Lc=["Добавить","Add"];Mc=["Применить","Apply"];kb=["Очистить","Clear"];Nc=["Помощь","Help"];Ad=["Обновить","Refresh"];
ad=["Загрузить","Load"];lb=["Сохранить","Save"];Wc=["Правка","Edit"];ed=["Сброс","Reset"];Wb=["Удалить","Remove"];md=["Инфо","Info"];Vb=["Отмена","Undo"];wa=["Загрузка...","Loading..."];Sb=["Проверка...",
"Checking..."];Zb=["Удаление...","Deleting..."];mb=["Ошибка:","Error:"];xa=["Ошибка подключения","Connection failed"];Od=["Тред недоступен (№","Thread is unavailable (№"];Dd=["Успешно удалено!","Succesfully deleted!"];
Ed=["Не могу удалить:\n","Can't delete:\n"];Xd=["Неправильные настройки времени","Invalid time settings"];cd=["Глобальные настройки не найдены","Global config not found"];
$b=["Пост не найден","Post not found"];Bd=["Загрузить капчу","Load captcha"];Pd=["В треде %m непрочитанных сообщений.","There are %m unreaded messages in thread."];Pc=["Не отображать: ",
"Do not show: "];Qc=["Проверить сейчас","Check now"];Td=["Доступно обновление!","Update available!"];Ud=["У вас стоит самая последняя версия!","You have latest version!"];Rc=["Версия: ",
"Version: "];Sc=["Тредов просмотрено: ","Threads viewed: "];Tc=["Тредов создано: ","Threads created: "];Uc=["Постов: ","Posts: "];Wd=["Всего: ","Total: "];Vc=["Отладка","Debug"];Tb=["Информация для отладки",
"Information for debugging"];bd=["Загрузить глобальные настройки","Load global settings"];dd=["Сохранить настройки как глобальные","Save settings as global"];Xc=["Правка в текстовом формате",
"Edit in text format"];fd=["Сбросить в настройки по умолчанию","Reset settings to defaults"];gd=["Данное действие удалит все ваши настройки и закладки. Продолжить?",
"This will delete all your preferences and favourites. Continue?"];Xb=["Удалить выделенные записи","Remove selected notes"];Zc=["Сохранить внесенные изменения","Save your changes"];nd=["Обновить счетчики постов",
"Refresh posts counters"];od=["Проверить актуальность тредов (до 5 страницы)","Check for threads actuality (up to 5 page)"];pd=["Очистить записи недоступных тредов",
"Clear notes of inaccessible threads"];hd=["Скрытые посты на странице","Hidden posts on page"];kd=["Скрытые треды","Hidden threads"];id=["На этой странице нет скрытых постов...","No hidden posts on this page..."];
jd=["Нет скрытых тредов...","No hidden threads..."];Ub=["Раскрыть все","Expand all"];$c=["Некорректный формат данных","Incorrect data format"];ld=["Нет избранных тредов...",
"Favorites is empty..."];Ld=["Ответ","Reply"];wd=["Ответ в","Reply to"];Sd=["Ответы:","Replies:"];Md=["Пропущено ответов: ","Posts omitted: "];Nd=["Свернуть тред","Collapse thread"];Rd=["удалён","deleted"];Vd=["Получить новые посты",
"Get new posts"];Yb=["Страница","Page"];Qd=["Скрытый тред:","Hidden thread:"];vd=["Раскрыть форму","Expand form"];ud=["Искать в ","Search in "];zd=["Ждите","Wait"];xd=["+ файл","+ file"];yd=["Добавить .ogg, .rar, .zip, или .7z к картинке",
"Add .ogg, .rar, .zip, or .7z to image "];Hd=["Скачать содержащийся в картинке файл","Download existing file from image"];Fd=["Файл повреждён: ","File is corrupted: "];Cd=['Поле "Тема" содержит трипкод',
'"Subject" field contains tripcode'];ma=["синтаксическая ошибка","syntax error"];Yd=["неизвестный спелл: ","unknown spell: "];ac=["пропущен оператор","missing operator"];Zd=["ошибка преобразования %1 в число",
"can't convert %1 to number"];$d=["синтаксическая ошибка в регулярном выражении: ","syntax error in regular expression: "];ae=["неожиданный символ ","unexpected character "];be=["пропущена открывающаяся скобка",
"missing ( in parenthetical"];ce=["пропущена закрывающаяся скобка","missing ) in parenthetical"];Ea=[" (строка "," (row "];Ua=[", столбец ",", column "];var m=window.document,na=Array.prototype,f,Z,La,$,F,H={},y=[],ga=[],V,O,e={},k,x,q,Ya,Kb,Qa,g,w,ba,cc,fb,E,Pb,R;Qb=[];va={};jb=ua=l;Da="";ib=l;
Sa=la=n;Ta=l;hb=Ra=n;var gc,qb=[],Ob,xb,h,Pa="",$a,Za;rb.prototype={Ia:function(a){var b=this.na;b===this.Hc?(this.yb.push(a),this.length++):(this.na++,this.ab(b,a))},end:function(){this.na--;0!==this.length?(this.length--,this.Ia(this.yb.splice(0,1)[0])):this.Eb&&0===this.na&&this.Hb()},complete:function(){0===(this.length|this.na)?this.Hb():this.Eb=i}};Ue.prototype={ic:function(a,b){b(this(a))},Nc:function(a,b){this.S.end();a(b.data)},mc:function(a,b){this.S.end();a(b)},jc:function(a,b){this.S.Ia([a,
this.Nc.bind(this,b)])},gc:function(a,b){var c=this.pb[a];c.onmessage=b[1];c.onerror=this.Mc;c.postMessage(b[0],l,[b[0]])},clear:function(){this.pb=l;window.URL.revokeObjectURL(this.url)}};za.cd=function(a){if(a.checked&&(!/^[+-]\d{1,2}$/.test(f.timeOffset)||za.Bb(f.timePattern)))I(Xd[h],"err-correcttime",n),Q("correctTime",0),a.checked=n};za.Bb=function(a){return!a.contains("i")||!a.contains("h")||!a.contains("d")||!a.contains("y")||!(a.contains("n")||a.contains("m"))||/[^\?\-\+sihdmwny]|mm|ww|\?\?|([ihdny]\?)\1+/.test(a)};
za.prototype={Ec:function(a){if(this.Pb||this.disabled)return this;var b,c,d,e=1,f=0,h=a.match(RegExp(this.Xb));if(!h)return this.disabled=i,this;this.ra="";for(d=h[0];c=h[e++];){if("m"===(b=this.pattern[e-2]))this.bb=3<c.length;a=d.indexOf(c,f);this.ra+=d.substring(f,a)+"_"+b;f=a+c.length}sessionStorage.timeRPHash=Xa(sessionStorage.timeRPattern=(this.bb?"1":"0")+this.ra);this.Pb=i;return this},Ib:function(a){function b(a){return 10>a?"0"+a:a}if(this.disabled)return a;var c=this.uc,d=this.bb?this.sc:
this.tc,e=this.pattern,f=this.ra,h=this.zc,a=a.replace(RegExp(this.Xb,"g"),function(){var a,g,k,m,p,q,r,s,t;for(a=1;8>a;a++)g=arguments[a],k=e[a-1],"s"===k?m=g:"i"===k?p=g:"h"===k?q=g:"d"===k?r=g:"n"===k?s=g-1:"y"===k?t=g:"m"===k&&(s=/^янв|^jan/i.test(g)?0:/^фев|^feb/i.test(g)?1:/^мар|^mar/i.test(g)?2:/^апр|^apr/i.test(g)?3:/^май|^may/i.test(g)?4:/^июн|^jun/i.test(g)?5:/^июл|^jul/i.test(g)?6:/^авг|^aug/i.test(g)?
7:/^сен|^sep/i.test(g)?8:/^окт|^oct/i.test(g)?9:/^ноя|^nov/i.test(g)?10:/^дек|^dec/i.test(g)&&11);a=new Date(2===t.length?"20"+t:t,s,r,q,p,m||0);a.setHours(a.getHours()+h);return f.replace("_s",b(a.getSeconds())).replace("_i",b(a.getMinutes())).replace("_h",b(a.getHours())).replace("_d",b(a.getDate())).replace("_w",c[a.getDay()]).replace("_n",b(a.getMonth()+1)).replace("_m",d[a.getMonth()]).replace("_y",2===t.length?(""+a.getFullYear()).substring(2):
a.getFullYear())}),c=d=e=f=h=b=l;return a}};wc.prototype={Kc:function(a){a[0].textContent=a[0].textContent.replace(/^http:\/\/youtu/,"https://youtu")},ad:function(){sessionStorage["de-yt-titles"]=JSON.stringify(this.Ka)},Zb:function(){this.S&&this.S.complete()},gb:function(a){var b=this.Ka[a[1]];b?this.$b(a[0],b):this.S.Ia(a)},$b:function(a,b){b?(a.textContent=b,a.va=2):a.va=1;a.mb&&(a.mb(b),a.mb=l)},loaded:function(a,b){if(4===b.readyState){var c;if(200===b.status)try{c=JSON.parse(b.responseText).entry.title.$t,
this.Ka[a[1]]=c}catch(d){}this.$b(a[0],c);this.S.end()}},lc:function(a,b){GM_xmlhttpRequest({method:"GET",url:"https://gdata.youtube.com/feeds/api/videos/"+b[1]+"?alt=json&fields=title/text()",onreadystatechange:this.loaded.bind(this,b)})}};K.Ab=function(a,b){var c,d;d=a[0];for(c=d.length-1;0<=c;c--)if(d[c]===b)return i;d=a[1];for(c=d.length-1;0<=c;c--)if(b>=d[c][0]&&b<=d[c][1])return i;return n};K.ha=function(a,b,c,d,e,f,h,g){b=E.Ma(c,h);b===l?E.rb(a,d,e,f,g):b?(d=d.pop(),e(a,E.Qa(d[2][d[0]-1]),
g)):f&&f(a,g)};K.prototype={Sa:"words,exp,exph,imgn,ihash,subj,name,trip,img,sage,op,tlen,all,video,wipe,num".split(","),tb:[function(a,b){var c;return qa(a).toLowerCase().contains(b)||(c=a.querySelector(".replytitle, .filetitle"))&&c.textContent.toLowerCase().contains(b)},function(a,b){return b.test(qa(a))},function(a,b){return b.test(a.innerHTML)},function(a,b){var c=t(e.ba,a);return c&&b.test(c.textContent)},function(a,b){return a.P[0]&&Ce(a)===b},function(a,b){var c=a.querySelector(".replytitle, .filetitle");
return!c||!(c=c.textContent)?n:!b||b.test(c)},function(a,b){var c=a.querySelector(".commentpostername, .postername");return!c||!(c=c.textContent)?n:!b||c.contains(b)},function(a,b){var c=t("postertrip",a);return!c?n:!b||c.textContent.contains(b)},function(a,b){if(!a.P[0])return n;if(b){var c,d,e;if(c=b[1]){e=ge(a);switch(b[0]){case 0:d=e>=c[0]&&e<=c[1];break;case 1:d=e<c[0];break;case 2:d=e>c[0]}if(d){if(!b[2])return i}else return n}if(c=b[2])switch(d=hc(a),e=+d[0],d=+d[1],b[0]){case 0:return e>=
c[0]&&e<=c[1]&&d>=c[2]&&d<=c[3];case 1:return e<c[0]&&d<c[3];case 2:return e>c[0]&&d>c[3]}}return i},function(a){return a.Yb},function(a){return a.p},function(a,b){var c=qa(a);return!b?!!c:K.Ab(b,c.replace(/\n/g,"").length)},function(){return i},function(a,b){var c=na.slice.call(arguments);if(b)if(!a.qb||!f.YTubeTitles)K.ha.apply(l,c.concat(n,n));else{var d,e,h=T("de-ytube-link",a),g=h.length;a.Z=g;for(e=0;e<g;e++)if(d=h[e],2===d.va){if((d=d.textContent)&&b.test(d)){K.ha.apply(l,c.concat(i,n));a.Z=
l;c[0]=n;return}a.Z--}else 1===d.va?a.Z--:d.mb=Zf.bind(c);0===a.Z&&(K.ha.apply(l,c.concat(n,n)),a.Z=l)}else K.ha.apply(l,c.concat(!!a.qb,n))},function(a,b){var c,d,e,f,h,g,k,m,p=qa(a);if(b&1&&(c=p.replace(/>/g,"").split(/\s*\n\s*/),5<(d=c.length))){c.sort();e=0;for(h=d/4;e<d;){g=c[e];for(f=0;c[e++]===g;)f++;if(4<f&&f>h&&g)return K.D='same lines: "'+g.substr(0,20)+'" x'+f,i}}if(b&2&&(c=p.replace(/[\s\.\?\!,>]+/g," ").toUpperCase().split(" "),3<(d=c.length))){c.sort();e=0;h=d/4;for(m=k=0;e<d;k++){g=
c[e];for(f=0;c[e++]===g;)f++;if(25<d&&(f>m&&2<g.length&&(m=f),m>=h))return K.D='same words: "'+g.substr(0,20)+'" x'+m,i}g=k/d;if(0.25>g)return K.D="uniq words: "+(100*g).toFixed(0)+"%",i}if(b&4&&(c=p.replace(/https*:\/\/.*?(\s|$)/g,"").replace(/[\s\.\?!,>:;-]+/g," ").split(" "),50<c[0].length||1<(d=c.length)&&10<c.join("").length/d))return K.D="long words",i;if(b&8&&(c=p.replace(/\s+/g,""),30<(d=c.length)&&0.4<(g=c.replace(/[0-9a-zа-я\.\?!,]/ig,"").length/d)))return K.D="specsymbols: "+
(100*g).toFixed(0)+"%",i;if(b&16&&(c=p.replace(/[\s\.\?!;,-]+/g," ").trim().split(" "),4<(d=c.length))){for(k=f=h=e=0;e<d;e++)g=c[e],5>(g.match(/[a-zа-я]/ig)||[]).length||(2<(g.match(/[A-ZА-Я]/g)||[]).length&&k++,g===g.toUpperCase()&&f++,h++);if(0.3<=f/h&&4<h)return K.D="CAPSLOCK: "+100*(f/c.length)+"%",i;if(0.3<=k/h&&8<h)return K.D="cAsE words: "+100*(k/c.length)+"%",i}return b&32&&(c=p.replace(/\s+/g," ").replace(/>>\d+|https*:\/\/.*?(?: |$)/g,""),30<(d=c.length)&&0.4<(g=(d-
c.replace(/\d/g,"").length)/d))?(K.D="numbers: "+Math.round(100*g)+"%",i):K.D=n},function(a,b){return K.Ab(b,a.count+1)}],Xa:function(a,b){var c=a.lastIndexOf("/"),d=a.substr(c+1);return RegExp(a.substr(1,c-1),b?d.replace("g",""):d)},nc:function(a,b,c){if(2===this.o||4===this.o)return this.z=ac[h],this.C=0;var d,e,f,g,k=b.substr(c+1).match(/^([a-z]+)(?:\[([a-z0-9]+)(?:(,)|,(\s*[0-9]+))?\])?/);if(!k)return this.z=ma[h],this.C=0;e=this.Sa.indexOf(k[1]);this.o=2;if(-1===e)return this.z=Yd[h]+k[1],this.C=
1,0;this.ka?(f=e|256,this.ka=n):f=e;d=k[2]&&[k[2],k[4]?k[4]:k[3]?-1:n];b=b.substr(c+1+k[0].length);g="("!==b[0]?0:")"===b[1]?2:n;c=g!==n;switch(e){case 4:if(b=!c&&b.match(/^\((?:(\d+)|(.*?))\)/)){if(b[1])return a.push([f,+b[1],d]),k[0].length+b[0].length;this.z=Zd[h].replace("%1",b[2])}else this.z=ma[h];this.C=k[0].length;return 0;case 8:if(c)return a.push([f,"",d]),k[0].length+g;b=b.match(/^\(([><=])(?:(\d+(?:\.\d+)?)(?:-(\d+(?:\.\d+)?))?)?(?:@(\d+)(?:-(\d+))?x(\d+)(?:-(\d+))?)?\)/);if(!b||!b[2]&&
!b[4])return this.z=ma[h],this.C=k[0].length,0;a.push([f,["="===b[1]?0:"<"===b[1]?1:2,b[2]&&[+b[2],b[3]?+b[3]:+b[2]],b[4]&&[+b[4],b[5]?+b[5]:+b[4],+b[6],b[7]?+b[7]:+b[6]]],d]);return k[0].length+b[0].length;case 14:if(c)return a.push([f,63,d]),k[0].length+g;if(b=b.match(/^\(([a-z, ]+)\)/))if(g=0,!b[1].split(/, */).some(function(a){switch(a){case "samelines":g=g|1;return n;case "samewords":g=g|2;return n;case "longwords":g=g|4;return n;case "symbols":g=g|8;return n;case "capslock":g=g|16;return n;
case "numbers":g=g|32;return n;default:return i}}))return a.push([f,g,d]),k[0].length+b[0].length;this.z=ma[h];this.C=k[0].length;return 0;case 11:if(c)return a.push([f,"",d]),k[0].length+g;case 15:if(b=!c&&b.match(/^\(([\d-, ]+)\)/))return b[1].split(/, */).forEach(function(a){if(a.contains("-")){a=a.split("-");a[0]=+a[0];a[1]=+a[1];this[1].push(a)}else this[0].push(+a)},g=[[],[]]),a.push([f,g,d]),k[0].length+b[0].length;this.z=ma[h];this.C=k[0].length;return 0;case 13:case 5:if(c)return a.push([f,
"",d]),k[0].length+g;case 1:case 2:case 3:b=!c&&b.match(/^\((\/.*?[^\\]\/[ig]*)\)/);if(!b)return this.z=ma[h],this.C=k[0].length,0;g=b[1];try{this.Xa(g,i)}catch(m){return this.z=$d[h]+g,this.C=k[0].length,0}a.push([f,g,d]);return k[0].length+b[0].length;case 7:case 9:case 10:case 12:if(c)return a.push([f,"",d]),k[0].length+g;default:b=b.match(/^\((.*?[^\\])\)/);if(!b)return this.z=ma[h],this.C=0,n;g=b[1].replace(/\\\)/g,")");a.push([f,0===e?g.toLowerCase():g,d]);return k[0].length+b[0].length}},qc:function(a,
b){if(2===b){if(!this.o||3===this.o)return this.o=1,this.ka=i}else if(2===this.o||4===this.o)return this.o=0,1===b&&(a[a.length-1][0]|=512),i;return n},fc:function(a){if(!a)return l;this.o=this.ka=l;for(var b,c=[],d=[],e=c,f=0,g=1,k=1,m=0,p=a.length;m<p;m++,g++)switch(a[m]){case "\n":k++,g=0;case "\r":case " ":continue;case "#":b=this.nc(e,a,m);if(0===b)return this.N=this.z+Ea[h]+k+Ua[h]+(g+this.C)+")",n;m+=b;g+=b;break;case "(":if(2===this.o||4===this.o)return this.N=ac[h]+Ea[h]+k+Ua[h]+g+")",n;
d.push(e);e.push([this.ka?511:255,[]]);e=e[e.length-1][1];f++;this.o=3;this.ka=n;break;case ")":if(0<f)e=d.pop(),f--;else return this.N=be[h]+Ea[h]+k+Ua[h]+g+")",n;this.o=4;break;case "|":case "&":case "!":if(this.qc(e,"|"===a[m]?0:"&"===a[m]?1:2))break;default:return this.N=ae[h]+a[m]+Ea[h]+k+Ua[h]+g+")",n}return 2!==this.o&&4!==this.o?(this.N=ma[h]+Ea[h]+k+")",n):0<f?(this.N=ce[h]+Ea[h]+k+")",n):0===c.length?l:c},Na:function(a,b,c,d){var e=0!==(b&256);if(c===d-1){if(0===c)return e?[[12,"",l]]:l;
b=a.length-1;if(e){for(;a[b]&&0===(a[b][0]&512);)delete a[b],b-=2;a[b]&&(a[b][0]&=511);if(0>b)return[[12,"",l]]}else{for(;a[b]&&0!==(a[b][0]&512);)delete a[b],b-=2;if(0>b)return l}return 1===a.length&&255===a[0][0]?a[0][1]:a}if(0!==(b&512)){if(!e)return l}else if(e)return[[12,"",l]];return n},Ua:function(a){for(var b=0,c=a.length,d=[],e,f,g;b<c;b++){f=a[b];e=f[0]&255;if(255===e)if(g=this.Ua(f[1])){1===g.length?(g=g[0],g[0]|=f[0]&512,g[0]^=f[0]&256,d.push(g)):d.push([f[0],g]);continue}else g=this.Na(d,
f[0],b,c);else if((g=f[2])&&(g[0]!==x||(-1===g[1]?q:g[1]&&g[1]!==q)))g=this.Na(d,f[0],b,c);else if(12===e)g=this.Na(d,f[0]^256,b,c);else{d.push(f);continue}if(g!==n)return g}return 0===d.length?l:1===d.length&&255===d[0][0]?d[0][1]:d},kc:function(a){a&&a.forEach(function c(a){var e=a[1];if(e)switch(a[0]&255){case 1:case 2:case 3:case 5:case 13:a[1]=this(e,i);break;case 255:e.forEach(c,this)}},this.Xa);return a},Ma:function(a,b){0!==(a&256)&&(b=!b);if(0!==(a&512)){if(!b)return n}else if(b)return i;
return l},Qa:function(a){var b=a[0]&255,c=a[1];if(255===b)return this.Qa(c[this.vb]);a=0!==(a[0]&256)?"!":"";return 14===b?a+("#wipe"+(K.D?": "+K.D:"")):a+("#"+this.Sa[b]+(c?": "+c:""))},rb:function(a,b,c,d,e){var f,g;g=n;f=b.pop();for(var h=f[0],k=f[1],m=f[2];;){if(h<k){g=m[h][0];f=g&255;if(255===f){b.push([h,k,m]);m=m[h][1];k=m.length;h=0;continue}else if(13===f){b.push([h+1,k,m]);this.tb[f](a,m[h][1],g,b,c,d);break}else f=this.tb[f](a,m[h][1]);g=this.Ma(g,f);if(g===l){h++;continue}this.vb=h}else this.vb=
h-=1,g=n;if(f=b.pop())if(h=f[0],k=f[1],m=f[2],g=this.Ma(m[h][0],g),g===l){h++;continue}g?c(a,this.Qa(m[h]),e):d&&d(a,e);break}},pc:function(a,b,c){this.rb(a,[[0,this.Wa.length,this.Wa]],function(a,c,e){b(a,c);e&&(clearTimeout(Pb),Pb=setTimeout(Ja,500))},c&&function(a,b){c(a);b&&(clearTimeout(Pb),Pb=setTimeout(Ja,500))},n)},Pa:function(a,b,c){c&&c(a)},hc:function(a){var b=[],c=[],d="",a=a.replace(/([^\\]\)|^)?[\n\s]*(#rep(?:\[([a-z0-9]+)(?:(,)|,(\s*[0-9]+))?\])?\((\/.*?[^\\]\/[ig]*)(?:,\)|,(.*?[^\\])?\)))[\n\s]*/g,
function(a,c,e,f,g,h,k,m){b.push([f,g?-1:h,k,(m||"").replace(/\\\)/g,")")]);d+=e+"\n";return c||""}).replace(/([^\\]\)|^)?[\n\s]*(#outrep(?:\[([a-z0-9]+)(?:(,)|,(\s*[0-9]+))?\])?\((\/.*?[^\\]\/[ig]*)(?:,\)|,(.*?[^\\])?\)))[\n\s]*/g,function(a,b,e,f,g,h,k,m){c.push([f,g?-1:h,k,(m||"").replace(/\\\)/g,")")]);d+=e+"\n";return b||""});this.I.Zc=b;this.I.Pc=c;return[a,d]},ya:function(a){if(a){var b=[];a.forEach(function(a){(!a[0]||a[0]===x&&(-1===a[1]?!q:!a[1]||a[1]===q))&&b.push([a[2],a[3]])});return 0===
b.length?n:b}return n},ub:function(a){if(a)for(var b=a.length-1;0<=b;b--)a[b][0]=this.Xa(a[b][0],n);return a},Ra:function(a,b,c){this.Wa=this.kc(a);this.Va=this.ub(b);this.Ta=this.ub(c);this.U=this.Wa?this.pc:this.Pa;this.Nb=!!a;this.eb=!!b;this.Mb=!!c},Oa:function(){this.hash=0;this.list="";this.U=this.Pa;this.Nb=this.eb=this.Mb=n;Q("hideBySpell",0)},oc:function(a,b,c,d,e,f){d=(c?"!":"")+"#"+d;f.push(a?"(#op"+b+" & "+d+e+")":c&&b&&"!#num"!==d?"(#all"+b+" & "+d+e+")":d+b+e)},sb:function(a){var b=
[],c=[],d=[],g="";a.forEach(function(a){if(a){var e,f="",g=n;if(e=a.match(/^#(?:([^\/]+)\/)?(\d+)? /))f=e[1]?"["+e[1]+(e[2]?","+e[2]:"")+"]":"",a=a.substr(e[0].length);a.bd()&&(a=a.substr(4),g=i);if("#"===a[0]){if(e=a.match(/^#([a-z]+)(?: (.*))?/))switch(e[1]){case "sage":this(g,f,n,"sage","",b);break;case "notxt":this(g,f,i,"tlen","",b);break;case "noimg":this(g,f,i,"img","",b);break;case "trip":this(g,f,n,"trip","",b);break;case "tmax":this(g,f,n,"tlen","("+e[2]+"-20000)",b);break;case "name":a=
e[2].split("!!");a[1]&&this(g,f,n,"trip","(!!"+a[1]+")",b);a[0]&&(a=a[0].split("!"),a[1]&&this(g,f,n,"trip","(!"+a[1]+")",b),a[0]&&this(g,f,n,"name","("+a[0].replace(/\)/g,"\\)")+")",b));break;case "skip":this(g,f,i,"num","("+e[2]+")",d);break;case "rep":case "outrep":a=e[2].match(/(\/.*?[^\\]\/[ig]*)(?: (.*))?/);c.push("#"+e[1]+f+"("+a[1]+","+(a[2]||"").replace(/\)/g,"\\)")+")");break;case "theme":e[1]="subj";case "exp":case "exph":case "imgn":case "video":this(g,f,n,e[1],"("+e[2]+")",b);break;case "vtag":break;
default:this(g,f,n,e[1],"("+e[2].replace(/\)/g,"\\)")+")",b)}}else this(g,f,n,"words","("+a.replace(/\)/g,"\\)")+")",b)}},this.oc);0!==f.hideByWipe&&(g=[],0!==f.wipeSameLin&&g.push("samelines"),0!==f.wipeSameWrd&&g.push("samewords"),0!==f.wipeLongWrd&&g.push("longwords"),1===f.wipeSpecial&&g.push("symbols"),1===f.wipeCAPS&&g.push("capslock"),0!==f.wipeNumbers&&g.push("numbers"),g=0===g.length?"":"#wipe("+g.join(",")+")"+(0!==b.length?" |\n":""));delete f.hideByWipe;delete f.wipeSameLin;delete f.wipeSameWrd;
delete f.wipeLongWrd;delete f.wipeSpecial;delete f.wipeCAPS;delete f.wipeNumbers;ya(e.c,f);return(0!==d.length?d.join(" &\n")+" &\n":"")+g+b.join(" |\n")+"\n\n"+c.join("\n")},Wb:n,Jc:function(a){a=this.Sa.indexOf(a);return 5>a||14<a},qa:function(a){a=(""+a).replace(/[\s\n]+$/,"");this.I={};var a=this.hc(a),b=this.fc(a[0]);if(b!==n)this.I.Bc=b;else if(this.N){try{I(mb[h]+" "+this.N,"help-err-spell",n)}catch(c){GM_log(mb[h]+" "+this.N)}this.I.list="";return n}this.I.list=a.join("\n\n").replace(/[\s\n]+$/,
"");return a},kb:function(a){this.hash=Xa(a);this.list=a;fa("DESU_Spells_"+e.c,JSON.stringify([1,this.hash,this.list]));a||this.Oa()},lb:function(){var a=this.I.Bc,b=a?this.Ua(a):n,c=this.I.Zc,d=this.I.Pc;0===c.length&&(c=n);0===d.length&&(d=n);fa("DESU_CSpells_"+e.c,JSON.stringify([this.hash,a,c,d]));c=this.ya(c);d=this.ya(d);sessionStorage["de-spells-"+x+q]=JSON.stringify([this.hash,b,c,d]);this.Ra(b,c,d);this.kb(this.I.list)},Vb:function(){var a,b=Fa("DESU_Spells_"+e.c);this.Wb=i;if(b)try{return a=
JSON.parse(b),3>a.length?(this.list=a[1]?this.sb(a[1]):"",this.hash=Xa(this.list)):(this.hash=a[1],this.list=a[2]),this.hash}catch(c){}this.list="string"===typeof b?this.sb(b.split("\n")):"#wipe(samelines,samewords,longwords,numbers)";return this.hash=Xa(this.list)},update:function(){if(this.Vb()){var a,b,c,d;try{if((a=JSON.parse(sessionStorage["de-spells-"+x+q]))&&a[0]===this.hash){this.Ra(a[1],a[2],a[3]);return}}catch(f){}try{if((a=JSON.parse(Fa("DESU_CSpells_"+e.c)))&&a[0]===this.hash){b=a[1]?
this.Ua(a[1]):n;c=this.ya(a[2]);d=this.ya(a[3]);this.Ra(b,c,d);sessionStorage["de-spells-"+x+q]=JSON.stringify([this.hash,b,c,d]);return}}catch(g){}a=this.qa(this.list);this.kb(a?a.join("\n\n").replace(/\n+$/,""):"");this.lb()}else this.Oa()},disable:function(){this.U=this.Pa},replace:function(a){for(var b=0,c=this.Va.length;b<c;b++)a=a.replace(this.Va[b][0],this.Va[b][1]);return a},Oc:function(a){for(var b=0,c=this.Ta.length;b<c;b++)a=a.replace(this.Ta[b][0],this.Ta[b][1]);return a}};window.opera?
P(m,{DOMContentLoaded:yf}):yf()})(window.opera&&window.opera.scriptStorage);
